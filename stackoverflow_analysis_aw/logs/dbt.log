[0m16:03:10.961727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093bdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1fbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1fbc50>]}


============================== 16:03:10.964181 | 59252aaf-dd7e-4d01-9363-37c69d48956d ==============================
[0m16:03:10.964181 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:03:10.964437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:03:11.065481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59252aaf-dd7e-4d01-9363-37c69d48956d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b496190>]}
[0m16:03:11.088958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59252aaf-dd7e-4d01-9363-37c69d48956d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10affb460>]}
[0m16:03:11.090997 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m16:03:11.138123 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:03:11.138671 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:03:11.138870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '59252aaf-dd7e-4d01-9363-37c69d48956d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b283850>]}
[0m16:03:11.540333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.example
[0m16:03:11.544178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59252aaf-dd7e-4d01-9363-37c69d48956d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b79ff20>]}
[0m16:03:11.563552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59252aaf-dd7e-4d01-9363-37c69d48956d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c807310>]}
[0m16:03:11.563771 [info ] [MainThread]: Found 3 models, 7 sources, 428 macros
[0m16:03:11.563903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59252aaf-dd7e-4d01-9363-37c69d48956d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7ffe10>]}
[0m16:03:11.564619 [info ] [MainThread]: 
[0m16:03:11.564752 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:11.564855 [info ] [MainThread]: 
[0m16:03:11.565037 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:03:11.566801 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m16:03:11.619918 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:03:11.620125 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:03:11.620241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:11.656597 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m16:03:11.656811 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:03:11.656934 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:03:11.669890 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:03:11.670683 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:03:11.671495 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:03:11.671635 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:03:11.671926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59252aaf-dd7e-4d01-9363-37c69d48956d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9c2690>]}
[0m16:03:11.674687 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.question_1_top_viewers
[0m16:03:11.674888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.stackoverflow_analysis_aw.question_1_top_viewers)
[0m16:03:11.675031 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.question_1_top_viewers
[0m16:03:11.677642 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.question_1_top_viewers"
[0m16:03:11.677794 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.question_1_top_viewers
[0m16:03:11.678046 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.question_1_top_viewers
[0m16:03:11.678186 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.question_2_answer_timing
[0m16:03:11.678341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.question_1_top_viewers, now model.stackoverflow_analysis_aw.question_2_answer_timing)
[0m16:03:11.678465 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.question_2_answer_timing
[0m16:03:11.679269 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.question_2_answer_timing"
[0m16:03:11.679401 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.question_2_answer_timing
[0m16:03:11.679626 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.question_2_answer_timing
[0m16:03:11.679755 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.question_3_at_replies
[0m16:03:11.679895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.question_2_answer_timing, now model.stackoverflow_analysis_aw.question_3_at_replies)
[0m16:03:11.680015 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.question_3_at_replies
[0m16:03:11.680544 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.question_3_at_replies"
[0m16:03:11.680662 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.question_3_at_replies
[0m16:03:11.680873 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.question_3_at_replies
[0m16:03:11.681267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:11.681368 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.question_3_at_replies' was properly closed.
[0m16:03:11.681666 [debug] [MainThread]: Command end result
[0m16:03:11.715070 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m16:03:11.716334 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m16:03:11.719079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m16:03:11.720765 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m16:03:11.720898 [info ] [MainThread]: Building catalog
[0m16:03:11.724989 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m16:03:11.728046 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m16:03:11.728229 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m16:03:11.728348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:11.728646 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:03:11.728781 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m16:03:11.728930 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main') or upper(r.schema_name) = upper('stackoverflow'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m16:03:11.735005 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:03:11.744200 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m16:03:11.744503 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m16:03:11.744621 [debug] [ThreadPool]: On dev.information_schema: Close
[0m16:03:11.752929 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/catalog.json
[0m16:03:11.761836 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m16:03:11.762565 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m16:03:11.762691 [info ] [MainThread]: Catalog written to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/catalog.json
[0m16:03:11.764411 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.83503556, "process_in_blocks": "0", "process_kernel_time": 0.235479, "process_mem_max_rss": "147767296", "process_out_blocks": "0", "process_user_time": 1.158996}
[0m16:03:11.764611 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:03:11.764573 after 0.84 seconds
[0m16:03:11.764732 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:03:11.764826 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m16:03:11.764949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2fead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7f3250>]}
[0m16:03:11.765082 [debug] [MainThread]: Flushing usage events
[0m16:03:12.761077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:32.226549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108579d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f7c50>]}


============================== 16:03:32.228664 | df186475-d5fd-46d9-97b6-9d0c0f111cb6 ==============================
[0m16:03:32.228664 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:03:32.228937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m16:03:32.310721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df186475-d5fd-46d9-97b6-9d0c0f111cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949a190>]}
[0m16:03:32.331476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df186475-d5fd-46d9-97b6-9d0c0f111cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f7570>]}
[0m16:03:51.151834 [error] [MainThread]: Encountered an error:

[0m16:03:51.161576 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m16:03:51.167498 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 18.973072, "process_in_blocks": "0", "process_kernel_time": 0.156072, "process_mem_max_rss": "117358592", "process_out_blocks": "0", "process_user_time": 0.68618}
[0m16:03:51.168445 [debug] [MainThread]: Command `dbt docs serve` failed at 16:03:51.168302 after 18.97 seconds
[0m16:03:51.169011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109582650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109582750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950be30>]}
[0m16:03:51.169453 [debug] [MainThread]: Flushing usage events
[0m16:03:52.009491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:42.590489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118279d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cccfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cccfed0>]}


============================== 16:06:42.592758 | 7a380b79-0847-4155-9008-40dded649212 ==============================
[0m16:06:42.592758 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:06:42.593018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:06:42.634625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a380b79-0847-4155-9008-40dded649212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ab1e00>]}
[0m16:06:42.643034 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:06:42.643416 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:06:42.645353 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.086406164, "process_in_blocks": "0", "process_kernel_time": 0.127255, "process_mem_max_rss": "105758720", "process_out_blocks": "0", "process_user_time": 0.601065}
[0m16:06:42.645574 [debug] [MainThread]: Command `cli deps` succeeded at 16:06:42.645526 after 0.09 seconds
[0m16:06:42.645729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cbf9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cbfa9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd50f50>]}
[0m16:06:42.645868 [debug] [MainThread]: Flushing usage events
[0m16:06:43.542180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:48.916065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108369d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cfed0>]}


============================== 16:08:48.918693 | 7edee615-992d-4d36-bc01-8bc122812b5d ==============================
[0m16:08:48.918693 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:08:48.918965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:08:49.006503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7edee615-992d-4d36-bc01-8bc122812b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957df30>]}
[0m16:08:49.027678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7edee615-992d-4d36-bc01-8bc122812b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f7570>]}
[0m16:08:49.030551 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m16:08:49.074467 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m16:08:49.105199 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:08:49.105430 [debug] [MainThread]: previous checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m16:08:49.105580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7edee615-992d-4d36-bc01-8bc122812b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109456f50>]}
[0m16:08:49.510409 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.example
[0m16:08:49.514306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7edee615-992d-4d36-bc01-8bc122812b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097366c0>]}
[0m16:08:49.540339 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m16:08:49.541744 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m16:08:49.559672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7edee615-992d-4d36-bc01-8bc122812b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097244b0>]}
[0m16:08:49.559893 [info ] [MainThread]: Found 3 models, 7 sources, 428 macros
[0m16:08:49.560020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7edee615-992d-4d36-bc01-8bc122812b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f48d50>]}
[0m16:08:49.560588 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:08:49.560814 [debug] [MainThread]: Command end result
[0m16:08:49.568345 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m16:08:49.569121 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m16:08:49.570271 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m16:08:49.572105 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6871521, "process_in_blocks": "0", "process_kernel_time": 0.188512, "process_mem_max_rss": "126697472", "process_out_blocks": "0", "process_user_time": 1.106325}
[0m16:08:49.572277 [debug] [MainThread]: Command `cli test` succeeded at 16:08:49.572241 after 0.69 seconds
[0m16:08:49.572415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f24940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f249f0>]}
[0m16:08:49.572544 [debug] [MainThread]: Flushing usage events
[0m16:08:50.454865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:02.386388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106479d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cfed0>]}


============================== 16:10:02.388869 | 35f032a2-1fed-4e4f-8b29-6746acde6b71 ==============================
[0m16:10:02.388869 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:10:02.389171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:10:02.430812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35f032a2-1fed-4e4f-8b29-6746acde6b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106871e00>]}
[0m16:10:02.439347 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:10:02.439971 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:10:02.441927 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.087975375, "process_in_blocks": "0", "process_kernel_time": 0.141988, "process_mem_max_rss": "106266624", "process_out_blocks": "0", "process_user_time": 0.635245}
[0m16:10:02.442159 [debug] [MainThread]: Command `cli deps` succeeded at 16:10:02.442109 after 0.09 seconds
[0m16:10:02.442308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fa9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107750f50>]}
[0m16:10:02.442457 [debug] [MainThread]: Flushing usage events
[0m16:10:03.269178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:23.163941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e65d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108acfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108acfc50>]}


============================== 17:01:23.166642 | 2c869371-77b7-4470-aa4b-b275dd0deeff ==============================
[0m17:01:23.166642 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:01:23.166923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select test_type:generic', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:01:23.252708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c869371-77b7-4470-aa4b-b275dd0deeff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d95f30>]}
[0m17:01:23.275612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c869371-77b7-4470-aa4b-b275dd0deeff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fb460>]}
[0m17:01:23.277800 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:01:23.323821 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:01:23.382234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:01:23.382548 [debug] [MainThread]: Partial parsing: updated file: stackoverflow_analysis_aw://tests/generic/valid_timestamp.sql
[0m17:01:23.407740 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.example
[0m17:01:23.412311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c869371-77b7-4470-aa4b-b275dd0deeff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109059450>]}
[0m17:01:23.439701 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:01:23.441019 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:01:23.458424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c869371-77b7-4470-aa4b-b275dd0deeff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932c8c0>]}
[0m17:01:23.458727 [info ] [MainThread]: Found 3 models, 7 sources, 430 macros
[0m17:01:23.458871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c869371-77b7-4470-aa4b-b275dd0deeff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b1fd0>]}
[0m17:01:23.459143 [warn ] [MainThread]: The selection criterion 'test_type:generic' does not match any enabled nodes
[0m17:01:23.461179 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:01:23.462028 [debug] [MainThread]: Command end result
[0m17:01:23.471229 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:01:23.472588 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:01:23.474314 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:01:23.476103 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.34483975, "process_in_blocks": "0", "process_kernel_time": 0.18007, "process_mem_max_rss": "121503744", "process_out_blocks": "0", "process_user_time": 0.759862}
[0m17:01:23.476319 [debug] [MainThread]: Command `dbt test` succeeded at 17:01:23.476277 after 0.35 seconds
[0m17:01:23.476470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cd230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7ea50>]}
[0m17:01:23.476602 [debug] [MainThread]: Flushing usage events
[0m17:01:24.402505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:38.410064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079bdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcfc50>]}


============================== 17:07:38.412830 | d1b855e2-82de-4e5d-a391-fba197b739c3 ==============================
[0m17:07:38.412830 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:07:38.413106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select test_type:generic', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:07:38.498838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b855e2-82de-4e5d-a391-fba197b739c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111199f30>]}
[0m17:07:38.522471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1b855e2-82de-4e5d-a391-fba197b739c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef3460>]}
[0m17:07:38.524520 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:07:38.570458 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:07:38.621907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:07:38.622333 [debug] [MainThread]: Partial parsing: updated file: stackoverflow_analysis_aw://models/staging/schema.yml
[0m17:07:38.653119 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_stackoverflow__comments' in the 'models' section of file 'models/staging/schema.yml'
[0m17:07:38.654328 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_stackoverflow__posts' in the 'models' section of file 'models/staging/schema.yml'
[0m17:07:38.654788 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_stackoverflow__users' in the 'models' section of file 'models/staging/schema.yml'
[0m17:07:38.736641 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "stackoverflow_posts".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("stackoverflow", "posts").
  
  To fix this, change the name of one of these resources:
  - source.stackoverflow_analysis_aw.stackoverflow.posts (models/staging/schema.yml)
  - source.stackoverflow_analysis_aw.stackoverflow.posts (models/sources.yml)
[0m17:07:38.738346 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3615049, "process_in_blocks": "0", "process_kernel_time": 0.17803, "process_mem_max_rss": "121520128", "process_out_blocks": "0", "process_user_time": 0.799736}
[0m17:07:38.738564 [debug] [MainThread]: Command `dbt test` failed at 17:07:38.738517 after 0.36 seconds
[0m17:07:38.738726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11165fd40>]}
[0m17:07:38.738874 [debug] [MainThread]: Flushing usage events
[0m17:07:39.639348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:28.627783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d25d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114cfc50>]}


============================== 17:08:28.630154 | ae8c893a-4a42-4b01-bf7c-f6fe64d2f8a9 ==============================
[0m17:08:28.630154 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:08:28.630494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/yuejwang/.dbt', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select test_type:generic', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:08:28.713460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae8c893a-4a42-4b01-bf7c-f6fe64d2f8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111695f30>]}
[0m17:08:28.734303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae8c893a-4a42-4b01-bf7c-f6fe64d2f8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113f7460>]}
[0m17:08:28.736026 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:08:28.781242 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:08:28.833863 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 1 files changed.
[0m17:08:28.834191 [debug] [MainThread]: Partial parsing: added file: stackoverflow_analysis_aw://models/stg_stackoverflow__posts.sql
[0m17:08:28.834358 [debug] [MainThread]: Partial parsing: added file: stackoverflow_analysis_aw://models/stg_stackoverflow__users.sql
[0m17:08:28.834514 [debug] [MainThread]: Partial parsing: added file: stackoverflow_analysis_aw://models/stg_stackoverflow__comments.sql
[0m17:08:28.834734 [debug] [MainThread]: Partial parsing: updated file: stackoverflow_analysis_aw://models/staging/schema.yml
[0m17:08:28.834867 [debug] [MainThread]: Partial parsing: deleted file: stackoverflow_analysis_aw://models/base_stackoverflow_posts.sql
[0m17:08:28.834985 [debug] [MainThread]: Partial parsing: deleted file: stackoverflow_analysis_aw://models/base_stackoverflow_users.sql
[0m17:08:28.835084 [debug] [MainThread]: Partial parsing: deleted file: stackoverflow_analysis_aw://models/base_stackoverflow_comments.sql
[0m17:08:29.010584 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "stackoverflow_posts".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("stackoverflow", "posts").
  
  To fix this, change the name of one of these resources:
  - source.stackoverflow_analysis_aw.stackoverflow.posts (models/staging/schema.yml)
  - source.stackoverflow_analysis_aw.stackoverflow.posts (models/sources.yml)
[0m17:08:29.013282 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.41655853, "process_in_blocks": "0", "process_kernel_time": 0.168453, "process_mem_max_rss": "124502016", "process_out_blocks": "0", "process_user_time": 0.880877}
[0m17:08:29.013476 [debug] [MainThread]: Command `dbt test` failed at 17:08:29.013435 after 0.42 seconds
[0m17:08:29.013629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11185ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11185bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ff59a0>]}
[0m17:08:29.013769 [debug] [MainThread]: Flushing usage events
[0m17:08:29.877506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:23.113483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d99d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ecfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ecfc50>]}


============================== 17:10:23.116242 | 38d3d2a8-a59b-4651-a1d3-ea29fb3e200b ==============================
[0m17:10:23.116242 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:10:23.116548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select test_type:generic', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:23.205328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38d3d2a8-a59b-4651-a1d3-ea29fb3e200b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109099f30>]}
[0m17:10:23.226514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38d3d2a8-a59b-4651-a1d3-ea29fb3e200b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf7460>]}
[0m17:10:23.228697 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:10:23.274171 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:10:23.334519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:23.334761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:23.337756 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.example
[0m17:10:23.358006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38d3d2a8-a59b-4651-a1d3-ea29fb3e200b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10955a550>]}
[0m17:10:23.391395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:10:23.392605 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:10:23.409996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38d3d2a8-a59b-4651-a1d3-ea29fb3e200b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109949220>]}
[0m17:10:23.410226 [info ] [MainThread]: Found 3 models, 12 data tests, 7 sources, 430 macros
[0m17:10:23.410360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38d3d2a8-a59b-4651-a1d3-ea29fb3e200b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098da270>]}
[0m17:10:23.411172 [info ] [MainThread]: 
[0m17:10:23.411307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:23.411410 [info ] [MainThread]: 
[0m17:10:23.411615 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:10:23.413444 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m17:10:23.466777 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:10:23.466999 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:10:23.467122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:23.473308 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:10:23.473510 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:10:23.473636 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:10:23.483724 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:10:23.484373 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:10:23.485169 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:10:23.485318 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:10:23.485633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38d3d2a8-a59b-4651-a1d3-ea29fb3e200b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b918b0>]}
[0m17:10:23.485853 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:23.485963 [debug] [MainThread]: On master: BEGIN
[0m17:10:23.486065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:23.486272 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:23.486370 [debug] [MainThread]: On master: COMMIT
[0m17:10:23.486473 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:23.486563 [debug] [MainThread]: On master: COMMIT
[0m17:10:23.486726 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:23.486880 [debug] [MainThread]: On master: Close
[0m17:10:23.488187 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:10:23.488393 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 . [RUN]
[0m17:10:23.488586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96)
[0m17:10:23.488725 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:10:23.495096 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:10:23.496034 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:10:23.503352 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:10:23.504178 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:10:23.504336 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: BEGIN
[0m17:10:23.504465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.504727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.504851 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:10:23.504985 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        post_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_stackoverflow__posts"
    group by post_type_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m17:10:23.508113 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        post_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_stackoverflow__posts"
    group by post_type_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m17:10:23.508292 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.508481 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: ROLLBACK
[0m17:10:23.513809 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96'
[0m17:10:23.514021 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: Close
[0m17:10:23.515773 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 17:     from "dev"."main"."stg_stackoverflow__posts"
                    ^
[0m17:10:23.516015 [error] [Thread-1 (]: 1 of 12 ERROR accepted_values_stg_stackoverflow__posts_post_type_id__1__2 ...... [[31mERROR[0m in 0.03s]
[0m17:10:23.516251 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:10:23.516406 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:10:23.516616 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96' to be skipped because of status 'error'.  Reason: Runtime Error in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 17:     from "dev"."main"."stg_stackoverflow__posts"
                    ^.
[0m17:10:23.516804 [info ] [Thread-1 (]: 2 of 12 START test not_null_stg_stackoverflow__comments_comment_id ............. [RUN]
[0m17:10:23.517359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca)
[0m17:10:23.517537 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:10:23.520260 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:10:23.520660 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:10:23.521667 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:10:23.521972 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:10:23.522109 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: BEGIN
[0m17:10:23.522232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.522554 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.522705 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:10:23.522848 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_id
from "dev"."main"."stg_stackoverflow__comments"
where comment_id is null



      
    ) dbt_internal_test
[0m17:10:23.524520 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_id
from "dev"."main"."stg_stackoverflow__comments"
where comment_id is null



      
    ) dbt_internal_test
[0m17:10:23.524665 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.524837 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: ROLLBACK
[0m17:10:23.526530 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca'
[0m17:10:23.526662 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: Close
[0m17:10:23.528249 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__comments"
                ^
[0m17:10:23.528446 [error] [Thread-1 (]: 2 of 12 ERROR not_null_stg_stackoverflow__comments_comment_id .................. [[31mERROR[0m in 0.01s]
[0m17:10:23.528658 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:10:23.528803 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:10:23.528988 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__comments"
                ^.
[0m17:10:23.529133 [info ] [Thread-1 (]: 3 of 12 START test not_null_stg_stackoverflow__posts_created_at ................ [RUN]
[0m17:10:23.529392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf)
[0m17:10:23.529554 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:10:23.531116 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:10:23.531528 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:10:23.532323 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:10:23.532684 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:10:23.532828 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: BEGIN
[0m17:10:23.532951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.533223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.533371 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:10:23.533507 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select created_at
from "dev"."main"."stg_stackoverflow__posts"
where created_at is null



      
    ) dbt_internal_test
[0m17:10:23.535562 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select created_at
from "dev"."main"."stg_stackoverflow__posts"
where created_at is null



      
    ) dbt_internal_test
[0m17:10:23.535757 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.535948 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: ROLLBACK
[0m17:10:23.537691 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf'
[0m17:10:23.537825 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: Close
[0m17:10:23.539448 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.539645 [error] [Thread-1 (]: 3 of 12 ERROR not_null_stg_stackoverflow__posts_created_at ..................... [[31mERROR[0m in 0.01s]
[0m17:10:23.539852 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:10:23.539991 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:10:23.540182 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m17:10:23.540346 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_stackoverflow__posts_post_id ................... [RUN]
[0m17:10:23.540581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba)
[0m17:10:23.540713 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:10:23.542545 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:10:23.542960 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:10:23.543833 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:10:23.544160 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:10:23.544307 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: BEGIN
[0m17:10:23.544425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.544682 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.544810 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:10:23.544936 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."main"."stg_stackoverflow__posts"
where post_id is null



      
    ) dbt_internal_test
[0m17:10:23.546571 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."main"."stg_stackoverflow__posts"
where post_id is null



      
    ) dbt_internal_test
[0m17:10:23.546717 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.546881 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: ROLLBACK
[0m17:10:23.548947 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba'
[0m17:10:23.549115 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: Close
[0m17:10:23.551018 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.551264 [error] [Thread-1 (]: 4 of 12 ERROR not_null_stg_stackoverflow__posts_post_id ........................ [[31mERROR[0m in 0.01s]
[0m17:10:23.551478 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:10:23.551625 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:10:23.551809 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m17:10:23.551978 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_stackoverflow__posts_post_type_id .............. [RUN]
[0m17:10:23.552239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3)
[0m17:10:23.552377 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:10:23.553994 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:10:23.554365 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:10:23.555399 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:10:23.555724 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:10:23.555858 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: BEGIN
[0m17:10:23.555982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.556252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.556371 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:10:23.556501 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_type_id
from "dev"."main"."stg_stackoverflow__posts"
where post_type_id is null



      
    ) dbt_internal_test
[0m17:10:23.558145 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_type_id
from "dev"."main"."stg_stackoverflow__posts"
where post_type_id is null



      
    ) dbt_internal_test
[0m17:10:23.558289 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.558453 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: ROLLBACK
[0m17:10:23.560153 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3'
[0m17:10:23.560289 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: Close
[0m17:10:23.561905 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__posts_post_type_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.562097 [error] [Thread-1 (]: 5 of 12 ERROR not_null_stg_stackoverflow__posts_post_type_id ................... [[31mERROR[0m in 0.01s]
[0m17:10:23.562302 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:10:23.562444 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:10:23.562747 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_post_type_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m17:10:23.562576 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_stackoverflow__posts_view_count ................ [RUN]
[0m17:10:23.563011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653)
[0m17:10:23.563142 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:10:23.564730 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:10:23.565096 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:10:23.566154 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:10:23.566685 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:10:23.566866 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: BEGIN
[0m17:10:23.567003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.567334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.567472 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:10:23.567616 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "dev"."main"."stg_stackoverflow__posts"
where view_count is null



      
    ) dbt_internal_test
[0m17:10:23.569571 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "dev"."main"."stg_stackoverflow__posts"
where view_count is null



      
    ) dbt_internal_test
[0m17:10:23.569755 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.569946 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: ROLLBACK
[0m17:10:23.571792 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653'
[0m17:10:23.571992 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: Close
[0m17:10:23.573731 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.573951 [error] [Thread-1 (]: 6 of 12 ERROR not_null_stg_stackoverflow__posts_view_count ..................... [[31mERROR[0m in 0.01s]
[0m17:10:23.574171 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:10:23.574313 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:10:23.574505 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m17:10:23.574666 [info ] [Thread-1 (]: 7 of 12 START test not_null_stg_stackoverflow__users_user_id ................... [RUN]
[0m17:10:23.574901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef)
[0m17:10:23.575039 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:10:23.576636 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:10:23.577058 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:10:23.577874 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:10:23.578243 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:10:23.578401 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: BEGIN
[0m17:10:23.578532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.578817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.578948 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:10:23.579104 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev"."main"."stg_stackoverflow__users"
where user_id is null



      
    ) dbt_internal_test
[0m17:10:23.581212 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev"."main"."stg_stackoverflow__users"
where user_id is null



      
    ) dbt_internal_test
[0m17:10:23.581471 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.581813 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: ROLLBACK
[0m17:10:23.583709 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef'
[0m17:10:23.583892 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: Close
[0m17:10:23.585604 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "sqlite_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__users"
                ^
[0m17:10:23.585809 [error] [Thread-1 (]: 7 of 12 ERROR not_null_stg_stackoverflow__users_user_id ........................ [[31mERROR[0m in 0.01s]
[0m17:10:23.586018 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:10:23.586163 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:10:23.586347 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "sqlite_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__users"
                ^.
[0m17:10:23.586492 [info ] [Thread-1 (]: 8 of 12 START test positive_value_stg_stackoverflow__posts_view_count .......... [RUN]
[0m17:10:23.586717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef, now test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35)
[0m17:10:23.586869 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:10:23.589156 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:10:23.589581 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:10:23.590442 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:10:23.590854 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:10:23.591003 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: BEGIN
[0m17:10:23.591146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.591469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.591623 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:10:23.591772 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main"."stg_stackoverflow__posts"
where view_count < 0


      
    ) dbt_internal_test
[0m17:10:23.593682 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main"."stg_stackoverflow__posts"
where view_count < 0


      
    ) dbt_internal_test
[0m17:10:23.593840 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.594012 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: ROLLBACK
[0m17:10:23.595729 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35'
[0m17:10:23.595864 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: Close
[0m17:10:23.597485 [debug] [Thread-1 (]: Runtime Error in test positive_value_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.597686 [error] [Thread-1 (]: 8 of 12 ERROR positive_value_stg_stackoverflow__posts_view_count ............... [[31mERROR[0m in 0.01s]
[0m17:10:23.597896 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:10:23.598038 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:10:23.598225 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35' to be skipped because of status 'error'.  Reason: Runtime Error in test positive_value_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m17:10:23.598384 [info ] [Thread-1 (]: 9 of 12 START test unique_stg_stackoverflow__comments_comment_id ............... [RUN]
[0m17:10:23.598640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35, now test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9)
[0m17:10:23.598803 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:10:23.601948 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:10:23.602397 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:10:23.603614 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:10:23.604005 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:10:23.604164 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: BEGIN
[0m17:10:23.604298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.604646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.604791 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:10:23.604928 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    comment_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_stackoverflow__comments"
where comment_id is not null
group by comment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:10:23.606632 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    comment_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_stackoverflow__comments"
where comment_id is not null
group by comment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:10:23.606789 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.606975 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: ROLLBACK
[0m17:10:23.608753 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9'
[0m17:10:23.608895 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: Close
[0m17:10:23.610636 [debug] [Thread-1 (]: Runtime Error in test unique_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__comments"
                ^
[0m17:10:23.610983 [error] [Thread-1 (]: 9 of 12 ERROR unique_stg_stackoverflow__comments_comment_id .................... [[31mERROR[0m in 0.01s]
[0m17:10:23.611204 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:10:23.611353 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:10:23.611529 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__comments"
                ^.
[0m17:10:23.611683 [info ] [Thread-1 (]: 10 of 12 START test unique_stg_stackoverflow__posts_post_id .................... [RUN]
[0m17:10:23.611915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9, now test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed)
[0m17:10:23.612047 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:10:23.613739 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:10:23.614140 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:10:23.614992 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:10:23.615424 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:10:23.615597 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: BEGIN
[0m17:10:23.615739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.616176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.616333 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:10:23.616470 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_stackoverflow__posts"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:10:23.618699 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_stackoverflow__posts"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:10:23.618901 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.619089 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: ROLLBACK
[0m17:10:23.621134 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed'
[0m17:10:23.621280 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: Close
[0m17:10:23.622957 [debug] [Thread-1 (]: Runtime Error in test unique_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.623158 [error] [Thread-1 (]: 10 of 12 ERROR unique_stg_stackoverflow__posts_post_id ......................... [[31mERROR[0m in 0.01s]
[0m17:10:23.623369 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:10:23.623512 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:10:23.623695 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m17:10:23.623839 [info ] [Thread-1 (]: 11 of 12 START test unique_stg_stackoverflow__users_user_id .................... [RUN]
[0m17:10:23.624078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed, now test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262)
[0m17:10:23.624236 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:10:23.625920 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:10:23.626333 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:10:23.627207 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:10:23.627590 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:10:23.627735 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: BEGIN
[0m17:10:23.627872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.628157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.628278 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:10:23.628654 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_stackoverflow__users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:10:23.630592 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_stackoverflow__users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:10:23.630783 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.630969 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: ROLLBACK
[0m17:10:23.633191 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262'
[0m17:10:23.633623 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: Close
[0m17:10:23.635540 [debug] [Thread-1 (]: Runtime Error in test unique_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "sqlite_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__users"
                ^
[0m17:10:23.635785 [error] [Thread-1 (]: 11 of 12 ERROR unique_stg_stackoverflow__users_user_id ......................... [[31mERROR[0m in 0.01s]
[0m17:10:23.636016 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:10:23.636178 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:10:23.636400 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "sqlite_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__users"
                ^.
[0m17:10:23.636599 [info ] [Thread-1 (]: 12 of 12 START test valid_timestamp_stg_stackoverflow__posts_created_at ........ [RUN]
[0m17:10:23.636901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262, now test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe)
[0m17:10:23.637056 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:10:23.640370 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:10:23.641331 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:10:23.643338 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:10:23.644407 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:10:23.644878 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: BEGIN
[0m17:10:23.645256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:23.645825 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:10:23.645963 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:10:23.646095 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main"."stg_stackoverflow__posts"
where created_at > CURRENT_TIMESTAMP
  or created_at < '2008-01-01'


      
    ) dbt_internal_test
[0m17:10:23.648906 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main"."stg_stackoverflow__posts"
where created_at > CURRENT_TIMESTAMP
  or created_at < '2008-01-01'


      
    ) dbt_internal_test
[0m17:10:23.649109 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:23.649304 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: ROLLBACK
[0m17:10:23.652544 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe'
[0m17:10:23.652731 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: Close
[0m17:10:23.654699 [debug] [Thread-1 (]: Runtime Error in test valid_timestamp_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.654932 [error] [Thread-1 (]: 12 of 12 ERROR valid_timestamp_stg_stackoverflow__posts_created_at ............. [[31mERROR[0m in 0.02s]
[0m17:10:23.655188 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:10:23.655385 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe' to be skipped because of status 'error'.  Reason: Runtime Error in test valid_timestamp_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m17:10:23.656085 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:23.656236 [debug] [MainThread]: On master: BEGIN
[0m17:10:23.656351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:23.656614 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:23.656722 [debug] [MainThread]: On master: COMMIT
[0m17:10:23.656826 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:23.656920 [debug] [MainThread]: On master: COMMIT
[0m17:10:23.657073 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:10:23.657176 [debug] [MainThread]: On master: Close
[0m17:10:23.657328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:23.657429 [debug] [MainThread]: Connection 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe' was properly closed.
[0m17:10:23.657555 [info ] [MainThread]: 
[0m17:10:23.657677 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m17:10:23.658490 [debug] [MainThread]: Command end result
[0m17:10:23.705834 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:10:23.706810 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:10:23.709847 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:10:23.710001 [info ] [MainThread]: 
[0m17:10:23.710162 [info ] [MainThread]: [31mCompleted with 12 errors, 0 partial successes, and 0 warnings:[0m
[0m17:10:23.710282 [info ] [MainThread]: 
[0m17:10:23.710422 [error] [MainThread]:   Runtime Error in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 17:     from "dev"."main"."stg_stackoverflow__posts"
                    ^
[0m17:10:23.710535 [info ] [MainThread]: 
[0m17:10:23.710661 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__comments"
                ^
[0m17:10:23.710767 [info ] [MainThread]: 
[0m17:10:23.710888 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.710986 [info ] [MainThread]: 
[0m17:10:23.711109 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.711208 [info ] [MainThread]: 
[0m17:10:23.711327 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_post_type_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.711430 [info ] [MainThread]: 
[0m17:10:23.711551 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.711714 [info ] [MainThread]: 
[0m17:10:23.711897 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "sqlite_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__users"
                ^
[0m17:10:23.712021 [info ] [MainThread]: 
[0m17:10:23.712149 [error] [MainThread]:   Runtime Error in test positive_value_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.712257 [info ] [MainThread]: 
[0m17:10:23.712377 [error] [MainThread]:   Runtime Error in test unique_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__comments"
                ^
[0m17:10:23.712480 [info ] [MainThread]: 
[0m17:10:23.712602 [error] [MainThread]:   Runtime Error in test unique_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.712702 [info ] [MainThread]: 
[0m17:10:23.712818 [error] [MainThread]:   Runtime Error in test unique_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "sqlite_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__users"
                ^
[0m17:10:23.712918 [info ] [MainThread]: 
[0m17:10:23.713033 [error] [MainThread]:   Runtime Error in test valid_timestamp_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m17:10:23.713135 [info ] [MainThread]: 
[0m17:10:23.713269 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=12 SKIP=0 TOTAL=12
[0m17:10:23.715176 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.63392836, "process_in_blocks": "0", "process_kernel_time": 0.215901, "process_mem_max_rss": "141410304", "process_out_blocks": "0", "process_user_time": 0.99192}
[0m17:10:23.715391 [debug] [MainThread]: Command `dbt test` failed at 17:10:23.715350 after 0.63 seconds
[0m17:10:23.715551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109936e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109937490>]}
[0m17:10:23.715697 [debug] [MainThread]: Flushing usage events
[0m17:10:24.632031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:59.534340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cfc50>]}


============================== 17:11:59.537033 | b6ba7b68-82df-4cd8-9cb7-be26a94dff2f ==============================
[0m17:11:59.537033 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:11:59.537298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:11:59.623283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6ba7b68-82df-4cd8-9cb7-be26a94dff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109899f30>]}
[0m17:11:59.645386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6ba7b68-82df-4cd8-9cb7-be26a94dff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fb460>]}
[0m17:11:59.647700 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:11:59.697115 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:11:59.771443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:59.771660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:59.774521 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.example
[0m17:11:59.792845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6ba7b68-82df-4cd8-9cb7-be26a94dff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b5e550>]}
[0m17:11:59.830859 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:11:59.832012 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:11:59.844911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6ba7b68-82df-4cd8-9cb7-be26a94dff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109913d40>]}
[0m17:11:59.845174 [info ] [MainThread]: Found 3 models, 12 data tests, 7 sources, 430 macros
[0m17:11:59.845317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6ba7b68-82df-4cd8-9cb7-be26a94dff2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d71a90>]}
[0m17:11:59.846029 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:11:59.846921 [debug] [MainThread]: Command end result
[0m17:11:59.856970 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:11:59.857800 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:11:59.859133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:11:59.860953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.35743284, "process_in_blocks": "0", "process_kernel_time": 0.180816, "process_mem_max_rss": "119259136", "process_out_blocks": "0", "process_user_time": 0.776196}
[0m17:11:59.861162 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:59.861119 after 0.36 seconds
[0m17:11:59.861317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c5a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109982750>]}
[0m17:11:59.861461 [debug] [MainThread]: Flushing usage events
[0m17:12:00.766048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:08.072098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff7c50>]}


============================== 17:16:08.074057 | 58c41827-df8a-48a0-9601-5e06b0ca35a3 ==============================
[0m17:16:08.074057 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:16:08.074331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/yuejwang/.dbt', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:08.157935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58c41827-df8a-48a0-9601-5e06b0ca35a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c1f30>]}
[0m17:16:08.179516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58c41827-df8a-48a0-9601-5e06b0ca35a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f23240>]}
[0m17:16:08.181203 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:16:08.239840 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:16:08.298807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:08.299044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:08.302215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
- models.stackoverflow_analysis_aw.intermediate
- models.stackoverflow_analysis_aw.staging
[0m17:16:08.321407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58c41827-df8a-48a0-9601-5e06b0ca35a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105386550>]}
[0m17:16:08.356528 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:16:08.357546 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:16:08.367157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58c41827-df8a-48a0-9601-5e06b0ca35a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523bc50>]}
[0m17:16:08.367419 [info ] [MainThread]: Found 3 models, 12 data tests, 7 sources, 430 macros
[0m17:16:08.367560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58c41827-df8a-48a0-9601-5e06b0ca35a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105599a90>]}
[0m17:16:08.368260 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:16:08.369064 [debug] [MainThread]: Command end result
[0m17:16:08.379522 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:16:08.380412 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:16:08.381654 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:16:08.382945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.34031063, "process_in_blocks": "0", "process_kernel_time": 0.172667, "process_mem_max_rss": "119717888", "process_out_blocks": "0", "process_user_time": 0.803461}
[0m17:16:08.383152 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:08.383109 after 0.34 seconds
[0m17:16:08.383317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e57c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105477710>]}
[0m17:16:08.383466 [debug] [MainThread]: Flushing usage events
[0m17:16:09.266458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:09.485399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c65d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcfc50>]}


============================== 17:18:09.487441 | 372c1389-9515-4593-a362-1cc04ba4014d ==============================
[0m17:18:09.487441 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:18:09.487714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/yuejwang/.dbt', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m17:18:09.569155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '372c1389-9515-4593-a362-1cc04ba4014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e99f30>]}
[0m17:18:09.589813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '372c1389-9515-4593-a362-1cc04ba4014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088fb240>]}
[0m17:18:09.591417 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:18:09.633877 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:18:09.692414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:09.692666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:09.695911 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
- models.stackoverflow_analysis_aw.staging
- models.stackoverflow_analysis_aw.intermediate
[0m17:18:09.714876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '372c1389-9515-4593-a362-1cc04ba4014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10905e550>]}
[0m17:18:09.751019 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:18:09.752158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:18:09.761164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '372c1389-9515-4593-a362-1cc04ba4014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f13c50>]}
[0m17:18:09.761414 [info ] [MainThread]: Found 3 models, 12 data tests, 7 sources, 430 macros
[0m17:18:09.761558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '372c1389-9515-4593-a362-1cc04ba4014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109279a90>]}
[0m17:18:09.762246 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:18:09.763049 [debug] [MainThread]: Command end result
[0m17:18:09.773173 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:18:09.774056 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:18:09.775379 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:18:09.776695 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32217872, "process_in_blocks": "0", "process_kernel_time": 0.169177, "process_mem_max_rss": "121569280", "process_out_blocks": "0", "process_user_time": 0.80305}
[0m17:18:09.776926 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:09.776881 after 0.32 seconds
[0m17:18:09.777106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc5a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10882fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109113710>]}
[0m17:18:09.777258 [debug] [MainThread]: Flushing usage events
[0m17:18:10.788418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:11.521643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195cfc50>]}


============================== 17:21:11.523671 | ecb2aeb5-c452-441e-921e-961775cfdc82 ==============================
[0m17:21:11.523671 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:21:11.523960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m17:21:11.605326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecb2aeb5-c452-441e-921e-961775cfdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119799f30>]}
[0m17:21:11.626347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecb2aeb5-c452-441e-921e-961775cfdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193f7240>]}
[0m17:21:11.627928 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:21:11.675346 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:21:11.734820 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 0 files changed.
[0m17:21:11.735179 [debug] [MainThread]: Partial parsing: added file: stackoverflow_analysis_aw://models/staging/sources.yml
[0m17:21:11.735338 [debug] [MainThread]: Partial parsing: added file: stackoverflow_analysis_aw://models/staging/stg_stackoverflow__comments.sql
[0m17:21:11.735479 [debug] [MainThread]: Partial parsing: added file: stackoverflow_analysis_aw://models/staging/stg_stackoverflow__users.sql
[0m17:21:11.735603 [debug] [MainThread]: Partial parsing: added file: stackoverflow_analysis_aw://models/staging/stg_stackoverflow__posts.sql
[0m17:21:11.735778 [debug] [MainThread]: Partial parsing: deleted file: stackoverflow_analysis_aw://models/stg_stackoverflow__users.sql
[0m17:21:11.735902 [debug] [MainThread]: Partial parsing: deleted file: stackoverflow_analysis_aw://models/stg_stackoverflow__comments.sql
[0m17:21:11.736035 [debug] [MainThread]: Partial parsing: deleted file: stackoverflow_analysis_aw://models/stg_stackoverflow__posts.sql
[0m17:21:11.925364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stackoverflow_analysis_aw.intermediate
- models.stackoverflow_analysis_aw.marts
[0m17:21:11.929475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecb2aeb5-c452-441e-921e-961775cfdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d5dc50>]}
[0m17:21:11.960726 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:21:11.961705 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:21:11.972033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecb2aeb5-c452-441e-921e-961775cfdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198133e0>]}
[0m17:21:11.972225 [info ] [MainThread]: Found 3 models, 12 data tests, 7 sources, 430 macros
[0m17:21:11.972362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb2aeb5-c452-441e-921e-961775cfdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0e50f0>]}
[0m17:21:11.973046 [info ] [MainThread]: 
[0m17:21:11.973182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:11.973296 [info ] [MainThread]: 
[0m17:21:11.973496 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:21:11.975273 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:21:12.057106 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:21:12.057315 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:21:12.057450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:12.064343 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:21:12.064970 [debug] [ThreadPool]: On list_dev: Close
[0m17:21:12.065288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m17:21:12.065668 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m17:21:12.068422 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m17:21:12.068556 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:21:12.068664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:12.069004 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:12.069710 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m17:21:12.069843 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m17:21:12.070025 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:12.070124 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m17:21:12.070223 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m17:21:12.070935 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:21:12.071269 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m17:21:12.071383 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m17:21:12.071482 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m17:21:12.071866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:12.072026 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m17:21:12.072550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m17:21:12.075041 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:21:12.075181 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m17:21:12.075284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:12.075487 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:12.075591 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:21:12.075701 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m17:21:12.083596 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:21:12.084181 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m17:21:12.085013 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m17:21:12.085132 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m17:21:12.085415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb2aeb5-c452-441e-921e-961775cfdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a210e20>]}
[0m17:21:12.085652 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:12.085778 [debug] [MainThread]: On master: BEGIN
[0m17:21:12.085886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:12.086089 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:12.086192 [debug] [MainThread]: On master: COMMIT
[0m17:21:12.086296 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:12.086389 [debug] [MainThread]: On master: COMMIT
[0m17:21:12.086533 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:12.086632 [debug] [MainThread]: On master: Close
[0m17:21:12.087881 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m17:21:12.088095 [info ] [Thread-1 (]: 1 of 3 START sql view model main_staging.stg_stackoverflow__comments ........... [RUN]
[0m17:21:12.088269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.stackoverflow_analysis_aw.stg_stackoverflow__comments)
[0m17:21:12.088398 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m17:21:12.091558 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:21:12.091920 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m17:21:12.104499 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:21:12.105002 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:21:12.105161 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: BEGIN
[0m17:21:12.105298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:12.105606 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:12.105740 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:21:12.105882 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

  
  create view "dev"."main_staging"."stg_stackoverflow__comments__dbt_tmp" as (
    

with source as (
        select * from 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/comments.parquet'
  ),
  renamed as (
      select
        Id as comment_id,
        PostId as post_id,
        UserId as user_id,
        Text as comment_text,
        CreationDate as created_at
      from source
  )
  select * from renamed
  );

[0m17:21:14.343861 [debug] [Thread-1 (]: SQL status: OK in 2.238 seconds
[0m17:21:14.350395 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:21:14.350729 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */
alter view "dev"."main_staging"."stg_stackoverflow__comments__dbt_tmp" rename to "stg_stackoverflow__comments"
[0m17:21:14.352968 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:21:14.360375 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m17:21:14.360614 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:21:14.360815 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m17:21:14.362030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:14.365164 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:21:14.365404 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */
drop view if exists "dev"."main_staging"."stg_stackoverflow__comments__dbt_backup" cascade
[0m17:21:14.365777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:14.367194 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: Close
[0m17:21:14.368630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb2aeb5-c452-441e-921e-961775cfdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2c2ed0>]}
[0m17:21:14.369015 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main_staging.stg_stackoverflow__comments ...... [[32mOK[0m in 2.28s]
[0m17:21:14.369334 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m17:21:14.369536 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m17:21:14.369801 [info ] [Thread-1 (]: 2 of 3 START sql view model main_staging.stg_stackoverflow__posts .............. [RUN]
[0m17:21:14.370019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.stg_stackoverflow__comments, now model.stackoverflow_analysis_aw.stg_stackoverflow__posts)
[0m17:21:14.370193 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m17:21:14.371675 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:21:14.372167 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m17:21:14.373868 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:21:14.374300 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:21:14.374465 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: BEGIN
[0m17:21:14.374624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:14.374897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:14.375051 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:21:14.375227 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

  
  create view "dev"."main_staging"."stg_stackoverflow__posts__dbt_tmp" as (
    

with source as (
        select * from 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/posts.parquet'
  ),
  renamed as (
      select
        Id as post_id,
        OwnerUserId as owner_user_id,
        PostTypeId as post_type_id,
        ViewCount as view_count,
        CreationDate as created_at,
        AcceptedAnswerId as accepted_answer_id,
        ParentId as parent_id
      from source
  )
  select * from renamed
  );

[0m17:21:17.032469 [debug] [Thread-1 (]: SQL status: OK in 2.657 seconds
[0m17:21:17.035350 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:21:17.035664 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */
alter view "dev"."main_staging"."stg_stackoverflow__posts__dbt_tmp" rename to "stg_stackoverflow__posts"
[0m17:21:17.036251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:17.037127 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m17:21:17.037383 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:21:17.037606 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m17:21:17.038573 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:17.039962 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:21:17.040175 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */
drop view if exists "dev"."main_staging"."stg_stackoverflow__posts__dbt_backup" cascade
[0m17:21:17.040509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:17.041327 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: Close
[0m17:21:17.041742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb2aeb5-c452-441e-921e-961775cfdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2cb490>]}
[0m17:21:17.042188 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main_staging.stg_stackoverflow__posts ......... [[32mOK[0m in 2.67s]
[0m17:21:17.042541 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m17:21:17.042782 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m17:21:17.043173 [info ] [Thread-1 (]: 3 of 3 START sql view model main_staging.stg_stackoverflow__users .............. [RUN]
[0m17:21:17.043542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.stg_stackoverflow__posts, now model.stackoverflow_analysis_aw.stg_stackoverflow__users)
[0m17:21:17.043796 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m17:21:17.046345 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:21:17.046972 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m17:21:17.048550 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:21:17.049068 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:21:17.049265 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: BEGIN
[0m17:21:17.049441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:17.049770 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:17.049944 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:21:17.050135 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

  
  create view "dev"."main_staging"."stg_stackoverflow__users__dbt_tmp" as (
    

with source as (
        select * from 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/users.parquet'
  ),
  renamed as (
      select
        Id as user_id,
        DisplayName as display_name,
        CreationDate as created_at,
        LastAccessDate as last_access_at
      from source
  )
  select * from renamed
  );

[0m17:21:18.981374 [debug] [Thread-1 (]: SQL status: OK in 1.931 seconds
[0m17:21:18.985256 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:21:18.986237 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */
alter view "dev"."main_staging"."stg_stackoverflow__users__dbt_tmp" rename to "stg_stackoverflow__users"
[0m17:21:18.987195 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:18.988512 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: COMMIT
[0m17:21:18.988867 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:21:18.989168 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: COMMIT
[0m17:21:18.990415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:18.992226 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:21:18.992516 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */
drop view if exists "dev"."main_staging"."stg_stackoverflow__users__dbt_backup" cascade
[0m17:21:18.992963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:18.993994 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: Close
[0m17:21:18.994462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb2aeb5-c452-441e-921e-961775cfdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a05c190>]}
[0m17:21:18.994962 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main_staging.stg_stackoverflow__users ......... [[32mOK[0m in 1.95s]
[0m17:21:18.995363 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m17:21:18.996396 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:18.996633 [debug] [MainThread]: On master: BEGIN
[0m17:21:18.996828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:18.997205 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:18.997396 [debug] [MainThread]: On master: COMMIT
[0m17:21:18.997589 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:18.997766 [debug] [MainThread]: On master: COMMIT
[0m17:21:18.998039 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:18.998224 [debug] [MainThread]: On master: Close
[0m17:21:18.998474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:18.998657 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__users' was properly closed.
[0m17:21:18.998903 [info ] [MainThread]: 
[0m17:21:18.999134 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m17:21:18.999758 [debug] [MainThread]: Command end result
[0m17:21:19.015073 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:21:19.016283 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:21:19.019551 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:21:19.019718 [info ] [MainThread]: 
[0m17:21:19.019909 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:19.020046 [info ] [MainThread]: 
[0m17:21:19.020204 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:21:19.022084 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.530351, "process_in_blocks": "0", "process_kernel_time": 0.274155, "process_mem_max_rss": "170868736", "process_out_blocks": "0", "process_user_time": 1.273704}
[0m17:21:19.022302 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:19.022256 after 7.53 seconds
[0m17:21:19.022476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e2d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4a85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11963d550>]}
[0m17:21:19.022648 [debug] [MainThread]: Flushing usage events
[0m17:21:19.931432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:26.407864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acbdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0cfc50>]}


============================== 17:22:26.410222 | 20ad0afc-0b0d-4917-bcf4-147c0190e028 ==============================
[0m17:22:26.410222 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:22:26.410548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select test_type:generic', 'send_anonymous_usage_stats': 'True'}
[0m17:22:26.493551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20ad0afc-0b0d-4917-bcf4-147c0190e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c39df30>]}
[0m17:22:26.514538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20ad0afc-0b0d-4917-bcf4-147c0190e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bff7460>]}
[0m17:22:26.516173 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:22:26.558316 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:22:26.617464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:22:26.617707 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:22:26.620823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
- models.stackoverflow_analysis_aw.intermediate
[0m17:22:26.640433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20ad0afc-0b0d-4917-bcf4-147c0190e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c55a550>]}
[0m17:22:26.677031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:22:26.678060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:22:26.691968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20ad0afc-0b0d-4917-bcf4-147c0190e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c945130>]}
[0m17:22:26.692239 [info ] [MainThread]: Found 3 models, 12 data tests, 7 sources, 430 macros
[0m17:22:26.692398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20ad0afc-0b0d-4917-bcf4-147c0190e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7da270>]}
[0m17:22:26.693336 [info ] [MainThread]: 
[0m17:22:26.693499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:26.693619 [info ] [MainThread]: 
[0m17:22:26.693855 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:22:26.695959 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_staging'
[0m17:22:26.749368 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:22:26.749611 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m17:22:26.749752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:26.756801 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:22:26.757011 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:22:26.757152 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m17:22:26.765978 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:22:26.766658 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m17:22:26.767277 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m17:22:26.767436 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m17:22:26.767762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20ad0afc-0b0d-4917-bcf4-147c0190e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb898b0>]}
[0m17:22:26.767982 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:26.768097 [debug] [MainThread]: On master: BEGIN
[0m17:22:26.768198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:26.768405 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:26.768512 [debug] [MainThread]: On master: COMMIT
[0m17:22:26.768615 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:26.768719 [debug] [MainThread]: On master: COMMIT
[0m17:22:26.768875 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:26.768982 [debug] [MainThread]: On master: Close
[0m17:22:26.770140 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:22:26.770306 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 . [RUN]
[0m17:22:26.770488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96)
[0m17:22:26.770624 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:22:26.777511 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:22:26.778028 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:22:26.786283 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:22:26.787106 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:22:26.787277 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: BEGIN
[0m17:22:26.787412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.787739 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.787917 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:22:26.788069 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        post_type_id as value_field,
        count(*) as n_records

    from "dev"."main_staging"."stg_stackoverflow__posts"
    group by post_type_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m17:22:26.789950 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        post_type_id as value_field,
        count(*) as n_records

    from "dev"."main_staging"."stg_stackoverflow__posts"
    group by post_type_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m17:22:26.790112 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.790302 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: ROLLBACK
[0m17:22:26.795357 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96'
[0m17:22:26.795522 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: Close
[0m17:22:26.797179 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17:     from "dev"."main_staging"."stg_stackoverflow__posts"
                    ^
[0m17:22:26.797397 [error] [Thread-1 (]: 1 of 12 ERROR accepted_values_stg_stackoverflow__posts_post_type_id__1__2 ...... [[31mERROR[0m in 0.03s]
[0m17:22:26.797639 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:22:26.797796 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:22:26.797997 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96' to be skipped because of status 'error'.  Reason: Runtime Error in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17:     from "dev"."main_staging"."stg_stackoverflow__posts"
                    ^.
[0m17:22:26.798179 [info ] [Thread-1 (]: 2 of 12 START test not_null_stg_stackoverflow__comments_comment_id ............. [RUN]
[0m17:22:26.798700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca)
[0m17:22:26.798861 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:22:26.801513 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:22:26.801891 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:22:26.802929 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:22:26.803257 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:22:26.803400 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: BEGIN
[0m17:22:26.803528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.803826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.803983 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:22:26.804127 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_id
from "dev"."main_staging"."stg_stackoverflow__comments"
where comment_id is null



      
    ) dbt_internal_test
[0m17:22:26.805940 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_id
from "dev"."main_staging"."stg_stackoverflow__comments"
where comment_id is null



      
    ) dbt_internal_test
[0m17:22:26.806085 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.806252 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: ROLLBACK
[0m17:22:26.807945 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca'
[0m17:22:26.808081 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: Close
[0m17:22:26.809686 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "dev.sqlite_temp_master or main.sqlite_temp_master"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__comments"
                ^
[0m17:22:26.809881 [error] [Thread-1 (]: 2 of 12 ERROR not_null_stg_stackoverflow__comments_comment_id .................. [[31mERROR[0m in 0.01s]
[0m17:22:26.810093 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:22:26.810239 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:22:26.810420 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "dev.sqlite_temp_master or main.sqlite_temp_master"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__comments"
                ^.
[0m17:22:26.810577 [info ] [Thread-1 (]: 3 of 12 START test not_null_stg_stackoverflow__posts_created_at ................ [RUN]
[0m17:22:26.810813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf)
[0m17:22:26.810952 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:22:26.812448 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:22:26.812815 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:22:26.813611 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:22:26.813994 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:22:26.814130 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: BEGIN
[0m17:22:26.814251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.814532 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.814650 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:22:26.814775 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select created_at
from "dev"."main_staging"."stg_stackoverflow__posts"
where created_at is null



      
    ) dbt_internal_test
[0m17:22:26.816596 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select created_at
from "dev"."main_staging"."stg_stackoverflow__posts"
where created_at is null



      
    ) dbt_internal_test
[0m17:22:26.816782 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.816961 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: ROLLBACK
[0m17:22:26.818671 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf'
[0m17:22:26.818819 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: Close
[0m17:22:26.820424 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.820612 [error] [Thread-1 (]: 3 of 12 ERROR not_null_stg_stackoverflow__posts_created_at ..................... [[31mERROR[0m in 0.01s]
[0m17:22:26.820823 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:22:26.820963 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:22:26.821141 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^.
[0m17:22:26.821283 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_stackoverflow__posts_post_id ................... [RUN]
[0m17:22:26.821505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba)
[0m17:22:26.821638 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:22:26.823473 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:22:26.823869 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:22:26.824646 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:22:26.824957 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:22:26.825089 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: BEGIN
[0m17:22:26.825209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.825465 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.825585 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:22:26.825709 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."main_staging"."stg_stackoverflow__posts"
where post_id is null



      
    ) dbt_internal_test
[0m17:22:26.827441 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."main_staging"."stg_stackoverflow__posts"
where post_id is null



      
    ) dbt_internal_test
[0m17:22:26.827588 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.827744 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: ROLLBACK
[0m17:22:26.829422 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba'
[0m17:22:26.829557 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: Close
[0m17:22:26.831185 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.831380 [error] [Thread-1 (]: 4 of 12 ERROR not_null_stg_stackoverflow__posts_post_id ........................ [[31mERROR[0m in 0.01s]
[0m17:22:26.831585 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:22:26.831793 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:22:26.832195 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^.
[0m17:22:26.832014 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_stackoverflow__posts_post_type_id .............. [RUN]
[0m17:22:26.832477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3)
[0m17:22:26.832612 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:22:26.834258 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:22:26.834847 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:22:26.836078 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:22:26.836540 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:22:26.836682 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: BEGIN
[0m17:22:26.836801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.837085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.837206 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:22:26.837332 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_type_id
from "dev"."main_staging"."stg_stackoverflow__posts"
where post_type_id is null



      
    ) dbt_internal_test
[0m17:22:26.839143 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_type_id
from "dev"."main_staging"."stg_stackoverflow__posts"
where post_type_id is null



      
    ) dbt_internal_test
[0m17:22:26.839333 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.839535 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: ROLLBACK
[0m17:22:26.841332 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3'
[0m17:22:26.841496 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: Close
[0m17:22:26.843190 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__posts_post_type_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.843399 [error] [Thread-1 (]: 5 of 12 ERROR not_null_stg_stackoverflow__posts_post_type_id ................... [[31mERROR[0m in 0.01s]
[0m17:22:26.843612 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:22:26.843754 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:22:26.843951 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_post_type_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^.
[0m17:22:26.844105 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_stackoverflow__posts_view_count ................ [RUN]
[0m17:22:26.844330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653)
[0m17:22:26.844474 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:22:26.846032 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:22:26.846429 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:22:26.847446 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:22:26.847829 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:22:26.847961 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: BEGIN
[0m17:22:26.848082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.848350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.848471 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:22:26.848601 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "dev"."main_staging"."stg_stackoverflow__posts"
where view_count is null



      
    ) dbt_internal_test
[0m17:22:26.850484 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "dev"."main_staging"."stg_stackoverflow__posts"
where view_count is null



      
    ) dbt_internal_test
[0m17:22:26.850662 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.850837 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: ROLLBACK
[0m17:22:26.852507 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653'
[0m17:22:26.852643 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: Close
[0m17:22:26.854247 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.854432 [error] [Thread-1 (]: 6 of 12 ERROR not_null_stg_stackoverflow__posts_view_count ..................... [[31mERROR[0m in 0.01s]
[0m17:22:26.854634 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:22:26.854776 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:22:26.854966 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^.
[0m17:22:26.855144 [info ] [Thread-1 (]: 7 of 12 START test not_null_stg_stackoverflow__users_user_id ................... [RUN]
[0m17:22:26.855398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef)
[0m17:22:26.855538 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:22:26.857087 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:22:26.857444 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:22:26.858164 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:22:26.858453 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:22:26.858579 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: BEGIN
[0m17:22:26.858695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.858952 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.859072 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:22:26.859195 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev"."main_staging"."stg_stackoverflow__users"
where user_id is null



      
    ) dbt_internal_test
[0m17:22:26.860845 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev"."main_staging"."stg_stackoverflow__users"
where user_id is null



      
    ) dbt_internal_test
[0m17:22:26.860986 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.861141 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: ROLLBACK
[0m17:22:26.862841 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef'
[0m17:22:26.862983 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: Close
[0m17:22:26.864669 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "information_schema.constraint_table_usage"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__users"
                ^
[0m17:22:26.864948 [error] [Thread-1 (]: 7 of 12 ERROR not_null_stg_stackoverflow__users_user_id ........................ [[31mERROR[0m in 0.01s]
[0m17:22:26.865173 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:22:26.865321 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:22:26.865507 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "information_schema.constraint_table_usage"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__users"
                ^.
[0m17:22:26.865656 [info ] [Thread-1 (]: 8 of 12 START test positive_value_stg_stackoverflow__posts_view_count .......... [RUN]
[0m17:22:26.865907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef, now test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35)
[0m17:22:26.866060 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:22:26.868263 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:22:26.868665 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:22:26.869405 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:22:26.869754 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:22:26.869897 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: BEGIN
[0m17:22:26.870020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.870305 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.870442 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:22:26.870573 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main_staging"."stg_stackoverflow__posts"
where view_count < 0


      
    ) dbt_internal_test
[0m17:22:26.872297 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main_staging"."stg_stackoverflow__posts"
where view_count < 0


      
    ) dbt_internal_test
[0m17:22:26.872453 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.872625 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: ROLLBACK
[0m17:22:26.874313 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35'
[0m17:22:26.874448 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: Close
[0m17:22:26.876049 [debug] [Thread-1 (]: Runtime Error in test positive_value_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 10: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.876232 [error] [Thread-1 (]: 8 of 12 ERROR positive_value_stg_stackoverflow__posts_view_count ............... [[31mERROR[0m in 0.01s]
[0m17:22:26.876436 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:22:26.876576 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:22:26.876750 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35' to be skipped because of status 'error'.  Reason: Runtime Error in test positive_value_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 10: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^.
[0m17:22:26.876892 [info ] [Thread-1 (]: 9 of 12 START test unique_stg_stackoverflow__comments_comment_id ............... [RUN]
[0m17:22:26.877120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35, now test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9)
[0m17:22:26.877266 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:22:26.879859 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:22:26.880324 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:22:26.881572 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:22:26.882138 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:22:26.882311 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: BEGIN
[0m17:22:26.882444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.882743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.882873 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:22:26.883017 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    comment_id as unique_field,
    count(*) as n_records

from "dev"."main_staging"."stg_stackoverflow__comments"
where comment_id is not null
group by comment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:26.884766 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    comment_id as unique_field,
    count(*) as n_records

from "dev"."main_staging"."stg_stackoverflow__comments"
where comment_id is not null
group by comment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:26.884909 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.885075 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: ROLLBACK
[0m17:22:26.886799 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9'
[0m17:22:26.886931 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: Close
[0m17:22:26.888526 [debug] [Thread-1 (]: Runtime Error in test unique_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "dev.sqlite_temp_master or main.sqlite_temp_master"?
  
  LINE 15: from "dev"."main_staging"."stg_stackoverflow__comments"
                ^
[0m17:22:26.888714 [error] [Thread-1 (]: 9 of 12 ERROR unique_stg_stackoverflow__comments_comment_id .................... [[31mERROR[0m in 0.01s]
[0m17:22:26.888918 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:22:26.889060 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:22:26.889236 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "dev.sqlite_temp_master or main.sqlite_temp_master"?
  
  LINE 15: from "dev"."main_staging"."stg_stackoverflow__comments"
                ^.
[0m17:22:26.889394 [info ] [Thread-1 (]: 10 of 12 START test unique_stg_stackoverflow__posts_post_id .................... [RUN]
[0m17:22:26.889615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9, now test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed)
[0m17:22:26.889745 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:22:26.891253 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:22:26.891681 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:22:26.892513 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:22:26.892883 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:22:26.893032 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: BEGIN
[0m17:22:26.893164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.893436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.893567 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:22:26.893702 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "dev"."main_staging"."stg_stackoverflow__posts"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:26.895664 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "dev"."main_staging"."stg_stackoverflow__posts"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:26.895818 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.895976 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: ROLLBACK
[0m17:22:26.897985 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed'
[0m17:22:26.898136 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: Close
[0m17:22:26.899988 [debug] [Thread-1 (]: Runtime Error in test unique_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 15: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.900214 [error] [Thread-1 (]: 10 of 12 ERROR unique_stg_stackoverflow__posts_post_id ......................... [[31mERROR[0m in 0.01s]
[0m17:22:26.900431 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:22:26.900578 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:22:26.900760 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 15: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^.
[0m17:22:26.900906 [info ] [Thread-1 (]: 11 of 12 START test unique_stg_stackoverflow__users_user_id .................... [RUN]
[0m17:22:26.901149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed, now test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262)
[0m17:22:26.901288 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:22:26.902808 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:22:26.903172 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:22:26.903948 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:22:26.904305 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:22:26.904454 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: BEGIN
[0m17:22:26.904576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.904880 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.905029 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:22:26.905173 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main_staging"."stg_stackoverflow__users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:26.907034 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main_staging"."stg_stackoverflow__users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:26.907187 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.907351 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: ROLLBACK
[0m17:22:26.909029 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262'
[0m17:22:26.909164 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: Close
[0m17:22:26.910776 [debug] [Thread-1 (]: Runtime Error in test unique_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "information_schema.constraint_table_usage"?
  
  LINE 15: from "dev"."main_staging"."stg_stackoverflow__users"
                ^
[0m17:22:26.910958 [error] [Thread-1 (]: 11 of 12 ERROR unique_stg_stackoverflow__users_user_id ......................... [[31mERROR[0m in 0.01s]
[0m17:22:26.911159 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:22:26.911297 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:22:26.911475 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "information_schema.constraint_table_usage"?
  
  LINE 15: from "dev"."main_staging"."stg_stackoverflow__users"
                ^.
[0m17:22:26.911616 [info ] [Thread-1 (]: 12 of 12 START test valid_timestamp_stg_stackoverflow__posts_created_at ........ [RUN]
[0m17:22:26.911844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262, now test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe)
[0m17:22:26.911999 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:22:26.914128 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:22:26.914538 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:22:26.915244 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:22:26.915702 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:22:26.915850 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: BEGIN
[0m17:22:26.915971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:26.916260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:22:26.916387 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:22:26.916516 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main_staging"."stg_stackoverflow__posts"
where created_at > CURRENT_TIMESTAMP
  or created_at < '2008-01-01'


      
    ) dbt_internal_test
[0m17:22:26.918167 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main_staging"."stg_stackoverflow__posts"
where created_at > CURRENT_TIMESTAMP
  or created_at < '2008-01-01'


      
    ) dbt_internal_test
[0m17:22:26.918309 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:22:26.918477 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: ROLLBACK
[0m17:22:26.920119 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe'
[0m17:22:26.920238 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: Close
[0m17:22:26.921698 [debug] [Thread-1 (]: Runtime Error in test valid_timestamp_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 10: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.921868 [error] [Thread-1 (]: 12 of 12 ERROR valid_timestamp_stg_stackoverflow__posts_created_at ............. [[31mERROR[0m in 0.01s]
[0m17:22:26.922066 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:22:26.922260 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe' to be skipped because of status 'error'.  Reason: Runtime Error in test valid_timestamp_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 10: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^.
[0m17:22:26.922781 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:26.922891 [debug] [MainThread]: On master: BEGIN
[0m17:22:26.922979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:26.923226 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:26.923348 [debug] [MainThread]: On master: COMMIT
[0m17:22:26.923460 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:26.923558 [debug] [MainThread]: On master: COMMIT
[0m17:22:26.923733 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:26.923842 [debug] [MainThread]: On master: Close
[0m17:22:26.923977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:26.924073 [debug] [MainThread]: Connection 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe' was properly closed.
[0m17:22:26.924191 [info ] [MainThread]: 
[0m17:22:26.924309 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m17:22:26.925087 [debug] [MainThread]: Command end result
[0m17:22:26.960349 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:22:26.961141 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:22:26.963848 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:22:26.963964 [info ] [MainThread]: 
[0m17:22:26.964106 [info ] [MainThread]: [31mCompleted with 12 errors, 0 partial successes, and 0 warnings:[0m
[0m17:22:26.964216 [info ] [MainThread]: 
[0m17:22:26.964349 [error] [MainThread]:   Runtime Error in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17:     from "dev"."main_staging"."stg_stackoverflow__posts"
                    ^
[0m17:22:26.964457 [info ] [MainThread]: 
[0m17:22:26.964578 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "dev.sqlite_temp_master or main.sqlite_temp_master"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__comments"
                ^
[0m17:22:26.964678 [info ] [MainThread]: 
[0m17:22:26.964798 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.964894 [info ] [MainThread]: 
[0m17:22:26.965010 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.965109 [info ] [MainThread]: 
[0m17:22:26.965224 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_post_type_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.965321 [info ] [MainThread]: 
[0m17:22:26.965437 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.965532 [info ] [MainThread]: 
[0m17:22:26.965650 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "information_schema.constraint_table_usage"?
  
  LINE 14: from "dev"."main_staging"."stg_stackoverflow__users"
                ^
[0m17:22:26.965746 [info ] [MainThread]: 
[0m17:22:26.965861 [error] [MainThread]:   Runtime Error in test positive_value_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 10: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.965958 [info ] [MainThread]: 
[0m17:22:26.966071 [error] [MainThread]:   Runtime Error in test unique_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__comments does not exist!
  Did you mean "dev.sqlite_temp_master or main.sqlite_temp_master"?
  
  LINE 15: from "dev"."main_staging"."stg_stackoverflow__comments"
                ^
[0m17:22:26.966172 [info ] [MainThread]: 
[0m17:22:26.966289 [error] [MainThread]:   Runtime Error in test unique_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 15: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.966382 [info ] [MainThread]: 
[0m17:22:26.966499 [error] [MainThread]:   Runtime Error in test unique_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__users does not exist!
  Did you mean "information_schema.constraint_table_usage"?
  
  LINE 15: from "dev"."main_staging"."stg_stackoverflow__users"
                ^
[0m17:22:26.966594 [info ] [MainThread]: 
[0m17:22:26.966709 [error] [MainThread]:   Runtime Error in test valid_timestamp_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 10: from "dev"."main_staging"."stg_stackoverflow__posts"
                ^
[0m17:22:26.966809 [info ] [MainThread]: 
[0m17:22:26.966914 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=12 SKIP=0 TOTAL=12
[0m17:22:26.968208 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.5903413, "process_in_blocks": "0", "process_kernel_time": 0.205214, "process_mem_max_rss": "141279232", "process_out_blocks": "0", "process_user_time": 1.011911}
[0m17:22:26.968398 [debug] [MainThread]: Command `dbt test` failed at 17:22:26.968361 after 0.59 seconds
[0m17:22:26.968540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf2fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c93fb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c93eaf0>]}
[0m17:22:26.968688 [debug] [MainThread]: Flushing usage events
[0m17:22:27.796393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:07.696034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106515d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cfc50>]}


============================== 17:24:07.698137 | 86cac20b-7a46-4ba1-9831-720843d82fa7 ==============================
[0m17:24:07.698137 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:24:07.698407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:24:07.780560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86cac20b-7a46-4ba1-9831-720843d82fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c99f30>]}
[0m17:24:07.800974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86cac20b-7a46-4ba1-9831-720843d82fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f3240>]}
[0m17:24:07.802640 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:24:07.846287 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:24:07.910011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:07.910256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:07.913428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
- models.stackoverflow_analysis_aw.intermediate
[0m17:24:07.933196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86cac20b-7a46-4ba1-9831-720843d82fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e62550>]}
[0m17:24:07.969891 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:24:07.970969 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:24:07.980355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86cac20b-7a46-4ba1-9831-720843d82fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d13c50>]}
[0m17:24:07.980618 [info ] [MainThread]: Found 3 models, 12 data tests, 7 sources, 430 macros
[0m17:24:07.980763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86cac20b-7a46-4ba1-9831-720843d82fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10919da90>]}
[0m17:24:07.981637 [info ] [MainThread]: 
[0m17:24:07.981796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:07.981916 [info ] [MainThread]: 
[0m17:24:07.982150 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:24:07.984261 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:24:08.037103 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:24:08.037345 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:24:08.037480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:08.044152 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:24:08.044866 [debug] [ThreadPool]: On list_dev: Close
[0m17:24:08.045203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m17:24:08.045404 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m17:24:08.048447 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m17:24:08.048601 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:24:08.048721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:08.049109 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:24:08.049639 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m17:24:08.049752 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m17:24:08.049958 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:24:08.050133 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m17:24:08.050262 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m17:24:08.050489 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:24:08.050888 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m17:24:08.051021 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m17:24:08.051134 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m17:24:08.051809 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:24:08.051958 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m17:24:08.052539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m17:24:08.055038 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:24:08.055204 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m17:24:08.055319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:08.055561 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:24:08.055687 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:24:08.055805 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m17:24:08.064506 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:24:08.065247 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m17:24:08.065888 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m17:24:08.066037 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m17:24:08.066456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86cac20b-7a46-4ba1-9831-720843d82fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c69c0>]}
[0m17:24:08.066689 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:08.066818 [debug] [MainThread]: On master: BEGIN
[0m17:24:08.066930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:08.067188 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:24:08.067332 [debug] [MainThread]: On master: COMMIT
[0m17:24:08.067453 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:08.067605 [debug] [MainThread]: On master: COMMIT
[0m17:24:08.067985 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:24:08.068110 [debug] [MainThread]: On master: Close
[0m17:24:08.071409 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m17:24:08.071671 [info ] [Thread-1 (]: 1 of 3 START sql view model main_staging.stg_stackoverflow__comments ........... [RUN]
[0m17:24:08.071878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.stackoverflow_analysis_aw.stg_stackoverflow__comments)
[0m17:24:08.072032 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m17:24:08.075553 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:24:08.076046 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m17:24:08.089367 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:24:08.089988 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:24:08.090158 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: BEGIN
[0m17:24:08.090288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:08.090563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:24:08.090686 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:24:08.090814 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

  
  create view "dev"."main_staging"."stg_stackoverflow__comments__dbt_tmp" as (
    

with source as (
        select * from 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/comments.parquet'
  ),
  renamed as (
      select
        Id as comment_id,
        PostId as post_id,
        UserId as user_id,
        Text as comment_text,
        CreationDate as created_at
      from source
  )
  select * from renamed
  );

[0m17:24:10.289131 [debug] [Thread-1 (]: SQL status: OK in 2.198 seconds
[0m17:24:10.295997 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:24:10.296382 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */
alter view "dev"."main_staging"."stg_stackoverflow__comments__dbt_tmp" rename to "stg_stackoverflow__comments"
[0m17:24:10.296969 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:24:10.304464 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m17:24:10.304707 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:24:10.304918 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m17:24:10.305808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:24:10.309009 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m17:24:10.309245 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */
drop view if exists "dev"."main_staging"."stg_stackoverflow__comments__dbt_backup" cascade
[0m17:24:10.309596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:24:10.311091 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: Close
[0m17:24:10.312460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86cac20b-7a46-4ba1-9831-720843d82fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ed010>]}
[0m17:24:10.312831 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main_staging.stg_stackoverflow__comments ...... [[32mOK[0m in 2.24s]
[0m17:24:10.313161 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m17:24:10.313378 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m17:24:10.313676 [info ] [Thread-1 (]: 2 of 3 START sql view model main_staging.stg_stackoverflow__posts .............. [RUN]
[0m17:24:10.313913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.stg_stackoverflow__comments, now model.stackoverflow_analysis_aw.stg_stackoverflow__posts)
[0m17:24:10.314107 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m17:24:10.315751 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:24:10.316462 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m17:24:10.318039 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:24:10.318644 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:24:10.318819 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: BEGIN
[0m17:24:10.319049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:10.319465 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:24:10.319665 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:24:10.319863 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

  
  create view "dev"."main_staging"."stg_stackoverflow__posts__dbt_tmp" as (
    

with source as (
        select * from 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/posts.parquet'
  ),
  renamed as (
      select
        Id as post_id,
        OwnerUserId as owner_user_id,
        PostTypeId as post_type_id,
        ViewCount as view_count,
        CreationDate as created_at,
        AcceptedAnswerId as accepted_answer_id,
        ParentId as parent_id
      from source
  )
  select * from renamed
  );

[0m17:24:12.770775 [debug] [Thread-1 (]: SQL status: OK in 2.450 seconds
[0m17:24:12.774395 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:24:12.774754 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */
alter view "dev"."main_staging"."stg_stackoverflow__posts__dbt_tmp" rename to "stg_stackoverflow__posts"
[0m17:24:12.775405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:24:12.776442 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m17:24:12.776748 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:24:12.777003 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m17:24:12.778023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:24:12.779410 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m17:24:12.779658 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */
drop view if exists "dev"."main_staging"."stg_stackoverflow__posts__dbt_backup" cascade
[0m17:24:12.780035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:24:12.780943 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: Close
[0m17:24:12.781395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86cac20b-7a46-4ba1-9831-720843d82fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f0ec0>]}
[0m17:24:12.781887 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main_staging.stg_stackoverflow__posts ......... [[32mOK[0m in 2.47s]
[0m17:24:12.782289 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m17:24:12.782577 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m17:24:12.782987 [info ] [Thread-1 (]: 3 of 3 START sql view model main_staging.stg_stackoverflow__users .............. [RUN]
[0m17:24:12.783344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.stg_stackoverflow__posts, now model.stackoverflow_analysis_aw.stg_stackoverflow__users)
[0m17:24:12.783588 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m17:24:12.785665 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:24:12.786552 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m17:24:12.788584 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:24:12.789203 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:24:12.789410 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: BEGIN
[0m17:24:12.789605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:12.789960 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:24:12.790158 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:24:12.790364 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

  
  create view "dev"."main_staging"."stg_stackoverflow__users__dbt_tmp" as (
    

with source as (
        select * from 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/users.parquet'
  ),
  renamed as (
      select
        Id as user_id,
        DisplayName as display_name,
        CreationDate as created_at,
        LastAccessDate as last_access_at
      from source
  )
  select * from renamed
  );

[0m17:24:14.579003 [debug] [Thread-1 (]: SQL status: OK in 1.788 seconds
[0m17:24:14.583155 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:24:14.583595 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */
alter view "dev"."main_staging"."stg_stackoverflow__users__dbt_tmp" rename to "stg_stackoverflow__users"
[0m17:24:14.584734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:24:14.586439 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: COMMIT
[0m17:24:14.586921 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:24:14.587279 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: COMMIT
[0m17:24:14.588472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:24:14.590892 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m17:24:14.591208 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */
drop view if exists "dev"."main_staging"."stg_stackoverflow__users__dbt_backup" cascade
[0m17:24:14.591805 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:24:14.593124 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: Close
[0m17:24:14.593620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86cac20b-7a46-4ba1-9831-720843d82fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e11d0>]}
[0m17:24:14.594105 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main_staging.stg_stackoverflow__users ......... [[32mOK[0m in 1.81s]
[0m17:24:14.594503 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m17:24:14.595382 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:14.595598 [debug] [MainThread]: On master: BEGIN
[0m17:24:14.595786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:14.596140 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:24:14.596331 [debug] [MainThread]: On master: COMMIT
[0m17:24:14.596515 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:14.596695 [debug] [MainThread]: On master: COMMIT
[0m17:24:14.596955 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:24:14.597144 [debug] [MainThread]: On master: Close
[0m17:24:14.597385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:14.597569 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__users' was properly closed.
[0m17:24:14.597807 [info ] [MainThread]: 
[0m17:24:14.598032 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.62 seconds (6.62s).
[0m17:24:14.598666 [debug] [MainThread]: Command end result
[0m17:24:14.613692 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:24:14.614774 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:24:14.618117 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:24:14.618266 [info ] [MainThread]: 
[0m17:24:14.618442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:14.618578 [info ] [MainThread]: 
[0m17:24:14.618720 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:24:14.620425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.95589, "process_in_blocks": "0", "process_kernel_time": 0.237914, "process_mem_max_rss": "164511744", "process_out_blocks": "0", "process_user_time": 1.121173}
[0m17:24:14.620657 [debug] [MainThread]: Command `dbt run` succeeded at 17:24:14.620610 after 6.96 seconds
[0m17:24:14.620843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109011650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a39550>]}
[0m17:24:14.621017 [debug] [MainThread]: Flushing usage events
[0m17:24:15.536762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:15.135942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cfc50>]}


============================== 17:25:15.138200 | ea37ae74-0e6e-4048-b81b-789b49488159 ==============================
[0m17:25:15.138200 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:25:15.138466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:15.220080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea37ae74-0e6e-4048-b81b-789b49488159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739df30>]}
[0m17:25:15.240904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea37ae74-0e6e-4048-b81b-789b49488159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f7460>]}
[0m17:25:15.242382 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:25:15.284844 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:25:15.344538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:15.344813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:15.348237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
- models.stackoverflow_analysis_aw.intermediate
[0m17:25:15.367184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea37ae74-0e6e-4048-b81b-789b49488159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755a550>]}
[0m17:25:15.409141 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:25:15.410200 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:25:15.424054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea37ae74-0e6e-4048-b81b-789b49488159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107945130>]}
[0m17:25:15.424337 [info ] [MainThread]: Found 3 models, 12 data tests, 7 sources, 430 macros
[0m17:25:15.424494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea37ae74-0e6e-4048-b81b-789b49488159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d6270>]}
[0m17:25:15.425453 [info ] [MainThread]: 
[0m17:25:15.425595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:15.425698 [info ] [MainThread]: 
[0m17:25:15.425902 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:25:15.427830 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_staging'
[0m17:25:15.481697 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:25:15.481935 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m17:25:15.482068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:15.489391 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:25:15.489585 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:25:15.489713 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m17:25:15.498546 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:25:15.499329 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m17:25:15.499980 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m17:25:15.500162 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m17:25:15.500706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea37ae74-0e6e-4048-b81b-789b49488159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b89a50>]}
[0m17:25:15.500916 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:15.501035 [debug] [MainThread]: On master: BEGIN
[0m17:25:15.501145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:15.501373 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:25:15.501486 [debug] [MainThread]: On master: COMMIT
[0m17:25:15.501597 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:15.501702 [debug] [MainThread]: On master: COMMIT
[0m17:25:15.501895 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:25:15.502072 [debug] [MainThread]: On master: Close
[0m17:25:15.503349 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:25:15.503593 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 . [RUN]
[0m17:25:15.503830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96)
[0m17:25:15.503981 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:25:15.510903 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:25:15.511410 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:25:15.518997 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:25:15.519663 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:25:15.519888 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: BEGIN
[0m17:25:15.520036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:15.520337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:15.520467 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:25:15.520602 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        post_type_id as value_field,
        count(*) as n_records

    from "dev"."main_staging"."stg_stackoverflow__posts"
    group by post_type_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m17:25:35.822215 [debug] [Thread-1 (]: SQL status: OK in 20.301 seconds
[0m17:25:35.824288 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: ROLLBACK
[0m17:25:35.824620 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96'
[0m17:25:35.824750 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: Close
[0m17:25:35.825011 [error] [Thread-1 (]: 1 of 12 FAIL 6 accepted_values_stg_stackoverflow__posts_post_type_id__1__2 ..... [[31mFAIL 6[0m in 20.32s]
[0m17:25:35.825250 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:25:35.825398 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:25:35.825521 [info ] [Thread-1 (]: 2 of 12 START test not_null_stg_stackoverflow__comments_comment_id ............. [RUN]
[0m17:25:35.825750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca)
[0m17:25:35.825919 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:25:35.828422 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:25:35.829044 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:25:35.829911 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:25:35.830362 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:25:35.830483 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: BEGIN
[0m17:25:35.830589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:35.830874 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:35.830997 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:25:35.831128 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_id
from "dev"."main_staging"."stg_stackoverflow__comments"
where comment_id is null



      
    ) dbt_internal_test
[0m17:25:38.025571 [debug] [Thread-1 (]: SQL status: OK in 2.194 seconds
[0m17:25:38.026343 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: ROLLBACK
[0m17:25:38.026665 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca'
[0m17:25:38.026807 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: Close
[0m17:25:38.027058 [info ] [Thread-1 (]: 2 of 12 PASS not_null_stg_stackoverflow__comments_comment_id ................... [[32mPASS[0m in 2.20s]
[0m17:25:38.027282 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:25:38.027447 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:25:38.027636 [info ] [Thread-1 (]: 3 of 12 START test not_null_stg_stackoverflow__posts_created_at ................ [RUN]
[0m17:25:38.027851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf)
[0m17:25:38.027985 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:25:38.030222 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:25:38.030806 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:25:38.031563 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:25:38.031966 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:25:38.032094 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: BEGIN
[0m17:25:38.032210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:38.032478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:38.032591 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:25:38.032717 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select created_at
from "dev"."main_staging"."stg_stackoverflow__posts"
where created_at is null



      
    ) dbt_internal_test
[0m17:25:40.627736 [debug] [Thread-1 (]: SQL status: OK in 2.595 seconds
[0m17:25:40.629353 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: ROLLBACK
[0m17:25:40.629946 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf'
[0m17:25:40.630176 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: Close
[0m17:25:40.630591 [info ] [Thread-1 (]: 3 of 12 PASS not_null_stg_stackoverflow__posts_created_at ...................... [[32mPASS[0m in 2.60s]
[0m17:25:40.630958 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:25:40.631194 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:25:40.631519 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_stackoverflow__posts_post_id ................... [RUN]
[0m17:25:40.631887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba)
[0m17:25:40.632132 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:25:40.635293 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:25:40.636114 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:25:40.637249 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:25:40.637879 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:25:40.638076 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: BEGIN
[0m17:25:40.638253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:40.638642 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:40.638813 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:25:40.639001 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."main_staging"."stg_stackoverflow__posts"
where post_id is null



      
    ) dbt_internal_test
[0m17:25:42.860550 [debug] [Thread-1 (]: SQL status: OK in 2.221 seconds
[0m17:25:42.861496 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: ROLLBACK
[0m17:25:42.861855 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba'
[0m17:25:42.862000 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: Close
[0m17:25:42.862288 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_stackoverflow__posts_post_id ......................... [[32mPASS[0m in 2.23s]
[0m17:25:42.862516 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:25:42.862675 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:25:42.862877 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_stackoverflow__posts_post_type_id .............. [RUN]
[0m17:25:42.863119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3)
[0m17:25:42.863273 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:25:42.865199 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:25:42.865816 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:25:42.867290 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:25:42.867800 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:25:42.867956 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: BEGIN
[0m17:25:42.868082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:42.868403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:42.868527 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m17:25:42.868657 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_type_id
from "dev"."main_staging"."stg_stackoverflow__posts"
where post_type_id is null



      
    ) dbt_internal_test
[0m17:25:45.146547 [debug] [Thread-1 (]: SQL status: OK in 2.278 seconds
[0m17:25:45.148199 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: ROLLBACK
[0m17:25:45.148840 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3'
[0m17:25:45.149107 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: Close
[0m17:25:45.149583 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_stackoverflow__posts_post_type_id .................... [[32mPASS[0m in 2.29s]
[0m17:25:45.149965 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m17:25:45.150223 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:25:45.150529 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_stackoverflow__posts_view_count ................ [RUN]
[0m17:25:45.150902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653)
[0m17:25:45.151147 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:25:45.153930 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:25:45.154767 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:25:45.155953 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:25:45.156602 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:25:45.156816 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: BEGIN
[0m17:25:45.157004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:45.157426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:25:45.157618 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m17:25:45.157806 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "dev"."main_staging"."stg_stackoverflow__posts"
where view_count is null



      
    ) dbt_internal_test
[0m17:26:01.772586 [debug] [Thread-1 (]: SQL status: OK in 16.614 seconds
[0m17:26:01.774313 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: ROLLBACK
[0m17:26:01.774654 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653'
[0m17:26:01.774780 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: Close
[0m17:26:01.775040 [error] [Thread-1 (]: 6 of 12 FAIL 34792855 not_null_stg_stackoverflow__posts_view_count ............. [[31mFAIL 34792855[0m in 16.62s]
[0m17:26:01.775259 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m17:26:01.775429 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:26:01.775555 [info ] [Thread-1 (]: 7 of 12 START test not_null_stg_stackoverflow__users_user_id ................... [RUN]
[0m17:26:01.775769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef)
[0m17:26:01.775943 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:26:01.777558 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:26:01.778243 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:26:01.778928 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:26:01.779391 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:26:01.779517 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: BEGIN
[0m17:26:01.779628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:01.779874 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:01.779982 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"
[0m17:26:01.780098 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "dev"."main_staging"."stg_stackoverflow__users"
where user_id is null



      
    ) dbt_internal_test
[0m17:26:03.515066 [debug] [Thread-1 (]: SQL status: OK in 1.734 seconds
[0m17:26:03.517761 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: ROLLBACK
[0m17:26:03.518679 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef'
[0m17:26:03.519063 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef: Close
[0m17:26:03.519742 [info ] [Thread-1 (]: 7 of 12 PASS not_null_stg_stackoverflow__users_user_id ......................... [[32mPASS[0m in 1.74s]
[0m17:26:03.520300 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef
[0m17:26:03.520677 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:26:03.521141 [info ] [Thread-1 (]: 8 of 12 START test positive_value_stg_stackoverflow__posts_view_count .......... [RUN]
[0m17:26:03.521722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__users_user_id.74948514ef, now test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35)
[0m17:26:03.522112 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:26:03.533611 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:26:03.535292 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:26:03.537709 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:26:03.538966 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:26:03.539351 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: BEGIN
[0m17:26:03.539635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:03.540182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:26:03.540497 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:26:03.540784 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main_staging"."stg_stackoverflow__posts"
where view_count < 0


      
    ) dbt_internal_test
[0m17:26:05.696471 [debug] [Thread-1 (]: SQL status: OK in 2.155 seconds
[0m17:26:05.698133 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: ROLLBACK
[0m17:26:05.698704 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35'
[0m17:26:05.698941 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: Close
[0m17:26:05.699376 [info ] [Thread-1 (]: 8 of 12 PASS positive_value_stg_stackoverflow__posts_view_count ................ [[32mPASS[0m in 2.18s]
[0m17:26:05.699745 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:26:05.699986 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:26:05.700278 [info ] [Thread-1 (]: 9 of 12 START test unique_stg_stackoverflow__comments_comment_id ............... [RUN]
[0m17:26:05.700623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35, now test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9)
[0m17:26:05.700867 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:26:05.705028 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:26:05.705789 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:26:05.707269 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:26:05.707896 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:26:05.708088 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: BEGIN
[0m17:26:05.708264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:05.708627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:05.708802 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"
[0m17:26:05.708989 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    comment_id as unique_field,
    count(*) as n_records

from "dev"."main_staging"."stg_stackoverflow__comments"
where comment_id is not null
group by comment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:26:45.840960 [debug] [Thread-1 (]: SQL status: OK in 40.132 seconds
[0m17:26:45.842289 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: ROLLBACK
[0m17:26:45.842606 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9'
[0m17:26:45.842732 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9: Close
[0m17:26:45.842957 [info ] [Thread-1 (]: 9 of 12 PASS unique_stg_stackoverflow__comments_comment_id ..................... [[32mPASS[0m in 40.14s]
[0m17:26:45.843167 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9
[0m17:26:45.843317 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:26:45.843494 [info ] [Thread-1 (]: 10 of 12 START test unique_stg_stackoverflow__posts_post_id .................... [RUN]
[0m17:26:45.843715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.unique_stg_stackoverflow__comments_comment_id.e73f6e18d9, now test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed)
[0m17:26:45.843846 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:26:45.845278 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:26:45.845942 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:26:45.846599 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:26:45.847030 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:26:45.847146 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: BEGIN
[0m17:26:45.847250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:45.847497 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:26:45.847599 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m17:26:45.847714 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "dev"."main_staging"."stg_stackoverflow__posts"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:27:13.961911 [debug] [Thread-1 (]: SQL status: OK in 28.114 seconds
[0m17:27:13.963154 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: ROLLBACK
[0m17:27:13.963460 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed'
[0m17:27:13.963581 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: Close
[0m17:27:13.963801 [info ] [Thread-1 (]: 10 of 12 PASS unique_stg_stackoverflow__posts_post_id .......................... [[32mPASS[0m in 28.12s]
[0m17:27:13.964007 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m17:27:13.964149 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:27:13.964313 [info ] [Thread-1 (]: 11 of 12 START test unique_stg_stackoverflow__users_user_id .................... [RUN]
[0m17:27:13.964529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed, now test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262)
[0m17:27:13.964664 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:27:13.966311 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:27:13.966782 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:27:13.967445 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:27:13.967755 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:27:13.967870 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: BEGIN
[0m17:27:13.967972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:13.968219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:13.968321 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"
[0m17:27:13.968433 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dev"."main_staging"."stg_stackoverflow__users"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:27:25.910987 [debug] [Thread-1 (]: SQL status: OK in 11.942 seconds
[0m17:27:25.912224 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: ROLLBACK
[0m17:27:25.912521 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262'
[0m17:27:25.912643 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262: Close
[0m17:27:25.912864 [info ] [Thread-1 (]: 11 of 12 PASS unique_stg_stackoverflow__users_user_id .......................... [[32mPASS[0m in 11.95s]
[0m17:27:25.913076 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262
[0m17:27:25.913213 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:27:25.913378 [info ] [Thread-1 (]: 12 of 12 START test valid_timestamp_stg_stackoverflow__posts_created_at ........ [RUN]
[0m17:27:25.913593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.unique_stg_stackoverflow__users_user_id.582181a262, now test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe)
[0m17:27:25.913726 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:27:25.915636 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:27:25.916115 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:27:25.917062 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:27:25.917409 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:27:25.917533 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: BEGIN
[0m17:27:25.917641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:25.917898 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:25.918018 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m17:27:25.918144 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main_staging"."stg_stackoverflow__posts"
where created_at > CURRENT_TIMESTAMP
  or created_at < '2008-01-01'


      
    ) dbt_internal_test
[0m17:27:35.803798 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:27:35.804409 [debug] [MainThread]: DuckDB adapter: cancelling query on connection test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe. Details: Connection(type='duckdb', name='test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x1073bc7d0>, _credentials=DuckDBCredentials(database='dev', schema='main', path='dev.duckdb', config_options=None, extensions=None, settings={}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m17:27:35.804622 [debug] [MainThread]: DuckDB adapter: query cancelled on connection test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:27:35.804757 [error] [MainThread]: CANCEL query test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe  [[31mCANCEL[0m]
[0m17:27:36.424303 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main_staging"."stg_stackoverflow__posts"
where created_at > CURRENT_TIMESTAMP
  or created_at < '2008-01-01'


      
    ) dbt_internal_test
[0m17:27:36.424536 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:27:36.424734 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: ROLLBACK
[0m17:27:36.429075 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe'
[0m17:27:36.429212 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: Close
[0m17:27:36.430665 [debug] [Thread-1 (]: Runtime Error in test valid_timestamp_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  INTERRUPT Error: Interrupted!
[0m17:27:36.430847 [error] [Thread-1 (]: 12 of 12 ERROR valid_timestamp_stg_stackoverflow__posts_created_at ............. [[31mERROR[0m in 10.52s]
[0m17:27:36.431065 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m17:27:36.431244 [info ] [MainThread]: 
[0m17:27:36.431459 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m17:27:36.431587 [info ] [MainThread]: 
[0m17:27:36.431747 [error] [MainThread]: [31mFailure in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)[0m
[0m17:27:36.431885 [error] [MainThread]:   Got 6 results, configured to fail if != 0
[0m17:27:36.431980 [info ] [MainThread]: 
[0m17:27:36.432113 [info ] [MainThread]:   compiled code at target/compiled/stackoverflow_analysis_aw/models/staging/schema.yml/accepted_values_stg_stackoverflow__posts_post_type_id__1__2.sql
[0m17:27:36.432214 [info ] [MainThread]: 
[0m17:27:36.432344 [error] [MainThread]: [31mFailure in test not_null_stg_stackoverflow__posts_view_count (models/staging/schema.yml)[0m
[0m17:27:36.432470 [error] [MainThread]:   Got 34792855 results, configured to fail if != 0
[0m17:27:36.432570 [info ] [MainThread]: 
[0m17:27:36.432704 [info ] [MainThread]:   compiled code at target/compiled/stackoverflow_analysis_aw/models/staging/schema.yml/not_null_stg_stackoverflow__posts_view_count.sql
[0m17:27:36.432805 [info ] [MainThread]: 
[0m17:27:36.432924 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=0 TOTAL=11
[0m17:27:36.433037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:36.433129 [debug] [MainThread]: Connection 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe' was properly closed.
[0m17:27:36.433236 [info ] [MainThread]: 
[0m17:27:36.433345 [info ] [MainThread]: Finished running 11 data tests in 0 hours 2 minutes and 21.01 seconds (141.01s).
[0m17:27:36.433516 [error] [MainThread]: Encountered an error:

[0m17:27:36.436956 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/main.py", line 828, in test
    results = task.run()
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 108, in join
    self.all_tasks_done.wait()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

[0m17:27:36.438717 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 141.33295, "process_in_blocks": "0", "process_kernel_time": 4.536312, "process_mem_max_rss": "2670034944", "process_out_blocks": "0", "process_user_time": 31.028006}
[0m17:27:36.438921 [debug] [MainThread]: Command `dbt test` failed at 17:27:36.438878 after 141.33 seconds
[0m17:27:36.439090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793fee0>]}
[0m17:27:36.439239 [debug] [MainThread]: Flushing usage events
[0m17:27:37.343909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:42.773990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113275d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149cfc50>]}


============================== 17:28:42.775950 | 5bd6cd9c-e533-4b66-8e46-834acbbc36f8 ==============================
[0m17:28:42.775950 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:28:42.776226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select test_type:generic', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:28:42.857778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bd6cd9c-e533-4b66-8e46-834acbbc36f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b9df30>]}
[0m17:28:42.878377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bd6cd9c-e533-4b66-8e46-834acbbc36f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147f7460>]}
[0m17:28:42.879858 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:28:42.922774 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:28:42.981847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:28:42.982095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:28:42.985170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stackoverflow_analysis_aw.intermediate
- models.stackoverflow_analysis_aw.marts
[0m17:28:43.003830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bd6cd9c-e533-4b66-8e46-834acbbc36f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e5a550>]}
[0m17:28:43.039021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:28:43.040056 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:28:43.053772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bd6cd9c-e533-4b66-8e46-834acbbc36f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115245130>]}
[0m17:28:43.054049 [info ] [MainThread]: Found 3 models, 12 data tests, 7 sources, 430 macros
[0m17:28:43.054199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bd6cd9c-e533-4b66-8e46-834acbbc36f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150da270>]}
[0m17:28:43.055103 [info ] [MainThread]: 
[0m17:28:43.055256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:28:43.055361 [info ] [MainThread]: 
[0m17:28:43.055562 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:28:43.057551 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_staging'
[0m17:28:43.112679 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:28:43.112913 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m17:28:43.113058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:43.119443 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:28:43.119631 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:28:43.119763 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m17:28:43.128620 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:28:43.129350 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m17:28:43.129965 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m17:28:43.130135 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m17:28:43.130692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bd6cd9c-e533-4b66-8e46-834acbbc36f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115489a50>]}
[0m17:28:43.130936 [debug] [MainThread]: Using duckdb connection "master"
[0m17:28:43.131071 [debug] [MainThread]: On master: BEGIN
[0m17:28:43.131192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:43.131409 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:28:43.131520 [debug] [MainThread]: On master: COMMIT
[0m17:28:43.131629 [debug] [MainThread]: Using duckdb connection "master"
[0m17:28:43.131732 [debug] [MainThread]: On master: COMMIT
[0m17:28:43.131888 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:28:43.131993 [debug] [MainThread]: On master: Close
[0m17:28:43.133155 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:28:43.133367 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 . [RUN]
[0m17:28:43.133582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96)
[0m17:28:43.133741 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:28:43.140085 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:28:43.140876 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:28:43.150605 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:28:43.151217 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:28:43.151393 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: BEGIN
[0m17:28:43.151525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:43.151855 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:28:43.152039 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m17:28:43.152197 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        post_type_id as value_field,
        count(*) as n_records

    from "dev"."main_staging"."stg_stackoverflow__posts"
    group by post_type_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m17:29:01.433732 [debug] [Thread-1 (]: SQL status: OK in 18.281 seconds
[0m17:29:01.435948 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: ROLLBACK
[0m17:29:01.436260 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96'
[0m17:29:01.436394 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: Close
[0m17:29:01.436637 [error] [Thread-1 (]: 1 of 12 FAIL 6 accepted_values_stg_stackoverflow__posts_post_type_id__1__2 ..... [[31mFAIL 6[0m in 18.30s]
[0m17:29:01.436866 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m17:29:01.436999 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:29:01.437181 [info ] [Thread-1 (]: 2 of 12 START test not_null_stg_stackoverflow__comments_comment_id ............. [RUN]
[0m17:29:01.437411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca)
[0m17:29:01.437547 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:29:01.439978 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:29:01.440559 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:29:01.441406 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:29:01.441851 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:29:01.441974 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: BEGIN
[0m17:29:01.442080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:01.442335 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:29:01.442440 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"
[0m17:29:01.442553 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comment_id
from "dev"."main_staging"."stg_stackoverflow__comments"
where comment_id is null



      
    ) dbt_internal_test
[0m17:29:03.596384 [debug] [Thread-1 (]: SQL status: OK in 2.154 seconds
[0m17:29:03.597456 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: ROLLBACK
[0m17:29:03.597877 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca'
[0m17:29:03.598067 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca: Close
[0m17:29:03.598406 [info ] [Thread-1 (]: 2 of 12 PASS not_null_stg_stackoverflow__comments_comment_id ................... [[32mPASS[0m in 2.16s]
[0m17:29:03.598702 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca
[0m17:29:03.598900 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:29:03.599150 [info ] [Thread-1 (]: 3 of 12 START test not_null_stg_stackoverflow__posts_created_at ................ [RUN]
[0m17:29:03.599470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__comments_comment_id.5b552bb4ca, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf)
[0m17:29:03.599679 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:29:03.601704 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:29:03.602229 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:29:03.602957 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:29:03.603372 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:29:03.603507 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: BEGIN
[0m17:29:03.603629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:03.603876 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:29:03.604006 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m17:29:03.604164 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select created_at
from "dev"."main_staging"."stg_stackoverflow__posts"
where created_at is null



      
    ) dbt_internal_test
[0m17:29:05.890378 [debug] [Thread-1 (]: SQL status: OK in 2.286 seconds
[0m17:29:05.892049 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: ROLLBACK
[0m17:29:05.892641 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf'
[0m17:29:05.892878 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: Close
[0m17:29:05.893328 [info ] [Thread-1 (]: 3 of 12 PASS not_null_stg_stackoverflow__posts_created_at ...................... [[32mPASS[0m in 2.29s]
[0m17:29:05.893687 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m17:29:05.893942 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:29:05.894249 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_stackoverflow__posts_post_id ................... [RUN]
[0m17:29:05.894607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba)
[0m17:29:05.894854 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:29:05.898066 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:29:05.898889 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:29:05.899949 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:29:05.900524 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:29:05.900717 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: BEGIN
[0m17:29:05.900892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:05.901244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:29:05.901416 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m17:29:05.901599 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."main_staging"."stg_stackoverflow__posts"
where post_id is null



      
    ) dbt_internal_test
[0m17:29:07.013886 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:29:07.016025 [debug] [MainThread]: DuckDB adapter: cancelling query on connection test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba. Details: Connection(type='duckdb', name='test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x114bb8910>, _credentials=DuckDBCredentials(database='dev', schema='main', path='dev.duckdb', config_options=None, extensions=None, settings={}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m17:29:07.016645 [debug] [MainThread]: DuckDB adapter: query cancelled on connection test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:29:07.017086 [error] [MainThread]: CANCEL query test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba  [[31mCANCEL[0m]
[0m17:29:08.404431 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."main_staging"."stg_stackoverflow__posts"
where post_id is null



      
    ) dbt_internal_test
[0m17:29:08.404937 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:29:08.405311 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: ROLLBACK
[0m17:29:08.411884 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba'
[0m17:29:08.412148 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: Close
[0m17:29:08.414636 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  INTERRUPT Error: Interrupted!
[0m17:29:08.414941 [error] [Thread-1 (]: 4 of 12 ERROR not_null_stg_stackoverflow__posts_post_id ........................ [[31mERROR[0m in 2.52s]
[0m17:29:08.415249 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m17:29:08.415510 [info ] [MainThread]: 
[0m17:29:08.415817 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m17:29:08.416012 [info ] [MainThread]: 
[0m17:29:08.416244 [error] [MainThread]: [31mFailure in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)[0m
[0m17:29:08.416455 [error] [MainThread]:   Got 6 results, configured to fail if != 0
[0m17:29:08.416605 [info ] [MainThread]: 
[0m17:29:08.416789 [info ] [MainThread]:   compiled code at target/compiled/stackoverflow_analysis_aw/models/staging/schema.yml/accepted_values_stg_stackoverflow__posts_post_type_id__1__2.sql
[0m17:29:08.416947 [info ] [MainThread]: 
[0m17:29:08.417119 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:29:08.417273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:08.417412 [debug] [MainThread]: Connection 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba' was properly closed.
[0m17:29:08.417566 [info ] [MainThread]: 
[0m17:29:08.417723 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 25.36 seconds (25.36s).
[0m17:29:08.417965 [error] [MainThread]: Encountered an error:

[0m17:29:08.419889 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/main.py", line 828, in test
    results = task.run()
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 108, in join
    self.all_tasks_done.wait()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

[0m17:29:08.422300 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 25.677351, "process_in_blocks": "0", "process_kernel_time": 0.634316, "process_mem_max_rss": "192790528", "process_out_blocks": "0", "process_user_time": 2.602771}
[0m17:29:08.422587 [debug] [MainThread]: Command `dbt test` failed at 17:29:08.422528 after 25.68 seconds
[0m17:29:08.422798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11472fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11523f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11523f800>]}
[0m17:29:08.422997 [debug] [MainThread]: Flushing usage events
[0m17:29:09.309110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:18.017546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108131d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cfc50>]}


============================== 17:29:18.021202 | 017c0694-6ce0-4870-86b9-3a14367b264c ==============================
[0m17:29:18.021202 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:29:18.021654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select test_name:positive_value', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:29:18.106078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '017c0694-6ce0-4870-86b9-3a14367b264c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949df30>]}
[0m17:29:18.127008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '017c0694-6ce0-4870-86b9-3a14367b264c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f7460>]}
[0m17:29:18.128556 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:29:18.171548 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:29:18.231645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:29:18.231896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:29:18.235120 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
- models.stackoverflow_analysis_aw.intermediate
[0m17:29:18.253993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '017c0694-6ce0-4870-86b9-3a14367b264c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10975a550>]}
[0m17:29:18.288401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:29:18.289326 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:29:18.302697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '017c0694-6ce0-4870-86b9-3a14367b264c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a45130>]}
[0m17:29:18.302963 [info ] [MainThread]: Found 3 models, 12 data tests, 7 sources, 430 macros
[0m17:29:18.303125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '017c0694-6ce0-4870-86b9-3a14367b264c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d6270>]}
[0m17:29:18.303893 [info ] [MainThread]: 
[0m17:29:18.304046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:29:18.304207 [info ] [MainThread]: 
[0m17:29:18.304417 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:29:18.306244 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_staging'
[0m17:29:18.360232 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:29:18.360470 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m17:29:18.360602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:18.367052 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:29:18.367250 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:29:18.367389 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m17:29:18.377069 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:29:18.377897 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m17:29:18.378522 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m17:29:18.378663 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m17:29:18.379207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '017c0694-6ce0-4870-86b9-3a14367b264c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d85a50>]}
[0m17:29:18.379403 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:18.379520 [debug] [MainThread]: On master: BEGIN
[0m17:29:18.379628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:18.379865 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:29:18.379980 [debug] [MainThread]: On master: COMMIT
[0m17:29:18.380087 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:18.380189 [debug] [MainThread]: On master: COMMIT
[0m17:29:18.380336 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:29:18.380444 [debug] [MainThread]: On master: Close
[0m17:29:18.381539 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:29:18.381709 [info ] [Thread-1 (]: 1 of 1 START test positive_value_stg_stackoverflow__posts_view_count ........... [RUN]
[0m17:29:18.381893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35)
[0m17:29:18.382036 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:29:18.387771 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:29:18.388719 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:29:18.398131 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:29:18.398717 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:29:18.398896 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: BEGIN
[0m17:29:18.399030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:18.399307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:29:18.399445 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m17:29:18.399583 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main_staging"."stg_stackoverflow__posts"
where view_count < 0


      
    ) dbt_internal_test
[0m17:29:20.733794 [debug] [Thread-1 (]: SQL status: OK in 2.334 seconds
[0m17:29:20.737546 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: ROLLBACK
[0m17:29:20.738136 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35'
[0m17:29:20.738376 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: Close
[0m17:29:20.738853 [info ] [Thread-1 (]: 1 of 1 PASS positive_value_stg_stackoverflow__posts_view_count ................. [[32mPASS[0m in 2.36s]
[0m17:29:20.739236 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m17:29:20.740242 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:20.740508 [debug] [MainThread]: On master: BEGIN
[0m17:29:20.740694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:29:20.741141 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:29:20.741323 [debug] [MainThread]: On master: COMMIT
[0m17:29:20.741493 [debug] [MainThread]: Using duckdb connection "master"
[0m17:29:20.741645 [debug] [MainThread]: On master: COMMIT
[0m17:29:20.741933 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:29:20.742191 [debug] [MainThread]: On master: Close
[0m17:29:20.742453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:20.742628 [debug] [MainThread]: Connection 'test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35' was properly closed.
[0m17:29:20.742813 [info ] [MainThread]: 
[0m17:29:20.742993 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m17:29:20.743380 [debug] [MainThread]: Command end result
[0m17:29:20.756716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:29:20.757860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:29:20.761313 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:29:20.761457 [info ] [MainThread]: 
[0m17:29:20.761618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:20.761743 [info ] [MainThread]: 
[0m17:29:20.761889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:29:20.763725 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.7774916, "process_in_blocks": "0", "process_kernel_time": 0.226191, "process_mem_max_rss": "160088064", "process_out_blocks": "0", "process_user_time": 1.032921}
[0m17:29:20.763931 [debug] [MainThread]: Command `dbt test` succeeded at 17:29:20.763890 after 2.78 seconds
[0m17:29:20.764110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3f120>]}
[0m17:29:20.764275 [debug] [MainThread]: Flushing usage events
[0m17:29:21.584902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:03.537801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0bdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cfc50>]}


============================== 17:35:03.540061 | 522cb871-b8fd-4892-8466-2f8f5a72156f ==============================
[0m17:35:03.540061 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:35:03.540386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select test_name:valid_id_range', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:35:03.625925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '522cb871-b8fd-4892-8466-2f8f5a72156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da9df30>]}
[0m17:35:03.647912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '522cb871-b8fd-4892-8466-2f8f5a72156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f3460>]}
[0m17:35:03.649692 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:35:03.694223 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:35:03.765201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:35:03.765433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:35:03.768413 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
- models.stackoverflow_analysis_aw.intermediate
[0m17:35:03.786813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '522cb871-b8fd-4892-8466-2f8f5a72156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc5a550>]}
[0m17:35:03.824248 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:35:03.825291 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:35:03.838949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '522cb871-b8fd-4892-8466-2f8f5a72156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e049130>]}
[0m17:35:03.839209 [info ] [MainThread]: Found 3 models, 15 data tests, 7 sources, 430 macros
[0m17:35:03.839352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '522cb871-b8fd-4892-8466-2f8f5a72156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dea2890>]}
[0m17:35:03.840339 [info ] [MainThread]: 
[0m17:35:03.840535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:03.840653 [info ] [MainThread]: 
[0m17:35:03.840862 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:03.842947 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_staging'
[0m17:35:03.896561 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:35:03.896798 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m17:35:03.896926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:03.903135 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:35:03.903347 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:35:03.903486 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m17:35:03.913731 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:35:03.914570 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m17:35:03.915245 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m17:35:03.915390 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m17:35:03.915959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '522cb871-b8fd-4892-8466-2f8f5a72156f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e289bf0>]}
[0m17:35:03.916216 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:03.916346 [debug] [MainThread]: On master: BEGIN
[0m17:35:03.916464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:03.916725 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:03.916835 [debug] [MainThread]: On master: COMMIT
[0m17:35:03.916940 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:03.917052 [debug] [MainThread]: On master: COMMIT
[0m17:35:03.917213 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:03.917319 [debug] [MainThread]: On master: Close
[0m17:35:03.918521 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30
[0m17:35:03.918695 [info ] [Thread-1 (]: 1 of 3 START test valid_id_range_stg_stackoverflow__comments_comment_id ........ [RUN]
[0m17:35:03.918878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30)
[0m17:35:03.919016 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30
[0m17:35:03.929022 [debug] [Thread-1 (]: Compilation Error in test valid_id_range_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:03.929274 [error] [Thread-1 (]: 1 of 3 ERROR valid_id_range_stg_stackoverflow__comments_comment_id ............. [[31mERROR[0m in 0.01s]
[0m17:35:03.929482 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30
[0m17:35:03.929638 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285
[0m17:35:03.929846 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30' to be skipped because of status 'error'.  Reason: Compilation Error in test valid_id_range_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:35:03.930097 [info ] [Thread-1 (]: 2 of 3 START test valid_id_range_stg_stackoverflow__posts_post_id .............. [RUN]
[0m17:35:03.930672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30, now test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285)
[0m17:35:03.930834 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285
[0m17:35:03.933719 [debug] [Thread-1 (]: Compilation Error in test valid_id_range_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:03.933949 [error] [Thread-1 (]: 2 of 3 ERROR valid_id_range_stg_stackoverflow__posts_post_id ................... [[31mERROR[0m in 0.00s]
[0m17:35:03.934147 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285
[0m17:35:03.934298 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf
[0m17:35:03.934469 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285' to be skipped because of status 'error'.  Reason: Compilation Error in test valid_id_range_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:35:03.934617 [info ] [Thread-1 (]: 3 of 3 START test valid_id_range_stg_stackoverflow__users_user_id .............. [RUN]
[0m17:35:03.934858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285, now test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf)
[0m17:35:03.935042 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf
[0m17:35:03.937364 [debug] [Thread-1 (]: Compilation Error in test valid_id_range_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:03.937603 [error] [Thread-1 (]: 3 of 3 ERROR valid_id_range_stg_stackoverflow__users_user_id ................... [[31mERROR[0m in 0.00s]
[0m17:35:03.937816 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf
[0m17:35:03.938009 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf' to be skipped because of status 'error'.  Reason: Compilation Error in test valid_id_range_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:35:03.938522 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:03.938652 [debug] [MainThread]: On master: BEGIN
[0m17:35:03.938760 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:03.939056 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:03.939198 [debug] [MainThread]: On master: COMMIT
[0m17:35:03.939310 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:03.939425 [debug] [MainThread]: On master: COMMIT
[0m17:35:03.939612 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:03.939723 [debug] [MainThread]: On master: Close
[0m17:35:03.939880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:03.939985 [debug] [MainThread]: Connection 'test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf' was properly closed.
[0m17:35:03.940111 [info ] [MainThread]: 
[0m17:35:03.940252 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m17:35:03.940668 [debug] [MainThread]: Command end result
[0m17:35:03.951794 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:35:03.952837 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:35:03.955918 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:35:03.956054 [info ] [MainThread]: 
[0m17:35:03.956214 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m17:35:03.956330 [info ] [MainThread]: 
[0m17:35:03.956470 [error] [MainThread]:   Compilation Error in test valid_id_range_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:03.956580 [info ] [MainThread]: 
[0m17:35:03.956703 [error] [MainThread]:   Compilation Error in test valid_id_range_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:03.956805 [info ] [MainThread]: 
[0m17:35:03.956924 [error] [MainThread]:   Compilation Error in test valid_id_range_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:03.957026 [info ] [MainThread]: 
[0m17:35:03.957138 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m17:35:03.958494 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.45069557, "process_in_blocks": "0", "process_kernel_time": 0.203258, "process_mem_max_rss": "141066240", "process_out_blocks": "0", "process_user_time": 0.874323}
[0m17:35:03.958727 [debug] [MainThread]: Command `dbt test` failed at 17:35:03.958687 after 0.45 seconds
[0m17:35:03.958906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d62fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e03afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e03aaf0>]}
[0m17:35:03.959100 [debug] [MainThread]: Flushing usage events
[0m17:35:04.857937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:05.761221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119bdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135cfc50>]}


============================== 17:35:05.763659 | d4303ac1-f643-4d75-93e3-92d1fcefb2ef ==============================
[0m17:35:05.763659 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:35:05.763958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select test_name:valid_id_range --store-failures', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:05.857231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4303ac1-f643-4d75-93e3-92d1fcefb2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11379df30>]}
[0m17:35:05.881067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4303ac1-f643-4d75-93e3-92d1fcefb2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f7460>]}
[0m17:35:05.882867 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:35:05.926704 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:35:05.999254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:35:05.999482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:35:06.003073 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
- models.stackoverflow_analysis_aw.intermediate
[0m17:35:06.021907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4303ac1-f643-4d75-93e3-92d1fcefb2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11435a550>]}
[0m17:35:06.062061 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:35:06.063228 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:35:06.077582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4303ac1-f643-4d75-93e3-92d1fcefb2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114649130>]}
[0m17:35:06.077866 [info ] [MainThread]: Found 3 models, 15 data tests, 7 sources, 430 macros
[0m17:35:06.078018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4303ac1-f643-4d75-93e3-92d1fcefb2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145a2890>]}
[0m17:35:06.078932 [info ] [MainThread]: 
[0m17:35:06.079091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:06.079217 [info ] [MainThread]: 
[0m17:35:06.079451 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:06.081559 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:35:06.136075 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:35:06.136312 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:35:06.136452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:06.143401 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:35:06.144087 [debug] [ThreadPool]: On list_dev: Close
[0m17:35:06.144540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_dbt_test__audit)
[0m17:35:06.144811 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_dbt_test__audit"
"
[0m17:35:06.148635 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m17:35:06.148845 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:35:06.148969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:06.149450 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:06.150027 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m17:35:06.150148 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: BEGIN
[0m17:35:06.150336 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:06.150437 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m17:35:06.150547 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_dbt_test__audit"} */

    
    
        create schema if not exists "dev"."main_dbt_test__audit"
    
[0m17:35:06.150733 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:06.151048 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m17:35:06.151171 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_dbt_test__audit"
[0m17:35:06.151279 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: COMMIT
[0m17:35:06.151686 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:06.151840 [debug] [ThreadPool]: On create_dev_main_dbt_test__audit: Close
[0m17:35:06.152794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_dbt_test__audit, now list_dev_main_dbt_test__audit)
[0m17:35:06.155214 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m17:35:06.155367 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: BEGIN
[0m17:35:06.155471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:06.155690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:06.155790 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_dbt_test__audit"
[0m17:35:06.155895 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_dbt_test__audit"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dbt_test__audit'
    and lower(table_catalog) = 'dev'
  
[0m17:35:06.164422 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:35:06.165101 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: ROLLBACK
[0m17:35:06.165738 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_dbt_test__audit'
[0m17:35:06.165914 [debug] [ThreadPool]: On list_dev_main_dbt_test__audit: Close
[0m17:35:06.166196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_dbt_test__audit, now list_dev_main_staging)
[0m17:35:06.167376 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:35:06.167530 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m17:35:06.167647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:06.167911 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:06.168021 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m17:35:06.168135 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m17:35:06.171185 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:35:06.171797 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m17:35:06.172084 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m17:35:06.172192 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m17:35:06.172690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4303ac1-f643-4d75-93e3-92d1fcefb2ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11487e820>]}
[0m17:35:06.172948 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:06.173089 [debug] [MainThread]: On master: BEGIN
[0m17:35:06.173211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:06.173444 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:06.173555 [debug] [MainThread]: On master: COMMIT
[0m17:35:06.173663 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:06.173760 [debug] [MainThread]: On master: COMMIT
[0m17:35:06.173922 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:06.174036 [debug] [MainThread]: On master: Close
[0m17:35:06.175234 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30
[0m17:35:06.175444 [info ] [Thread-1 (]: 1 of 3 START test valid_id_range_stg_stackoverflow__comments_comment_id ........ [RUN]
[0m17:35:06.175665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30)
[0m17:35:06.175828 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30
[0m17:35:06.184230 [debug] [Thread-1 (]: Compilation Error in test valid_id_range_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:06.184585 [error] [Thread-1 (]: 1 of 3 ERROR valid_id_range_stg_stackoverflow__comments_comment_id ............. [[31mERROR[0m in 0.01s]
[0m17:35:06.184838 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30
[0m17:35:06.185026 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285
[0m17:35:06.185260 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30' to be skipped because of status 'error'.  Reason: Compilation Error in test valid_id_range_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:35:06.185465 [info ] [Thread-1 (]: 2 of 3 START test valid_id_range_stg_stackoverflow__posts_post_id .............. [RUN]
[0m17:35:06.186054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__comments_comment_id.fc3138ff30, now test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285)
[0m17:35:06.186232 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285
[0m17:35:06.189266 [debug] [Thread-1 (]: Compilation Error in test valid_id_range_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:06.189517 [error] [Thread-1 (]: 2 of 3 ERROR valid_id_range_stg_stackoverflow__posts_post_id ................... [[31mERROR[0m in 0.00s]
[0m17:35:06.189734 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285
[0m17:35:06.189891 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf
[0m17:35:06.190070 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285' to be skipped because of status 'error'.  Reason: Compilation Error in test valid_id_range_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:35:06.190240 [info ] [Thread-1 (]: 3 of 3 START test valid_id_range_stg_stackoverflow__users_user_id .............. [RUN]
[0m17:35:06.190511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285, now test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf)
[0m17:35:06.190712 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf
[0m17:35:06.193244 [debug] [Thread-1 (]: Compilation Error in test valid_id_range_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:06.193474 [error] [Thread-1 (]: 3 of 3 ERROR valid_id_range_stg_stackoverflow__users_user_id ................... [[31mERROR[0m in 0.00s]
[0m17:35:06.193673 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf
[0m17:35:06.193841 [debug] [Thread-4 (]: Marking all children of 'test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf' to be skipped because of status 'error'.  Reason: Compilation Error in test valid_id_range_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:35:06.194459 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:06.194634 [debug] [MainThread]: On master: BEGIN
[0m17:35:06.194829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:06.195136 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:06.195273 [debug] [MainThread]: On master: COMMIT
[0m17:35:06.195388 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:06.195499 [debug] [MainThread]: On master: COMMIT
[0m17:35:06.195693 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:06.195802 [debug] [MainThread]: On master: Close
[0m17:35:06.195983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:06.196100 [debug] [MainThread]: Connection 'test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__users_user_id.6195a7c8bf' was properly closed.
[0m17:35:06.196238 [info ] [MainThread]: 
[0m17:35:06.196412 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m17:35:06.196792 [debug] [MainThread]: Command end result
[0m17:35:06.207822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m17:35:06.208775 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m17:35:06.212161 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m17:35:06.212340 [info ] [MainThread]: 
[0m17:35:06.212502 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m17:35:06.212623 [info ] [MainThread]: 
[0m17:35:06.212768 [error] [MainThread]:   Compilation Error in test valid_id_range_stg_stackoverflow__comments_comment_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:06.212880 [info ] [MainThread]: 
[0m17:35:06.213577 [error] [MainThread]:   Compilation Error in test valid_id_range_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:06.214245 [info ] [MainThread]: 
[0m17:35:06.214800 [error] [MainThread]:   Compilation Error in test valid_id_range_stg_stackoverflow__users_user_id (models/staging/schema.yml)
  'test_valid_id_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:35:06.215225 [info ] [MainThread]: 
[0m17:35:06.215652 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m17:35:06.217917 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.4906955, "process_in_blocks": "0", "process_kernel_time": 0.197615, "process_mem_max_rss": "142082048", "process_out_blocks": "0", "process_user_time": 0.937671}
[0m17:35:06.219325 [debug] [MainThread]: Command `dbt test` failed at 17:35:06.219142 after 0.49 seconds
[0m17:35:06.219895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11342fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11463b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11463aaf0>]}
[0m17:35:06.220621 [debug] [MainThread]: Flushing usage events
[0m17:35:07.051178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:05:00.812486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131dcfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131dcfed0>]}


============================== 09:05:00.815852 | a512f2bd-b995-470a-8903-9ed680ef17bc ==============================
[0m09:05:00.815852 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:05:00.816167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:05:00.876801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a512f2bd-b995-470a-8903-9ed680ef17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130769e00>]}
[0m09:05:00.888461 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:05:00.889228 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:05:00.892096 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46563646, "process_in_blocks": "0", "process_kernel_time": 0.220573, "process_mem_max_rss": "108691456", "process_out_blocks": "0", "process_user_time": 0.880069}
[0m09:05:00.896040 [debug] [MainThread]: Command `cli deps` succeeded at 09:05:00.895932 after 0.47 seconds
[0m09:05:00.896276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131bf9480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131bfa9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131e51350>]}
[0m09:05:00.896486 [debug] [MainThread]: Flushing usage events
[0m09:05:01.964269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:13:31.751775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cedd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a47c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a47ed0>]}


============================== 09:13:31.754711 | 1f725a10-b598-47cc-a35f-ad040340abfe ==============================
[0m09:13:31.754711 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:13:31.755016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation time_band_analysis', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:13:31.841944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f725a10-b598-47cc-a35f-ad040340abfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfe650>]}
[0m09:13:31.864623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f725a10-b598-47cc-a35f-ad040340abfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696f460>]}
[0m09:13:31.867417 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m09:13:31.914012 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:13:31.992950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:13:31.993176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:13:31.996341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
[0m09:13:32.019942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f725a10-b598-47cc-a35f-ad040340abfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af7050>]}
[0m09:13:32.057294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:13:32.058541 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:13:32.068001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f725a10-b598-47cc-a35f-ad040340abfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8fc50>]}
[0m09:13:32.068242 [info ] [MainThread]: Found 6 models, 15 data tests, 1 analysis, 7 sources, 431 macros
[0m09:13:32.068385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f725a10-b598-47cc-a35f-ad040340abfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fdcd70>]}
[0m09:13:32.068627 [debug] [MainThread]: Acquiring new duckdb connection 'macro_time_band_analysis'
[0m09:13:32.068763 [debug] [MainThread]: Using duckdb connection "macro_time_band_analysis"
[0m09:13:32.068869 [debug] [MainThread]: On macro_time_band_analysis: BEGIN
[0m09:13:32.068970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:13:32.074800 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m09:13:32.074990 [debug] [MainThread]: On macro_time_band_analysis: COMMIT
[0m09:13:32.075117 [debug] [MainThread]: Using duckdb connection "macro_time_band_analysis"
[0m09:13:32.075227 [debug] [MainThread]: On macro_time_band_analysis: COMMIT
[0m09:13:32.075426 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:13:32.075619 [debug] [MainThread]: On macro_time_band_analysis: Close
[0m09:13:32.075810 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "time_band_analysis" in any package
[0m09:13:32.076679 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1260, in execute_macro
    raise DbtRuntimeError(
    ...<3 lines>...
    )
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "time_band_analysis" in any package

[0m09:13:32.076874 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'time_band_analysis' in any package
[0m09:13:32.078182 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.35807025, "process_in_blocks": "0", "process_kernel_time": 0.175862, "process_mem_max_rss": "130072576", "process_out_blocks": "0", "process_user_time": 0.809796}
[0m09:13:32.078416 [debug] [MainThread]: Command `dbt run-operation` failed at 09:13:32.078371 after 0.36 seconds
[0m09:13:32.078560 [debug] [MainThread]: Connection 'macro_time_band_analysis' was properly closed.
[0m09:13:32.078696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f93040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700a690>]}
[0m09:13:32.078842 [debug] [MainThread]: Flushing usage events
[0m09:13:32.883615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:08.014621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105319d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103cfed0>]}


============================== 09:16:08.017518 | 138e48d9-89b1-4696-b24f-62ad4e406171 ==============================
[0m09:16:08.017518 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:16:08.017800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select time_band_stats', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:16:08.104962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '138e48d9-89b1-4696-b24f-62ad4e406171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110799f30>]}
[0m09:16:08.127832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '138e48d9-89b1-4696-b24f-62ad4e406171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fb240>]}
[0m09:16:08.130382 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m09:16:08.179508 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:16:08.256174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:16:08.256393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:16:08.259367 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
[0m09:16:08.280938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '138e48d9-89b1-4696-b24f-62ad4e406171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110483050>]}
[0m09:16:08.318034 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:16:08.319217 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:16:08.331722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '138e48d9-89b1-4696-b24f-62ad4e406171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111013e30>]}
[0m09:16:08.331976 [info ] [MainThread]: Found 7 models, 15 data tests, 1 analysis, 7 sources, 431 macros
[0m09:16:08.332118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '138e48d9-89b1-4696-b24f-62ad4e406171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111372970>]}
[0m09:16:08.332891 [info ] [MainThread]: 
[0m09:16:08.333041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:16:08.333148 [info ] [MainThread]: 
[0m09:16:08.333359 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:16:08.333727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:16:08.388273 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:16:08.388493 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:16:08.388633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:08.393096 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:16:08.393258 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m09:16:08.393625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:08.393777 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m09:16:08.393903 [info ] [MainThread]: 
[0m09:16:08.394042 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m09:16:08.394246 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/dev.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 11914) by user yuejwang. See also https://duckdb.org/docs/connect/concurrency
[0m09:16:08.396085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.41400638, "process_in_blocks": "0", "process_kernel_time": 0.219308, "process_mem_max_rss": "128712704", "process_out_blocks": "0", "process_user_time": 0.81281}
[0m09:16:08.396291 [debug] [MainThread]: Command `dbt run` failed at 09:16:08.396249 after 0.41 seconds
[0m09:16:08.396452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113aa0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ecf50>]}
[0m09:16:08.396599 [debug] [MainThread]: Flushing usage events
[0m09:16:09.284895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:58.535048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b75d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106cfed0>]}


============================== 09:27:58.537756 | 4d356c71-c527-4498-a274-498a707502cf ==============================
[0m09:27:58.537756 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:27:58.538051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:27:58.546207 [info ] [MainThread]: dbt version: 1.9.4
[0m09:27:58.546398 [info ] [MainThread]: python version: 3.13.3
[0m09:27:58.546518 [info ] [MainThread]: python path: /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/bin/python3.13
[0m09:27:58.546623 [info ] [MainThread]: os info: macOS-15.4.1-arm64-arm-64bit-Mach-O
[0m09:27:58.590689 [info ] [MainThread]: Using profiles dir at /Users/yuejwang/.dbt
[0m09:27:58.590907 [info ] [MainThread]: Using profiles.yml file at /Users/yuejwang/.dbt/profiles.yml
[0m09:27:58.591039 [info ] [MainThread]: Using dbt_project.yml file at /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/dbt_project.yml
[0m09:27:58.592838 [info ] [MainThread]: adapter type: duckdb
[0m09:27:58.592998 [info ] [MainThread]: adapter version: 1.9.3
[0m09:27:58.627806 [info ] [MainThread]: Configuration:
[0m09:27:58.628023 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:27:58.628147 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:27:58.628265 [info ] [MainThread]: Required dependencies:
[0m09:27:58.628504 [debug] [MainThread]: Executing "git --help"
[0m09:27:58.637238 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:27:58.637744 [debug] [MainThread]: STDERR: "b''"
[0m09:27:58.637919 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:27:58.638082 [info ] [MainThread]: Connection:
[0m09:27:58.638229 [info ] [MainThread]:   database: dev
[0m09:27:58.638349 [info ] [MainThread]:   schema: main
[0m09:27:58.638453 [info ] [MainThread]:   path: dev.duckdb
[0m09:27:58.638563 [info ] [MainThread]:   config_options: None
[0m09:27:58.638670 [info ] [MainThread]:   extensions: None
[0m09:27:58.638785 [info ] [MainThread]:   settings: {}
[0m09:27:58.638894 [info ] [MainThread]:   external_root: .
[0m09:27:58.638990 [info ] [MainThread]:   use_credential_provider: None
[0m09:27:58.639083 [info ] [MainThread]:   attach: None
[0m09:27:58.639186 [info ] [MainThread]:   filesystems: None
[0m09:27:58.639292 [info ] [MainThread]:   remote: None
[0m09:27:58.639390 [info ] [MainThread]:   plugins: None
[0m09:27:58.639498 [info ] [MainThread]:   disable_transactions: False
[0m09:27:58.639787 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m09:27:58.681660 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m09:27:58.729322 [debug] [MainThread]: Using duckdb connection "debug"
[0m09:27:58.729537 [debug] [MainThread]: On debug: select 1 as id
[0m09:27:58.729659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:27:58.735865 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m09:27:58.736337 [debug] [MainThread]: On debug: Close
[0m09:27:58.736502 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:27:58.736639 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:27:58.738474 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.23353522, "process_in_blocks": "0", "process_kernel_time": 0.178611, "process_mem_max_rss": "130138112", "process_out_blocks": "0", "process_user_time": 0.649659}
[0m09:27:58.738691 [debug] [MainThread]: Command `dbt debug` succeeded at 09:27:58.738647 after 0.23 seconds
[0m09:27:58.738831 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:27:58.738984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b55a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a9fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108316a0>]}
[0m09:27:58.739156 [debug] [MainThread]: Flushing usage events
[0m09:27:59.668182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:30:21.245307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f55d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cafc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cafed0>]}


============================== 09:30:21.247809 | d28c817f-d464-4a8a-846e-68fbf1830283 ==============================
[0m09:30:21.247809 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:30:21.248072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select time_band_stats', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:30:21.334243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd28c817f-d464-4a8a-846e-68fbf1830283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e79f30>]}
[0m09:30:21.357171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd28c817f-d464-4a8a-846e-68fbf1830283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd7240>]}
[0m09:30:21.359938 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m09:30:21.405905 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:30:21.481320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:30:21.481569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:30:21.484756 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
[0m09:30:21.507493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd28c817f-d464-4a8a-846e-68fbf1830283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d63050>]}
[0m09:30:21.543378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:30:21.544518 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:30:21.556281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd28c817f-d464-4a8a-846e-68fbf1830283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef7e30>]}
[0m09:30:21.556515 [info ] [MainThread]: Found 7 models, 15 data tests, 1 analysis, 7 sources, 431 macros
[0m09:30:21.556657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd28c817f-d464-4a8a-846e-68fbf1830283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524e970>]}
[0m09:30:21.557426 [info ] [MainThread]: 
[0m09:30:21.557570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:30:21.557678 [info ] [MainThread]: 
[0m09:30:21.557886 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:30:21.558249 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:30:21.608737 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:30:21.608979 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:30:21.609112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:21.615498 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m09:30:21.616157 [debug] [ThreadPool]: On list_dev: Close
[0m09:30:21.616463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:30:21.616666 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:30:21.619438 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:30:21.619585 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:30:21.619697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:21.620070 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:30:21.620636 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:30:21.620751 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:30:21.620923 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:30:21.621036 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:30:21.621152 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:30:21.621371 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:30:21.621703 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:30:21.621831 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:30:21.621939 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:30:21.622088 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:30:21.622194 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:30:21.624761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m09:30:21.627167 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:30:21.627350 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:30:21.627470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:21.627692 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:30:21.627805 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:30:21.627922 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:30:21.636980 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m09:30:21.637575 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:30:21.638456 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:30:21.638597 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:30:21.638823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_staging)
[0m09:30:21.639587 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:30:21.639746 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m09:30:21.639859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:21.640056 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:30:21.640163 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:30:21.640273 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m09:30:21.643011 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:30:21.643550 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m09:30:21.643787 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m09:30:21.643892 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m09:30:21.644347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd28c817f-d464-4a8a-846e-68fbf1830283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549e9c0>]}
[0m09:30:21.644540 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:21.644648 [debug] [MainThread]: On master: BEGIN
[0m09:30:21.644749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:30:21.644942 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:30:21.645080 [debug] [MainThread]: On master: COMMIT
[0m09:30:21.645191 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:21.645297 [debug] [MainThread]: On master: COMMIT
[0m09:30:21.645476 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:30:21.645592 [debug] [MainThread]: On master: Close
[0m09:30:21.647063 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:30:21.647402 [info ] [Thread-1 (]: 1 of 1 START sql view model main.time_band_stats ............................... [RUN]
[0m09:30:21.647608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.stackoverflow_analysis_aw.time_band_stats)
[0m09:30:21.647753 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.time_band_stats
[0m09:30:21.651419 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:30:21.651947 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.time_band_stats
[0m09:30:21.664649 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:30:21.665245 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:30:21.665410 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: BEGIN
[0m09:30:21.665540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:21.665869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:30:21.665995 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:30:21.666147 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */

  
  create view "dev"."main"."time_band_stats__dbt_tmp" as (
    -- analyses/time_band_analysis.sql
WITH raw_answer_times AS (
    SELECT 
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main_staging"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main_staging"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL  -- Only answered questions
),

-- Simple statistics
basic_stats AS (
    SELECT 
        COUNT(*) as total_answers,
        MIN(minutes_to_answer) as min_minutes,
        MAX(minutes_to_answer) as max_minutes,
        AVG(minutes_to_answer) as avg_minutes,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY minutes_to_answer) as p25,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY minutes_to_answer) as median,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY minutes_to_answer) as p75
    FROM raw_answer_times
)

SELECT 
    'Key Statistics' as category,
    'Total Answers: ' || total_answers || 
    ', Median: ' || ROUND(median, 0) || ' mins' ||
    ', Average: ' || ROUND(avg_minutes, 0) || ' mins' ||
    ', Range: ' || ROUND(p25, 0) || ' to ' || ROUND(p75, 0) || ' mins (middle 50%)' as insights
FROM basic_stats;
  );

[0m09:30:21.666583 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */

  
  create view "dev"."main"."time_band_stats__dbt_tmp" as (
    -- analyses/time_band_analysis.sql
WITH raw_answer_times AS (
    SELECT 
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main_staging"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main_staging"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL  -- Only answered questions
),

-- Simple statistics
basic_stats AS (
    SELECT 
        COUNT(*) as total_answers,
        MIN(minutes_to_answer) as min_minutes,
        MAX(minutes_to_answer) as max_minutes,
        AVG(minutes_to_answer) as avg_minutes,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY minutes_to_answer) as p25,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY minutes_to_answer) as median,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY minutes_to_answer) as p75
    FROM raw_answer_times
)

SELECT 
    'Key Statistics' as category,
    'Total Answers: ' || total_answers || 
    ', Median: ' || ROUND(median, 0) || ' mins' ||
    ', Average: ' || ROUND(avg_minutes, 0) || ' mins' ||
    ', Range: ' || ROUND(p25, 0) || ' to ' || ROUND(p75, 0) || ' mins (middle 50%)' as insights
FROM basic_stats;
  );

[0m09:30:21.666742 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:30:21.666921 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: ROLLBACK
[0m09:30:21.672292 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.time_band_stats'
[0m09:30:21.672488 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: Close
[0m09:30:21.674174 [debug] [Thread-1 (]: Runtime Error in model time_band_stats (models/analysis/time_band_stats.sql)
  Parser Error: syntax error at or near ";"
[0m09:30:21.675128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd28c817f-d464-4a8a-846e-68fbf1830283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cdfd0>]}
[0m09:30:21.675422 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.time_band_stats ...................... [[31mERROR[0m in 0.03s]
[0m09:30:21.675671 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:30:21.675894 [debug] [Thread-4 (]: Marking all children of 'model.stackoverflow_analysis_aw.time_band_stats' to be skipped because of status 'error'.  Reason: Runtime Error in model time_band_stats (models/analysis/time_band_stats.sql)
  Parser Error: syntax error at or near ";".
[0m09:30:21.676660 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:21.676809 [debug] [MainThread]: On master: BEGIN
[0m09:30:21.676921 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:30:21.677176 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:30:21.677284 [debug] [MainThread]: On master: COMMIT
[0m09:30:21.677386 [debug] [MainThread]: Using duckdb connection "master"
[0m09:30:21.677484 [debug] [MainThread]: On master: COMMIT
[0m09:30:21.677655 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:30:21.677790 [debug] [MainThread]: On master: Close
[0m09:30:21.677939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:30:21.678040 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.time_band_stats' was properly closed.
[0m09:30:21.678156 [info ] [MainThread]: 
[0m09:30:21.678278 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m09:30:21.678535 [debug] [MainThread]: Command end result
[0m09:30:21.689218 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:30:21.690215 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:30:21.692770 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m09:30:21.692918 [info ] [MainThread]: 
[0m09:30:21.693079 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:30:21.693203 [info ] [MainThread]: 
[0m09:30:21.693351 [error] [MainThread]:   Runtime Error in model time_band_stats (models/analysis/time_band_stats.sql)
  Parser Error: syntax error at or near ";"
[0m09:30:21.693458 [info ] [MainThread]: 
[0m09:30:21.693578 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:30:21.695099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.48022678, "process_in_blocks": "0", "process_kernel_time": 0.205669, "process_mem_max_rss": "140525568", "process_out_blocks": "0", "process_user_time": 0.867238}
[0m09:30:21.695321 [debug] [MainThread]: Command `dbt run` failed at 09:30:21.695278 after 0.48 seconds
[0m09:30:21.695496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530e620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105557750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105555950>]}
[0m09:30:21.695649 [debug] [MainThread]: Flushing usage events
[0m09:30:22.569076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:31:16.412396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cffc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cffed0>]}


============================== 09:31:16.415030 | b522df65-c420-4096-9b8f-0519a574bb28 ==============================
[0m09:31:16.415030 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:31:16.415300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select time_band_stats', 'send_anonymous_usage_stats': 'True'}
[0m09:31:16.500078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b522df65-c420-4096-9b8f-0519a574bb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec9f30>]}
[0m09:31:16.521083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b522df65-c420-4096-9b8f-0519a574bb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2b240>]}
[0m09:31:16.523209 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m09:31:16.566406 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:31:16.636096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:16.636329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:16.639383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
[0m09:31:16.663434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b522df65-c420-4096-9b8f-0519a574bb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db3050>]}
[0m09:31:16.701793 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:31:16.702741 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:31:16.714422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b522df65-c420-4096-9b8f-0519a574bb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f43e30>]}
[0m09:31:16.714652 [info ] [MainThread]: Found 7 models, 15 data tests, 1 analysis, 7 sources, 431 macros
[0m09:31:16.714795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b522df65-c420-4096-9b8f-0519a574bb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a6970>]}
[0m09:31:16.715563 [info ] [MainThread]: 
[0m09:31:16.715709 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:31:16.715818 [info ] [MainThread]: 
[0m09:31:16.716025 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:31:16.716377 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:31:16.767521 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:31:16.767739 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:31:16.767871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:16.774222 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m09:31:16.774840 [debug] [ThreadPool]: On list_dev: Close
[0m09:31:16.775143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:31:16.775325 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:31:16.778077 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:31:16.778229 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:31:16.778348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:16.778685 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:31:16.779230 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:31:16.779349 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:31:16.779544 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:31:16.779712 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:31:16.779838 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:31:16.780080 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:31:16.780547 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:31:16.780708 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:31:16.780832 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:31:16.781010 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:31:16.781126 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:31:16.783597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m09:31:16.786370 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:31:16.786629 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:31:16.786888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:16.787180 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:31:16.787331 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:31:16.787468 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:31:16.796470 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:31:16.797139 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:31:16.798043 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:31:16.798201 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:31:16.798465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_staging)
[0m09:31:16.799231 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:31:16.799374 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m09:31:16.799494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:16.799712 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:31:16.799827 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:31:16.799947 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m09:31:16.802913 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:31:16.803509 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m09:31:16.803760 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m09:31:16.803882 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m09:31:16.804341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b522df65-c420-4096-9b8f-0519a574bb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ee9c0>]}
[0m09:31:16.804539 [debug] [MainThread]: Using duckdb connection "master"
[0m09:31:16.804648 [debug] [MainThread]: On master: BEGIN
[0m09:31:16.804750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:31:16.804926 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:31:16.805028 [debug] [MainThread]: On master: COMMIT
[0m09:31:16.805131 [debug] [MainThread]: Using duckdb connection "master"
[0m09:31:16.805227 [debug] [MainThread]: On master: COMMIT
[0m09:31:16.805386 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:31:16.805537 [debug] [MainThread]: On master: Close
[0m09:31:16.807105 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:31:16.807337 [info ] [Thread-1 (]: 1 of 1 START sql view model main.time_band_stats ............................... [RUN]
[0m09:31:16.807530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.stackoverflow_analysis_aw.time_band_stats)
[0m09:31:16.807679 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.time_band_stats
[0m09:31:16.811015 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:31:16.811398 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.time_band_stats
[0m09:31:16.824350 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:31:16.824867 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:31:16.825015 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: BEGIN
[0m09:31:16.825139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:16.825404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:31:16.825525 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:31:16.825670 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */

  
  create view "dev"."main"."time_band_stats__dbt_tmp" as (
    -- analyses/time_band_analysis.sql
WITH raw_answer_times AS (
    SELECT 
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main_staging"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main_staging"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL  -- Only answered questions
),

-- Simple statistics
basic_stats AS (
    SELECT 
        COUNT(*) as total_answers,
        MIN(minutes_to_answer) as min_minutes,
        MAX(minutes_to_answer) as max_minutes,
        AVG(minutes_to_answer) as avg_minutes,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY minutes_to_answer) as p25,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY minutes_to_answer) as median,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY minutes_to_answer) as p75
    FROM raw_answer_times
)

SELECT 
    'Key Statistics' as category,
    'Total Answers: ' || total_answers || 
    ', Median: ' || ROUND(median, 0) || ' mins' ||
    ', Average: ' || ROUND(avg_minutes, 0) || ' mins' ||
    ', Range: ' || ROUND(p25, 0) || ' to ' || ROUND(p75, 0) || ' mins (middle 50%)' as insights
FROM basic_stats
  );

[0m09:31:21.424832 [debug] [Thread-1 (]: SQL status: OK in 4.599 seconds
[0m09:31:21.430204 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:31:21.430465 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */
alter view "dev"."main"."time_band_stats__dbt_tmp" rename to "time_band_stats"
[0m09:31:21.431027 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:31:21.437001 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: COMMIT
[0m09:31:21.437213 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:31:21.437385 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: COMMIT
[0m09:31:21.438543 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:31:21.440781 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:31:21.440965 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */
drop view if exists "dev"."main"."time_band_stats__dbt_backup" cascade
[0m09:31:21.441251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:31:21.442521 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: Close
[0m09:31:21.443900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b522df65-c420-4096-9b8f-0519a574bb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751dc10>]}
[0m09:31:21.444346 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.time_band_stats .......................... [[32mOK[0m in 4.64s]
[0m09:31:21.444671 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:31:21.445353 [debug] [MainThread]: Using duckdb connection "master"
[0m09:31:21.445509 [debug] [MainThread]: On master: BEGIN
[0m09:31:21.445643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:31:21.445899 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:31:21.446044 [debug] [MainThread]: On master: COMMIT
[0m09:31:21.446173 [debug] [MainThread]: Using duckdb connection "master"
[0m09:31:21.446296 [debug] [MainThread]: On master: COMMIT
[0m09:31:21.446524 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:31:21.446727 [debug] [MainThread]: On master: Close
[0m09:31:21.446934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:21.447072 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.time_band_stats' was properly closed.
[0m09:31:21.447221 [info ] [MainThread]: 
[0m09:31:21.447375 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m09:31:21.447687 [debug] [MainThread]: Command end result
[0m09:31:21.459979 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:31:21.461369 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:31:21.464231 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m09:31:21.464379 [info ] [MainThread]: 
[0m09:31:21.464548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:31:21.464672 [info ] [MainThread]: 
[0m09:31:21.464801 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:31:21.467994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.092071, "process_in_blocks": "0", "process_kernel_time": 0.266679, "process_mem_max_rss": "166936576", "process_out_blocks": "0", "process_user_time": 1.09042}
[0m09:31:21.468192 [debug] [MainThread]: Command `dbt run` succeeded at 09:31:21.468153 after 5.09 seconds
[0m09:31:21.468362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10735e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a6030>]}
[0m09:31:21.468517 [debug] [MainThread]: Flushing usage events
[0m09:31:22.274234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:26.990574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a75d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cfed0>]}


============================== 09:32:26.993372 | fadf5b3f-909c-412c-ae39-77b786faaf0e ==============================
[0m09:32:26.993372 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:32:26.993668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt show --select time_band_stats', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:32:27.078145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fadf5b3f-909c-412c-ae39-77b786faaf0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107899f30>]}
[0m09:32:27.098708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fadf5b3f-909c-412c-ae39-77b786faaf0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fb240>]}
[0m09:32:27.111815 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m09:32:27.158093 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:32:27.232553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:32:27.232772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:32:27.235718 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
[0m09:32:27.256254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fadf5b3f-909c-412c-ae39-77b786faaf0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a67250>]}
[0m09:32:27.291945 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:32:27.293019 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:32:27.294507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fadf5b3f-909c-412c-ae39-77b786faaf0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a13e30>]}
[0m09:32:27.294700 [info ] [MainThread]: Found 7 models, 15 data tests, 1 analysis, 7 sources, 431 macros
[0m09:32:27.294847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fadf5b3f-909c-412c-ae39-77b786faaf0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4d1d0>]}
[0m09:32:27.295546 [info ] [MainThread]: 
[0m09:32:27.295689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:32:27.295796 [info ] [MainThread]: 
[0m09:32:27.295992 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:32:27.297852 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m09:32:27.348861 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:32:27.349075 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:32:27.349199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:27.355564 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m09:32:27.355753 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:32:27.355882 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:32:27.364288 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:32:27.365021 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:32:27.365895 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:32:27.366045 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:32:27.366321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_staging)
[0m09:32:27.367219 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:32:27.367363 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m09:32:27.367474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:27.367672 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:32:27.367772 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:32:27.367880 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m09:32:27.370754 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:32:27.371339 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m09:32:27.371581 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m09:32:27.371696 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m09:32:27.372149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fadf5b3f-909c-412c-ae39-77b786faaf0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f041f0>]}
[0m09:32:27.373576 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:32:27.373747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.stackoverflow_analysis_aw.time_band_stats)
[0m09:32:27.373893 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.time_band_stats
[0m09:32:27.377082 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:32:27.377459 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.time_band_stats
[0m09:32:27.380519 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:32:27.380706 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */

  
  -- analyses/time_band_analysis.sql
WITH raw_answer_times AS (
    SELECT 
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main_staging"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main_staging"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL  -- Only answered questions
),

-- Simple statistics
basic_stats AS (
    SELECT 
        COUNT(*) as total_answers,
        MIN(minutes_to_answer) as min_minutes,
        MAX(minutes_to_answer) as max_minutes,
        AVG(minutes_to_answer) as avg_minutes,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY minutes_to_answer) as p25,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY minutes_to_answer) as median,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY minutes_to_answer) as p75
    FROM raw_answer_times
)

SELECT 
    'Key Statistics' as category,
    'Total Answers: ' || total_answers || 
    ', Median: ' || ROUND(median, 0) || ' mins' ||
    ', Average: ' || ROUND(avg_minutes, 0) || ' mins' ||
    ', Range: ' || ROUND(p25, 0) || ' to ' || ROUND(p75, 0) || ' mins (middle 50%)' as insights
FROM basic_stats
  
  limit 5

[0m09:32:27.380865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:34.891689 [debug] [Thread-1 (]: SQL status: OK in 127.511 seconds
[0m09:34:34.897924 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: Close
[0m09:34:34.898741 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:34:34.899709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:34.899857 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.time_band_stats' was properly closed.
[0m09:34:34.900224 [debug] [MainThread]: Command end result
[0m09:34:34.910437 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:34:34.912158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:34:34.915131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m09:34:34.915328 [info ] [MainThread]: Previewing node 'time_band_stats':
| category       | insights             |
| -------------- | -------------------- |
| Key Statistics | Total Answers: 11... |

[0m09:34:34.917172 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 127.95806, "process_in_blocks": "0", "process_kernel_time": 5.536965, "process_mem_max_rss": "3407462400", "process_out_blocks": "0", "process_user_time": 18.44132}
[0m09:34:34.917428 [debug] [MainThread]: Command `dbt show` succeeded at 09:34:34.917380 after 127.96 seconds
[0m09:34:34.917675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4e990>]}
[0m09:34:34.917865 [debug] [MainThread]: Flushing usage events
[0m09:34:35.797139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:43:00.482747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103959d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b3ed0>]}


============================== 09:43:00.484827 | ddb97568-9eb0-4c85-9b87-63846b780520 ==============================
[0m09:43:00.484827 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:43:00.485120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select time_band_stats', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:43:00.567588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddb97568-9eb0-4c85-9b87-63846b780520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487df30>]}
[0m09:43:00.588245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddb97568-9eb0-4c85-9b87-63846b780520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045df240>]}
[0m09:43:00.589900 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m09:43:00.635116 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:43:00.702049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:43:00.702297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:43:00.705543 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
[0m09:43:00.729195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddb97568-9eb0-4c85-9b87-63846b780520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476b050>]}
[0m09:43:00.768484 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:43:00.769491 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:43:00.779103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddb97568-9eb0-4c85-9b87-63846b780520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a17e30>]}
[0m09:43:00.779347 [info ] [MainThread]: Found 8 models, 15 data tests, 1 analysis, 7 sources, 431 macros
[0m09:43:00.779521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddb97568-9eb0-4c85-9b87-63846b780520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6e970>]}
[0m09:43:00.780345 [info ] [MainThread]: 
[0m09:43:00.780511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:43:00.780622 [info ] [MainThread]: 
[0m09:43:00.780824 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:43:00.781200 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:43:00.833174 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:43:00.833434 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:43:00.833581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:00.840341 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m09:43:00.841033 [debug] [ThreadPool]: On list_dev: Close
[0m09:43:00.841340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_analysis)
[0m09:43:00.841546 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_analysis"
"
[0m09:43:00.844529 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:43:00.844680 [debug] [ThreadPool]: On create_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_analysis"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:43:00.844803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:00.845188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:43:00.845760 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:43:00.845874 [debug] [ThreadPool]: On create_dev_main_analysis: BEGIN
[0m09:43:00.846048 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:43:00.846158 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:43:00.846275 [debug] [ThreadPool]: On create_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_analysis"} */

    
    
        create schema if not exists "dev"."main_analysis"
    
[0m09:43:00.846466 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:43:00.846798 [debug] [ThreadPool]: On create_dev_main_analysis: COMMIT
[0m09:43:00.846928 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:43:00.847043 [debug] [ThreadPool]: On create_dev_main_analysis: COMMIT
[0m09:43:00.847680 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:43:00.847794 [debug] [ThreadPool]: On create_dev_main_analysis: Close
[0m09:43:00.850312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_analysis, now list_dev_main)
[0m09:43:00.852798 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:43:00.852986 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:43:00.853449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:00.853720 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:43:00.853838 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:43:00.853956 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:43:00.863557 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m09:43:00.864319 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:43:00.864930 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:43:00.865073 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:43:00.865354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_analysis)
[0m09:43:00.866268 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m09:43:00.866429 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m09:43:00.866546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:00.866784 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:43:00.866895 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m09:43:00.867006 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m09:43:00.870071 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:43:00.870620 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m09:43:00.870886 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m09:43:00.871005 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m09:43:00.871227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_staging)
[0m09:43:00.871967 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:43:00.872129 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m09:43:00.872247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:00.872471 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:43:00.872588 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:43:00.872704 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m09:43:00.875803 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:43:00.876404 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m09:43:00.876649 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m09:43:00.876771 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m09:43:00.877263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddb97568-9eb0-4c85-9b87-63846b780520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbe9c0>]}
[0m09:43:00.877530 [debug] [MainThread]: Using duckdb connection "master"
[0m09:43:00.877676 [debug] [MainThread]: On master: BEGIN
[0m09:43:00.877792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:43:00.878065 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:43:00.878235 [debug] [MainThread]: On master: COMMIT
[0m09:43:00.878360 [debug] [MainThread]: Using duckdb connection "master"
[0m09:43:00.878472 [debug] [MainThread]: On master: COMMIT
[0m09:43:00.878661 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:43:00.878771 [debug] [MainThread]: On master: Close
[0m09:43:00.880354 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:43:00.880579 [info ] [Thread-1 (]: 1 of 1 START sql table model main_analysis.time_band_stats ..................... [RUN]
[0m09:43:00.880777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.stackoverflow_analysis_aw.time_band_stats)
[0m09:43:00.880934 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.time_band_stats
[0m09:43:00.884878 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:43:00.885247 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.time_band_stats
[0m09:43:00.898935 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:43:00.899512 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:43:00.899677 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: BEGIN
[0m09:43:00.899829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:00.900123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:43:00.900254 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:43:00.900459 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */

  
    
    

    create  table
      "dev"."main_analysis"."time_band_stats__dbt_tmp"
  
    as (
      -- models/analysis/time_band_stats.sql


WITH raw_answer_times AS (
    SELECT 
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer,
        q.created_at as question_date
    FROM "dev"."main_staging"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main_staging"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1
        AND a.created_at IS NOT NULL
        AND q.created_at >= DATEADD(year, -1, CURRENT_DATE)
),

stats AS (
    SELECT 
        COUNT(*) as total_answers,
        MIN(minutes_to_answer) as min_minutes,
        MAX(minutes_to_answer) as max_minutes,
        ROUND(AVG(minutes_to_answer), 2) as avg_minutes,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY minutes_to_answer) as p25,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY minutes_to_answer) as median,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY minutes_to_answer) as p75,
        MIN(question_date) as period_start,
        MAX(question_date) as period_end
    FROM raw_answer_times
)

SELECT 
    'Date Range' as metric, 
    'From ' || period_start || ' to ' || period_end as value
FROM stats
UNION ALL
SELECT 
    'Total Answers', 
    total_answers::VARCHAR 
FROM stats
UNION ALL
SELECT 
    'Minimum Time', 
    CASE 
        WHEN min_minutes < 60 THEN min_minutes::VARCHAR || ' minutes'
        WHEN min_minutes < 1440 THEN ROUND(min_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(min_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Maximum Time', 
    CASE 
        WHEN max_minutes < 60 THEN max_minutes::VARCHAR || ' minutes'
        WHEN max_minutes < 1440 THEN ROUND(max_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(max_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Average Time', 
    CASE 
        WHEN avg_minutes < 60 THEN ROUND(avg_minutes, 1)::VARCHAR || ' minutes'
        WHEN avg_minutes < 1440 THEN ROUND(avg_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(avg_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '25th Percentile', 
    CASE 
        WHEN p25 < 60 THEN ROUND(p25, 1)::VARCHAR || ' minutes'
        WHEN p25 < 1440 THEN ROUND(p25/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p25/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Median Time', 
    CASE 
        WHEN median < 60 THEN ROUND(median, 1)::VARCHAR || ' minutes'
        WHEN median < 1440 THEN ROUND(median/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(median/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '75th Percentile', 
    CASE 
        WHEN p75 < 60 THEN ROUND(p75, 1)::VARCHAR || ' minutes'
        WHEN p75 < 1440 THEN ROUND(p75/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p75/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
    );
  
  
[0m09:43:05.364210 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */

  
    
    

    create  table
      "dev"."main_analysis"."time_band_stats__dbt_tmp"
  
    as (
      -- models/analysis/time_band_stats.sql


WITH raw_answer_times AS (
    SELECT 
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer,
        q.created_at as question_date
    FROM "dev"."main_staging"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main_staging"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1
        AND a.created_at IS NOT NULL
        AND q.created_at >= DATEADD(year, -1, CURRENT_DATE)
),

stats AS (
    SELECT 
        COUNT(*) as total_answers,
        MIN(minutes_to_answer) as min_minutes,
        MAX(minutes_to_answer) as max_minutes,
        ROUND(AVG(minutes_to_answer), 2) as avg_minutes,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY minutes_to_answer) as p25,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY minutes_to_answer) as median,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY minutes_to_answer) as p75,
        MIN(question_date) as period_start,
        MAX(question_date) as period_end
    FROM raw_answer_times
)

SELECT 
    'Date Range' as metric, 
    'From ' || period_start || ' to ' || period_end as value
FROM stats
UNION ALL
SELECT 
    'Total Answers', 
    total_answers::VARCHAR 
FROM stats
UNION ALL
SELECT 
    'Minimum Time', 
    CASE 
        WHEN min_minutes < 60 THEN min_minutes::VARCHAR || ' minutes'
        WHEN min_minutes < 1440 THEN ROUND(min_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(min_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Maximum Time', 
    CASE 
        WHEN max_minutes < 60 THEN max_minutes::VARCHAR || ' minutes'
        WHEN max_minutes < 1440 THEN ROUND(max_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(max_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Average Time', 
    CASE 
        WHEN avg_minutes < 60 THEN ROUND(avg_minutes, 1)::VARCHAR || ' minutes'
        WHEN avg_minutes < 1440 THEN ROUND(avg_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(avg_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '25th Percentile', 
    CASE 
        WHEN p25 < 60 THEN ROUND(p25, 1)::VARCHAR || ' minutes'
        WHEN p25 < 1440 THEN ROUND(p25/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p25/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Median Time', 
    CASE 
        WHEN median < 60 THEN ROUND(median, 1)::VARCHAR || ' minutes'
        WHEN median < 1440 THEN ROUND(median/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(median/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '75th Percentile', 
    CASE 
        WHEN p75 < 60 THEN ROUND(p75, 1)::VARCHAR || ' minutes'
        WHEN p75 < 1440 THEN ROUND(p75/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p75/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
    );
  
  
[0m09:43:05.364747 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:43:05.365115 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: ROLLBACK
[0m09:43:05.372515 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.time_band_stats'
[0m09:43:05.372775 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: Close
[0m09:43:05.375171 [debug] [Thread-1 (]: Runtime Error in model time_band_stats (models/analysis/time_band_stats.sql)
  Catalog Error: Scalar Function with name dateadd does not exist!
  Did you mean "date_add"?
  
  LINE 23:         AND q.created_at >= DATEADD(year, -1, CURRENT_DATE)
                                       ^
[0m09:43:05.376454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb97568-9eb0-4c85-9b87-63846b780520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff2090>]}
[0m09:43:05.376826 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_analysis.time_band_stats ............ [[31mERROR[0m in 4.49s]
[0m09:43:05.377130 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:43:05.377454 [debug] [Thread-4 (]: Marking all children of 'model.stackoverflow_analysis_aw.time_band_stats' to be skipped because of status 'error'.  Reason: Runtime Error in model time_band_stats (models/analysis/time_band_stats.sql)
  Catalog Error: Scalar Function with name dateadd does not exist!
  Did you mean "date_add"?
  
  LINE 23:         AND q.created_at >= DATEADD(year, -1, CURRENT_DATE)
                                       ^.
[0m09:43:05.378480 [debug] [MainThread]: Using duckdb connection "master"
[0m09:43:05.378689 [debug] [MainThread]: On master: BEGIN
[0m09:43:05.378838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:43:05.379161 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:43:05.379326 [debug] [MainThread]: On master: COMMIT
[0m09:43:05.379464 [debug] [MainThread]: Using duckdb connection "master"
[0m09:43:05.379593 [debug] [MainThread]: On master: COMMIT
[0m09:43:05.379807 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:43:05.379942 [debug] [MainThread]: On master: Close
[0m09:43:05.380127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:05.380260 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.time_band_stats' was properly closed.
[0m09:43:05.380400 [info ] [MainThread]: 
[0m09:43:05.380554 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m09:43:05.380882 [debug] [MainThread]: Command end result
[0m09:43:05.392882 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:43:05.394059 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:43:05.396798 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m09:43:05.396941 [info ] [MainThread]: 
[0m09:43:05.397102 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:43:05.397231 [info ] [MainThread]: 
[0m09:43:05.397382 [error] [MainThread]:   Runtime Error in model time_band_stats (models/analysis/time_band_stats.sql)
  Catalog Error: Scalar Function with name dateadd does not exist!
  Did you mean "date_add"?
  
  LINE 23:         AND q.created_at >= DATEADD(year, -1, CURRENT_DATE)
                                       ^
[0m09:43:05.397503 [info ] [MainThread]: 
[0m09:43:05.397632 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:43:05.399081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.9534574, "process_in_blocks": "0", "process_kernel_time": 0.227666, "process_mem_max_rss": "172228608", "process_out_blocks": "0", "process_user_time": 1.082072}
[0m09:43:05.399340 [debug] [MainThread]: Command `dbt run` failed at 09:43:05.399293 after 4.95 seconds
[0m09:43:05.399536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e26570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b2b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b2cb0>]}
[0m09:43:05.399699 [debug] [MainThread]: Flushing usage events
[0m09:43:06.727304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:02.593048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121275d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225cfed0>]}


============================== 09:45:02.595779 | b09a4aa6-8fba-438f-859a-7aa3076b2c23 ==============================
[0m09:45:02.595779 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:45:02.596085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select time_band_stats', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:45:02.680348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b09a4aa6-8fba-438f-859a-7aa3076b2c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122799f30>]}
[0m09:45:02.701735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b09a4aa6-8fba-438f-859a-7aa3076b2c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223f7240>]}
[0m09:45:02.705215 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m09:45:02.755854 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:45:02.825282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:45:02.825503 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:45:02.828725 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
[0m09:45:02.851572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b09a4aa6-8fba-438f-859a-7aa3076b2c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122683050>]}
[0m09:45:02.888459 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:45:02.889945 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:45:02.901687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b09a4aa6-8fba-438f-859a-7aa3076b2c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122813e30>]}
[0m09:45:02.901918 [info ] [MainThread]: Found 8 models, 15 data tests, 1 analysis, 7 sources, 431 macros
[0m09:45:02.902058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09a4aa6-8fba-438f-859a-7aa3076b2c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c6e970>]}
[0m09:45:02.902808 [info ] [MainThread]: 
[0m09:45:02.902954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:45:02.903058 [info ] [MainThread]: 
[0m09:45:02.903263 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:45:02.903632 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:45:02.955000 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:45:02.955225 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:45:02.955352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:45:02.962069 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m09:45:02.962663 [debug] [ThreadPool]: On list_dev: Close
[0m09:45:02.962951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_analysis)
[0m09:45:02.963135 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_analysis"
"
[0m09:45:02.965980 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:45:02.966128 [debug] [ThreadPool]: On create_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_analysis"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:45:02.966236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:45:02.966628 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:45:02.967146 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:45:02.967335 [debug] [ThreadPool]: On create_dev_main_analysis: BEGIN
[0m09:45:02.967786 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:45:02.967925 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:45:02.968045 [debug] [ThreadPool]: On create_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_analysis"} */

    
    
        create schema if not exists "dev"."main_analysis"
    
[0m09:45:02.968277 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:45:02.969043 [debug] [ThreadPool]: On create_dev_main_analysis: COMMIT
[0m09:45:02.969197 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:45:02.969305 [debug] [ThreadPool]: On create_dev_main_analysis: COMMIT
[0m09:45:02.969604 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:45:02.969760 [debug] [ThreadPool]: On create_dev_main_analysis: Close
[0m09:45:02.972517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_analysis, now list_dev_main)
[0m09:45:02.975209 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:45:02.975404 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:45:02.975858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:45:02.976218 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:45:02.976334 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:45:02.976445 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:45:02.984662 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:45:02.985386 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:45:02.986404 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:45:02.986575 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:45:02.986855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_staging)
[0m09:45:02.987719 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:45:02.987846 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m09:45:02.987950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:45:02.988204 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:45:02.988305 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:45:02.988411 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m09:45:02.991889 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:45:02.992760 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m09:45:02.993093 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m09:45:02.993216 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m09:45:02.993465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_analysis)
[0m09:45:02.994465 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m09:45:02.994589 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m09:45:02.994686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:45:02.994924 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:45:02.995027 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m09:45:02.995140 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m09:45:02.998487 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:45:02.999069 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m09:45:02.999329 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m09:45:02.999450 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m09:45:02.999723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09a4aa6-8fba-438f-859a-7aa3076b2c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ebe9c0>]}
[0m09:45:02.999954 [debug] [MainThread]: Using duckdb connection "master"
[0m09:45:03.000078 [debug] [MainThread]: On master: BEGIN
[0m09:45:03.000197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:45:03.000409 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:45:03.000529 [debug] [MainThread]: On master: COMMIT
[0m09:45:03.000643 [debug] [MainThread]: Using duckdb connection "master"
[0m09:45:03.000750 [debug] [MainThread]: On master: COMMIT
[0m09:45:03.000907 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:45:03.001011 [debug] [MainThread]: On master: Close
[0m09:45:03.002643 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:45:03.002888 [info ] [Thread-1 (]: 1 of 1 START sql table model main_analysis.time_band_stats ..................... [RUN]
[0m09:45:03.003088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now model.stackoverflow_analysis_aw.time_band_stats)
[0m09:45:03.003223 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.time_band_stats
[0m09:45:03.006911 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:45:03.007323 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.time_band_stats
[0m09:45:03.020762 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:45:03.021337 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:45:03.021509 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: BEGIN
[0m09:45:03.021643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:45:03.021928 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:45:03.022066 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:45:03.022253 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */

  
    
    

    create  table
      "dev"."main_analysis"."time_band_stats__dbt_tmp"
  
    as (
      -- models/analysis/time_band_stats.sql


WITH raw_answer_times AS (
    SELECT 
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer,
        q.created_at as question_date
    FROM "dev"."main_staging"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main_staging"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1
        AND a.created_at IS NOT NULL
        AND q.created_at >= DATE_ADD(CURRENT_DATE, INTERVAL -1 YEAR)  -- Fixed this line
),

stats AS (
    SELECT 
        COUNT(*) as total_answers,
        MIN(minutes_to_answer) as min_minutes,
        MAX(minutes_to_answer) as max_minutes,
        ROUND(AVG(minutes_to_answer), 2) as avg_minutes,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY minutes_to_answer) as p25,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY minutes_to_answer) as median,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY minutes_to_answer) as p75,
        MIN(question_date) as period_start,
        MAX(question_date) as period_end
    FROM raw_answer_times
)

SELECT 
    'Date Range' as metric, 
    'From ' || period_start || ' to ' || period_end as value
FROM stats
UNION ALL
SELECT 
    'Total Answers', 
    total_answers::VARCHAR 
FROM stats
UNION ALL
SELECT 
    'Minimum Time', 
    CASE 
        WHEN min_minutes < 60 THEN min_minutes::VARCHAR || ' minutes'
        WHEN min_minutes < 1440 THEN ROUND(min_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(min_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Maximum Time', 
    CASE 
        WHEN max_minutes < 60 THEN max_minutes::VARCHAR || ' minutes'
        WHEN max_minutes < 1440 THEN ROUND(max_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(max_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Average Time', 
    CASE 
        WHEN avg_minutes < 60 THEN ROUND(avg_minutes, 1)::VARCHAR || ' minutes'
        WHEN avg_minutes < 1440 THEN ROUND(avg_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(avg_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '25th Percentile', 
    CASE 
        WHEN p25 < 60 THEN ROUND(p25, 1)::VARCHAR || ' minutes'
        WHEN p25 < 1440 THEN ROUND(p25/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p25/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Median Time', 
    CASE 
        WHEN median < 60 THEN ROUND(median, 1)::VARCHAR || ' minutes'
        WHEN median < 1440 THEN ROUND(median/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(median/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '75th Percentile', 
    CASE 
        WHEN p75 < 60 THEN ROUND(p75, 1)::VARCHAR || ' minutes'
        WHEN p75 < 1440 THEN ROUND(p75/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p75/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
    );
  
  
[0m09:45:03.022692 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */

  
    
    

    create  table
      "dev"."main_analysis"."time_band_stats__dbt_tmp"
  
    as (
      -- models/analysis/time_band_stats.sql


WITH raw_answer_times AS (
    SELECT 
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer,
        q.created_at as question_date
    FROM "dev"."main_staging"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main_staging"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1
        AND a.created_at IS NOT NULL
        AND q.created_at >= DATE_ADD(CURRENT_DATE, INTERVAL -1 YEAR)  -- Fixed this line
),

stats AS (
    SELECT 
        COUNT(*) as total_answers,
        MIN(minutes_to_answer) as min_minutes,
        MAX(minutes_to_answer) as max_minutes,
        ROUND(AVG(minutes_to_answer), 2) as avg_minutes,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY minutes_to_answer) as p25,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY minutes_to_answer) as median,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY minutes_to_answer) as p75,
        MIN(question_date) as period_start,
        MAX(question_date) as period_end
    FROM raw_answer_times
)

SELECT 
    'Date Range' as metric, 
    'From ' || period_start || ' to ' || period_end as value
FROM stats
UNION ALL
SELECT 
    'Total Answers', 
    total_answers::VARCHAR 
FROM stats
UNION ALL
SELECT 
    'Minimum Time', 
    CASE 
        WHEN min_minutes < 60 THEN min_minutes::VARCHAR || ' minutes'
        WHEN min_minutes < 1440 THEN ROUND(min_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(min_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Maximum Time', 
    CASE 
        WHEN max_minutes < 60 THEN max_minutes::VARCHAR || ' minutes'
        WHEN max_minutes < 1440 THEN ROUND(max_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(max_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Average Time', 
    CASE 
        WHEN avg_minutes < 60 THEN ROUND(avg_minutes, 1)::VARCHAR || ' minutes'
        WHEN avg_minutes < 1440 THEN ROUND(avg_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(avg_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '25th Percentile', 
    CASE 
        WHEN p25 < 60 THEN ROUND(p25, 1)::VARCHAR || ' minutes'
        WHEN p25 < 1440 THEN ROUND(p25/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p25/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Median Time', 
    CASE 
        WHEN median < 60 THEN ROUND(median, 1)::VARCHAR || ' minutes'
        WHEN median < 1440 THEN ROUND(median/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(median/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '75th Percentile', 
    CASE 
        WHEN p75 < 60 THEN ROUND(p75, 1)::VARCHAR || ' minutes'
        WHEN p75 < 1440 THEN ROUND(p75/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p75/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
    );
  
  
[0m09:45:03.022886 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m09:45:03.023069 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: ROLLBACK
[0m09:45:03.027888 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.time_band_stats'
[0m09:45:03.028035 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: Close
[0m09:45:03.029696 [debug] [Thread-1 (]: Runtime Error in model time_band_stats (models/analysis/time_band_stats.sql)
  Parser Error: syntax error at or near "YEAR"
[0m09:45:03.030628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09a4aa6-8fba-438f-859a-7aa3076b2c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122eee090>]}
[0m09:45:03.030916 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_analysis.time_band_stats ............ [[31mERROR[0m in 0.03s]
[0m09:45:03.031152 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:45:03.031387 [debug] [Thread-4 (]: Marking all children of 'model.stackoverflow_analysis_aw.time_band_stats' to be skipped because of status 'error'.  Reason: Runtime Error in model time_band_stats (models/analysis/time_band_stats.sql)
  Parser Error: syntax error at or near "YEAR".
[0m09:45:03.032176 [debug] [MainThread]: Using duckdb connection "master"
[0m09:45:03.032318 [debug] [MainThread]: On master: BEGIN
[0m09:45:03.032431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:45:03.032664 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:45:03.032770 [debug] [MainThread]: On master: COMMIT
[0m09:45:03.032873 [debug] [MainThread]: Using duckdb connection "master"
[0m09:45:03.032969 [debug] [MainThread]: On master: COMMIT
[0m09:45:03.033136 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:45:03.033263 [debug] [MainThread]: On master: Close
[0m09:45:03.033408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:03.033510 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.time_band_stats' was properly closed.
[0m09:45:03.033624 [info ] [MainThread]: 
[0m09:45:03.033743 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m09:45:03.034001 [debug] [MainThread]: Command end result
[0m09:45:03.044488 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:45:03.045449 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:45:03.048072 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m09:45:03.048213 [info ] [MainThread]: 
[0m09:45:03.048372 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:45:03.048488 [info ] [MainThread]: 
[0m09:45:03.048631 [error] [MainThread]:   Runtime Error in model time_band_stats (models/analysis/time_band_stats.sql)
  Parser Error: syntax error at or near "YEAR"
[0m09:45:03.048736 [info ] [MainThread]: 
[0m09:45:03.048857 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:45:03.050401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.48764426, "process_in_blocks": "0", "process_kernel_time": 0.205779, "process_mem_max_rss": "142721024", "process_out_blocks": "0", "process_user_time": 0.883525}
[0m09:45:03.050604 [debug] [MainThread]: Command `dbt run` failed at 09:45:03.050566 after 0.49 seconds
[0m09:45:03.050771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d16780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240aeb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240aecb0>]}
[0m09:45:03.050914 [debug] [MainThread]: Flushing usage events
[0m09:45:03.926678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:44.114386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104775d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cfed0>]}


============================== 09:46:44.116366 | 61c770ff-d524-4591-b89b-035ecf02298d ==============================
[0m09:46:44.116366 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:46:44.116644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select time_band_stats', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:46:44.214766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61c770ff-d524-4591-b89b-035ecf02298d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108999f30>]}
[0m09:46:44.235514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61c770ff-d524-4591-b89b-035ecf02298d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fb240>]}
[0m09:46:44.237100 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m09:46:44.280668 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:46:44.346259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:46:44.346518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:46:44.350033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
[0m09:46:44.374203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61c770ff-d524-4591-b89b-035ecf02298d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108783050>]}
[0m09:46:44.415373 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:46:44.416432 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:46:44.426174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61c770ff-d524-4591-b89b-035ecf02298d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a13e30>]}
[0m09:46:44.426433 [info ] [MainThread]: Found 8 models, 15 data tests, 1 analysis, 7 sources, 431 macros
[0m09:46:44.426577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61c770ff-d524-4591-b89b-035ecf02298d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e62970>]}
[0m09:46:44.427346 [info ] [MainThread]: 
[0m09:46:44.427491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:46:44.427599 [info ] [MainThread]: 
[0m09:46:44.427806 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:46:44.428150 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:46:44.480459 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:46:44.480711 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:46:44.480852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:44.487694 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m09:46:44.488412 [debug] [ThreadPool]: On list_dev: Close
[0m09:46:44.488771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_analysis)
[0m09:46:44.488993 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_analysis"
"
[0m09:46:44.492022 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:46:44.492176 [debug] [ThreadPool]: On create_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_analysis"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:46:44.492298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:44.492748 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:44.493321 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:46:44.493436 [debug] [ThreadPool]: On create_dev_main_analysis: BEGIN
[0m09:46:44.493619 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:44.493717 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:46:44.493832 [debug] [ThreadPool]: On create_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_analysis"} */

    
    
        create schema if not exists "dev"."main_analysis"
    
[0m09:46:44.494032 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:44.494371 [debug] [ThreadPool]: On create_dev_main_analysis: COMMIT
[0m09:46:44.494483 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_analysis"
[0m09:46:44.494589 [debug] [ThreadPool]: On create_dev_main_analysis: COMMIT
[0m09:46:44.494745 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:44.494857 [debug] [ThreadPool]: On create_dev_main_analysis: Close
[0m09:46:44.497687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_analysis, now list_dev_main_analysis)
[0m09:46:44.500583 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m09:46:44.500759 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m09:46:44.501291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:44.501637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:44.501771 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m09:46:44.501901 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m09:46:44.510778 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m09:46:44.511439 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m09:46:44.512112 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m09:46:44.512285 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m09:46:44.512562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main)
[0m09:46:44.513335 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:46:44.513475 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:46:44.513585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:44.513824 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:44.513937 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:46:44.514049 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:46:44.517079 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:46:44.517685 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:46:44.517941 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:46:44.518053 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:46:44.518269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_staging)
[0m09:46:44.519087 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:46:44.519234 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m09:46:44.519346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:44.519587 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:46:44.519695 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:46:44.519811 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m09:46:44.523137 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:46:44.523790 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m09:46:44.524047 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m09:46:44.524170 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m09:46:44.524655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61c770ff-d524-4591-b89b-035ecf02298d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090beb60>]}
[0m09:46:44.524891 [debug] [MainThread]: Using duckdb connection "master"
[0m09:46:44.525012 [debug] [MainThread]: On master: BEGIN
[0m09:46:44.525132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:44.525352 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:46:44.525466 [debug] [MainThread]: On master: COMMIT
[0m09:46:44.525580 [debug] [MainThread]: Using duckdb connection "master"
[0m09:46:44.525703 [debug] [MainThread]: On master: COMMIT
[0m09:46:44.525857 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:46:44.525964 [debug] [MainThread]: On master: Close
[0m09:46:44.527152 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:46:44.527379 [info ] [Thread-1 (]: 1 of 1 START sql table model main_analysis.time_band_stats ..................... [RUN]
[0m09:46:44.527584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.stackoverflow_analysis_aw.time_band_stats)
[0m09:46:44.527729 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.time_band_stats
[0m09:46:44.531771 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:46:44.532215 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.time_band_stats
[0m09:46:44.547287 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:46:44.547888 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:46:44.548072 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: BEGIN
[0m09:46:44.548214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:44.548522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:46:44.548656 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:46:44.548868 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */

  
    
    

    create  table
      "dev"."main_analysis"."time_band_stats__dbt_tmp"
  
    as (
      

WITH raw_answer_times AS (
    SELECT 
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer,
        q.created_at as question_date
    FROM "dev"."main_staging"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main_staging"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1
        AND a.created_at IS NOT NULL
        -- Get last year's data using interval
        AND q.created_at >= (CURRENT_DATE - INTERVAL '1 year')
),

stats AS (
    SELECT 
        COUNT(*) as total_answers,
        MIN(minutes_to_answer) as min_minutes,
        MAX(minutes_to_answer) as max_minutes,
        ROUND(AVG(minutes_to_answer), 2) as avg_minutes,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY minutes_to_answer) as p25,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY minutes_to_answer) as median,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY minutes_to_answer) as p75,
        MIN(question_date) as period_start,
        MAX(question_date) as period_end
    FROM raw_answer_times
)

SELECT 
    'Date Range' as metric, 
    'From ' || period_start || ' to ' || period_end as value
FROM stats
UNION ALL
SELECT 
    'Total Answers', 
    total_answers::VARCHAR 
FROM stats
UNION ALL
SELECT 
    'Minimum Time', 
    CASE 
        WHEN min_minutes < 60 THEN min_minutes::VARCHAR || ' minutes'
        WHEN min_minutes < 1440 THEN ROUND(min_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(min_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Maximum Time', 
    CASE 
        WHEN max_minutes < 60 THEN max_minutes::VARCHAR || ' minutes'
        WHEN max_minutes < 1440 THEN ROUND(max_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(max_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Average Time', 
    CASE 
        WHEN avg_minutes < 60 THEN ROUND(avg_minutes, 1)::VARCHAR || ' minutes'
        WHEN avg_minutes < 1440 THEN ROUND(avg_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(avg_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '25th Percentile', 
    CASE 
        WHEN p25 < 60 THEN ROUND(p25, 1)::VARCHAR || ' minutes'
        WHEN p25 < 1440 THEN ROUND(p25/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p25/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Median Time', 
    CASE 
        WHEN median < 60 THEN ROUND(median, 1)::VARCHAR || ' minutes'
        WHEN median < 1440 THEN ROUND(median/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(median/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '75th Percentile', 
    CASE 
        WHEN p75 < 60 THEN ROUND(p75, 1)::VARCHAR || ' minutes'
        WHEN p75 < 1440 THEN ROUND(p75/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p75/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
    );
  
  
[0m09:47:49.051321 [debug] [Thread-1 (]: SQL status: OK in 64.502 seconds
[0m09:47:49.056593 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:47:49.056777 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */
alter table "dev"."main_analysis"."time_band_stats__dbt_tmp" rename to "time_band_stats"
[0m09:47:49.057372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:47:49.062282 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: COMMIT
[0m09:47:49.062435 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:47:49.062549 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: COMMIT
[0m09:47:49.064328 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:47:49.066164 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:47:49.066303 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */
drop table if exists "dev"."main_analysis"."time_band_stats__dbt_backup" cascade
[0m09:47:49.066536 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:47:49.067723 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: Close
[0m09:47:49.069420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61c770ff-d524-4591-b89b-035ecf02298d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090edd90>]}
[0m09:47:49.069864 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_analysis.time_band_stats ................ [[32mOK[0m in 64.54s]
[0m09:47:49.070134 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:47:49.071025 [debug] [MainThread]: Using duckdb connection "master"
[0m09:47:49.071186 [debug] [MainThread]: On master: BEGIN
[0m09:47:49.071293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:47:49.071506 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:47:49.071610 [debug] [MainThread]: On master: COMMIT
[0m09:47:49.071709 [debug] [MainThread]: Using duckdb connection "master"
[0m09:47:49.071805 [debug] [MainThread]: On master: COMMIT
[0m09:47:49.071957 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:47:49.072057 [debug] [MainThread]: On master: Close
[0m09:47:49.072205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:49.072306 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.time_band_stats' was properly closed.
[0m09:47:49.072430 [info ] [MainThread]: 
[0m09:47:49.072551 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 4.64 seconds (64.64s).
[0m09:47:49.072812 [debug] [MainThread]: Command end result
[0m09:47:49.090377 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:47:49.094091 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:47:49.102921 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m09:47:49.103118 [info ] [MainThread]: 
[0m09:47:49.103323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:47:49.103447 [info ] [MainThread]: 
[0m09:47:49.103592 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:47:49.106497 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 65.0226, "process_in_blocks": "0", "process_kernel_time": 2.947284, "process_mem_max_rss": "2683518976", "process_out_blocks": "0", "process_user_time": 7.344127}
[0m09:47:49.107450 [debug] [MainThread]: Command `dbt run` succeeded at 09:47:49.107300 after 65.02 seconds
[0m09:47:49.108112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f26620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092aead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092aecb0>]}
[0m09:47:49.108595 [debug] [MainThread]: Flushing usage events
[0m09:47:50.003647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:23.107656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108109d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e63c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e63ed0>]}


============================== 09:50:23.110265 | ec3f8a59-f0d6-487a-8bf3-2bec73e5170c ==============================
[0m09:50:23.110265 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:50:23.110538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt show --select time_band_stats', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:23.198848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec3f8a59-f0d6-487a-8bf3-2bec73e5170c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902df30>]}
[0m09:50:23.220788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec3f8a59-f0d6-487a-8bf3-2bec73e5170c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d87240>]}
[0m09:50:23.235819 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m09:50:23.282440 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:50:23.359489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:50:23.359749 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:50:23.362794 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stackoverflow_analysis_aw.marts
[0m09:50:23.385153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec3f8a59-f0d6-487a-8bf3-2bec73e5170c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fb250>]}
[0m09:50:23.425793 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:50:23.426780 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:50:23.428669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec3f8a59-f0d6-487a-8bf3-2bec73e5170c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090abe30>]}
[0m09:50:23.428887 [info ] [MainThread]: Found 8 models, 15 data tests, 1 analysis, 7 sources, 431 macros
[0m09:50:23.429030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec3f8a59-f0d6-487a-8bf3-2bec73e5170c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093dd1d0>]}
[0m09:50:23.429771 [info ] [MainThread]: 
[0m09:50:23.429911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:50:23.430026 [info ] [MainThread]: 
[0m09:50:23.430228 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:50:23.432159 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_analysis'
[0m09:50:23.489384 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m09:50:23.489604 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m09:50:23.489728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:23.495694 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m09:50:23.495885 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m09:50:23.496016 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m09:50:23.504126 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:50:23.504796 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m09:50:23.505584 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m09:50:23.505741 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m09:50:23.506003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_staging)
[0m09:50:23.506854 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:50:23.506977 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m09:50:23.507082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:23.507298 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:50:23.507397 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m09:50:23.507502 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'dev'
  
[0m09:50:23.510367 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:50:23.510901 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m09:50:23.511151 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m09:50:23.511261 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m09:50:23.511474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main)
[0m09:50:23.512382 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:50:23.512535 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:50:23.512647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:23.512852 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:50:23.512967 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:50:23.513076 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:50:23.516033 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:50:23.516609 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:50:23.516860 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:50:23.516973 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:50:23.517341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec3f8a59-f0d6-487a-8bf3-2bec73e5170c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d8d50>]}
[0m09:50:23.518927 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:50:23.519126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.stackoverflow_analysis_aw.time_band_stats)
[0m09:50:23.519278 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.time_band_stats
[0m09:50:23.523331 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:50:23.523741 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.time_band_stats
[0m09:50:23.526454 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.time_band_stats"
[0m09:50:23.526669 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.time_band_stats"} */

  
  

WITH raw_answer_times AS (
    SELECT 
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer,
        q.created_at as question_date
    FROM "dev"."main_staging"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main_staging"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1
        AND a.created_at IS NOT NULL
        -- Get last year's data using interval
        AND q.created_at >= (CURRENT_DATE - INTERVAL '1 year')
),

stats AS (
    SELECT 
        COUNT(*) as total_answers,
        MIN(minutes_to_answer) as min_minutes,
        MAX(minutes_to_answer) as max_minutes,
        ROUND(AVG(minutes_to_answer), 2) as avg_minutes,
        PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY minutes_to_answer) as p25,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY minutes_to_answer) as median,
        PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY minutes_to_answer) as p75,
        MIN(question_date) as period_start,
        MAX(question_date) as period_end
    FROM raw_answer_times
)

SELECT 
    'Date Range' as metric, 
    'From ' || period_start || ' to ' || period_end as value
FROM stats
UNION ALL
SELECT 
    'Total Answers', 
    total_answers::VARCHAR 
FROM stats
UNION ALL
SELECT 
    'Minimum Time', 
    CASE 
        WHEN min_minutes < 60 THEN min_minutes::VARCHAR || ' minutes'
        WHEN min_minutes < 1440 THEN ROUND(min_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(min_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Maximum Time', 
    CASE 
        WHEN max_minutes < 60 THEN max_minutes::VARCHAR || ' minutes'
        WHEN max_minutes < 1440 THEN ROUND(max_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(max_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Average Time', 
    CASE 
        WHEN avg_minutes < 60 THEN ROUND(avg_minutes, 1)::VARCHAR || ' minutes'
        WHEN avg_minutes < 1440 THEN ROUND(avg_minutes/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(avg_minutes/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '25th Percentile', 
    CASE 
        WHEN p25 < 60 THEN ROUND(p25, 1)::VARCHAR || ' minutes'
        WHEN p25 < 1440 THEN ROUND(p25/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p25/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    'Median Time', 
    CASE 
        WHEN median < 60 THEN ROUND(median, 1)::VARCHAR || ' minutes'
        WHEN median < 1440 THEN ROUND(median/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(median/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
UNION ALL
SELECT 
    '75th Percentile', 
    CASE 
        WHEN p75 < 60 THEN ROUND(p75, 1)::VARCHAR || ' minutes'
        WHEN p75 < 1440 THEN ROUND(p75/60.0, 1)::VARCHAR || ' hours'
        ELSE ROUND(p75/1440.0, 1)::VARCHAR || ' days'
    END
FROM stats
  
  limit 5

[0m09:50:23.526860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:33.107290 [debug] [Thread-1 (]: SQL status: OK in 69.580 seconds
[0m09:51:33.110455 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.time_band_stats: Close
[0m09:51:33.111303 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.time_band_stats
[0m09:51:33.112420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:33.112551 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.time_band_stats' was properly closed.
[0m09:51:33.112928 [debug] [MainThread]: Command end result
[0m09:51:33.124800 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m09:51:33.126931 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m09:51:33.130182 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m09:51:33.130378 [info ] [MainThread]: Previewing node 'time_band_stats':
| metric        | value |
| ------------- | ----- |
| Date Range    |       |
| Total Answers | 0     |
| Minimum Time  |       |
| Maximum Time  |       |
| Average Time  |       |

[0m09:51:33.132448 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 70.057594, "process_in_blocks": "0", "process_kernel_time": 3.524118, "process_mem_max_rss": "2688630784", "process_out_blocks": "0", "process_user_time": 8.514128}
[0m09:51:33.132691 [debug] [MainThread]: Command `dbt show` succeeded at 09:51:33.132646 after 70.06 seconds
[0m09:51:33.132929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094eaa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ea990>]}
[0m09:51:33.133115 [debug] [MainThread]: Flushing usage events
[0m09:51:34.019518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:36.347545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f69d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cfed0>]}


============================== 10:37:36.349864 | 49fafc53-af2e-4031-8704-c6374fe05c18 ==============================
[0m10:37:36.349864 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:37:36.350143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:37:36.392342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49fafc53-af2e-4031-8704-c6374fe05c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134b1e00>]}
[0m10:37:36.400387 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:37:36.400989 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:37:36.402633 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.08759063, "process_in_blocks": "0", "process_kernel_time": 0.141361, "process_mem_max_rss": "107986944", "process_out_blocks": "0", "process_user_time": 0.630552}
[0m10:37:36.402867 [debug] [MainThread]: Command `cli deps` succeeded at 10:37:36.402819 after 0.09 seconds
[0m10:37:36.403020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140f9480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140fa9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114351350>]}
[0m10:37:36.403165 [debug] [MainThread]: Flushing usage events
[0m10:37:37.350536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:32.781222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110865d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146cfed0>]}


============================== 10:44:32.783447 | f465a8c8-3dc2-4929-ac05-2053aa91ca8e ==============================
[0m10:44:32.783447 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:44:32.783757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:44:32.789942 [info ] [MainThread]: dbt version: 1.9.4
[0m10:44:32.790180 [info ] [MainThread]: python version: 3.13.3
[0m10:44:32.790314 [info ] [MainThread]: python path: /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/bin/python3.13
[0m10:44:32.790438 [info ] [MainThread]: os info: macOS-15.4.1-arm64-arm-64bit-Mach-O
[0m10:44:32.833860 [info ] [MainThread]: Using profiles dir at /Users/yuejwang/.dbt
[0m10:44:32.834084 [info ] [MainThread]: Using profiles.yml file at /Users/yuejwang/.dbt/profiles.yml
[0m10:44:32.834225 [info ] [MainThread]: Using dbt_project.yml file at /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/dbt_project.yml
[0m10:44:32.835682 [info ] [MainThread]: adapter type: duckdb
[0m10:44:32.835853 [info ] [MainThread]: adapter version: 1.9.3
[0m10:44:32.869967 [info ] [MainThread]: Configuration:
[0m10:44:32.870227 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:44:32.870362 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:44:32.870477 [info ] [MainThread]: Required dependencies:
[0m10:44:32.870708 [debug] [MainThread]: Executing "git --help"
[0m10:44:32.879624 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:44:32.880084 [debug] [MainThread]: STDERR: "b''"
[0m10:44:32.880250 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:44:32.880396 [info ] [MainThread]: Connection:
[0m10:44:32.880539 [info ] [MainThread]:   database: dev
[0m10:44:32.880639 [info ] [MainThread]:   schema: main
[0m10:44:32.880739 [info ] [MainThread]:   path: dev.duckdb
[0m10:44:32.880839 [info ] [MainThread]:   config_options: None
[0m10:44:32.880940 [info ] [MainThread]:   extensions: ['httpfs', 'parquet']
[0m10:44:32.881058 [info ] [MainThread]:   settings: {'memory_limit': '4GB', 'enable_progress_bar': True}
[0m10:44:32.881158 [info ] [MainThread]:   external_root: .
[0m10:44:32.881256 [info ] [MainThread]:   use_credential_provider: None
[0m10:44:32.881365 [info ] [MainThread]:   attach: None
[0m10:44:32.881468 [info ] [MainThread]:   filesystems: None
[0m10:44:32.881564 [info ] [MainThread]:   remote: None
[0m10:44:32.881662 [info ] [MainThread]:   plugins: None
[0m10:44:32.881762 [info ] [MainThread]:   disable_transactions: False
[0m10:44:32.882049 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m10:44:32.921458 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:44:32.969153 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:44:32.969422 [debug] [MainThread]: On debug: select 1 as id
[0m10:44:32.969556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:32.997395 [debug] [MainThread]: SQL status: OK in 0.028 seconds
[0m10:44:32.997914 [debug] [MainThread]: On debug: Close
[0m10:44:32.998085 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:44:32.998249 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:44:32.999721 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.24968879, "process_in_blocks": "0", "process_kernel_time": 0.192633, "process_mem_max_rss": "137101312", "process_out_blocks": "0", "process_user_time": 0.799743}
[0m10:44:33.000005 [debug] [MainThread]: Command `dbt debug` succeeded at 10:44:32.999945 after 0.25 seconds
[0m10:44:33.000164 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:44:33.000328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d59a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ca3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147e8f30>]}
[0m10:44:33.000513 [debug] [MainThread]: Flushing usage events
[0m10:44:33.845108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:32.979785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124c75d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dcfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dcfed0>]}


============================== 10:49:32.982599 | 44e1124f-e6f2-440b-b81d-8cbce5953a01 ==============================
[0m10:49:32.982599 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:49:32.982873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:49:33.068703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44e1124f-e6f2-440b-b81d-8cbce5953a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1260a1f30>]}
[0m10:49:33.089516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44e1124f-e6f2-440b-b81d-8cbce5953a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125cfa8b0>]}
[0m10:49:33.091385 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m10:49:33.137967 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:49:33.209256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:49:33.209483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:49:33.228818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44e1124f-e6f2-440b-b81d-8cbce5953a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e82850>]}
[0m10:49:33.260355 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m10:49:33.261685 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m10:49:33.273659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44e1124f-e6f2-440b-b81d-8cbce5953a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12611bf20>]}
[0m10:49:33.273876 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m10:49:33.274019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e1124f-e6f2-440b-b81d-8cbce5953a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12677a510>]}
[0m10:49:33.274878 [info ] [MainThread]: 
[0m10:49:33.275028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:33.275138 [info ] [MainThread]: 
[0m10:49:33.275347 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:49:33.277372 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:49:33.330298 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:49:33.330515 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:49:33.330644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:33.335170 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:49:33.335360 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m10:49:33.335719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:33.335841 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m10:49:33.335955 [info ] [MainThread]: 
[0m10:49:33.336082 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m10:49:33.336282 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/dev.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 40541) by user yuejwang. See also https://duckdb.org/docs/connect/concurrency
[0m10:49:33.337772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.38891405, "process_in_blocks": "0", "process_kernel_time": 0.200668, "process_mem_max_rss": "130236416", "process_out_blocks": "0", "process_user_time": 0.766183}
[0m10:49:33.338010 [debug] [MainThread]: Command `dbt run` failed at 10:49:33.337963 after 0.39 seconds
[0m10:49:33.338178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e87380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c2fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271e0d10>]}
[0m10:49:33.338330 [debug] [MainThread]: Flushing usage events
[0m10:49:34.243784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:32.241940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a75d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcfed0>]}


============================== 10:50:32.244740 | f09fea13-7301-4ce6-82c7-052c4087dd68 ==============================
[0m10:50:32.244740 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:50:32.245018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select staging', 'send_anonymous_usage_stats': 'True'}
[0m10:50:32.328398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f09fea13-7301-4ce6-82c7-052c4087dd68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea1f30>]}
[0m10:50:32.349412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f09fea13-7301-4ce6-82c7-052c4087dd68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af68b0>]}
[0m10:50:32.351967 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m10:50:32.396681 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:50:32.467982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:50:32.468201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:50:32.488382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f09fea13-7301-4ce6-82c7-052c4087dd68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d82850>]}
[0m10:50:32.520261 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m10:50:32.521329 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m10:50:32.532940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f09fea13-7301-4ce6-82c7-052c4087dd68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f13f20>]}
[0m10:50:32.533152 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m10:50:32.533293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f09fea13-7301-4ce6-82c7-052c4087dd68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11237a510>]}
[0m10:50:32.534150 [info ] [MainThread]: 
[0m10:50:32.534294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:50:32.534404 [info ] [MainThread]: 
[0m10:50:32.534602 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:50:32.536591 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:50:32.588704 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:50:32.588932 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:50:32.589065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:32.593297 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:50:32.593488 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m10:50:32.593838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:32.593954 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m10:50:32.594071 [info ] [MainThread]: 
[0m10:50:32.594200 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m10:50:32.594400 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/dev.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 40541) by user yuejwang. See also https://duckdb.org/docs/connect/concurrency
[0m10:50:32.595935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.38438162, "process_in_blocks": "0", "process_kernel_time": 0.197215, "process_mem_max_rss": "129695744", "process_out_blocks": "0", "process_user_time": 0.764784}
[0m10:50:32.596127 [debug] [MainThread]: Command `dbt run` failed at 10:50:32.596086 after 0.38 seconds
[0m10:50:32.596278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d87380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a2fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126dcd10>]}
[0m10:50:32.596420 [debug] [MainThread]: Flushing usage events
[0m10:50:33.570656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:42.884707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106477c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106477ed0>]}


============================== 10:52:42.886660 | 317a2bd8-d36a-4d63-bdd6-e203f1ccf5e8 ==============================
[0m10:52:42.886660 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:52:42.886939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh --select staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:52:42.969878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '317a2bd8-d36a-4d63-bdd6-e203f1ccf5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106649f30>]}
[0m10:52:42.991286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '317a2bd8-d36a-4d63-bdd6-e203f1ccf5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a28b0>]}
[0m10:52:42.992892 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m10:52:43.037491 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:52:43.114081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:43.114617 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:43.136285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '317a2bd8-d36a-4d63-bdd6-e203f1ccf5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652a850>]}
[0m10:52:43.168035 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m10:52:43.169173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m10:52:43.181166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '317a2bd8-d36a-4d63-bdd6-e203f1ccf5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bff20>]}
[0m10:52:43.181402 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m10:52:43.181549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '317a2bd8-d36a-4d63-bdd6-e203f1ccf5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a26510>]}
[0m10:52:43.182399 [info ] [MainThread]: 
[0m10:52:43.182553 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:52:43.182665 [info ] [MainThread]: 
[0m10:52:43.182875 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:52:43.184741 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:52:43.237172 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:52:43.237391 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:52:43.237525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:43.277043 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m10:52:43.277727 [debug] [ThreadPool]: On list_dev: Close
[0m10:52:43.278038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:52:43.278233 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:52:43.281004 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:52:43.281142 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:52:43.281255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:43.281778 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:52:43.282369 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:52:43.282503 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:52:43.282675 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:43.282778 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:52:43.282887 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:52:43.283068 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:43.283385 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:52:43.283499 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:52:43.283598 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:52:43.283786 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:43.283956 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:52:43.284690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_intermediate)
[0m10:52:43.287017 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m10:52:43.287183 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m10:52:43.287303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:43.287694 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:43.287837 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m10:52:43.287966 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m10:52:43.296689 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m10:52:43.297525 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m10:52:43.298480 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m10:52:43.298643 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m10:52:43.298887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now list_dev_main_analysis)
[0m10:52:43.299601 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m10:52:43.299737 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m10:52:43.299842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:43.300143 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:43.300256 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m10:52:43.300377 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m10:52:43.303277 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:52:43.303779 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m10:52:43.304004 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m10:52:43.304110 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m10:52:43.304302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_marts)
[0m10:52:43.304932 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m10:52:43.305045 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m10:52:43.305140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:43.305423 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:43.305526 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m10:52:43.305633 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m10:52:43.308526 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:52:43.309067 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m10:52:43.309313 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m10:52:43.309431 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m10:52:43.309647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_marts, now list_dev_main)
[0m10:52:43.310585 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:52:43.310727 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:52:43.310837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:43.311128 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:52:43.311245 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:52:43.311361 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:52:43.314098 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:52:43.314636 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:52:43.314872 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:52:43.314998 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:52:43.315273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '317a2bd8-d36a-4d63-bdd6-e203f1ccf5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7e410>]}
[0m10:52:43.315495 [debug] [MainThread]: Using duckdb connection "master"
[0m10:52:43.315632 [debug] [MainThread]: On master: BEGIN
[0m10:52:43.315749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:52:43.316063 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:52:43.316193 [debug] [MainThread]: On master: COMMIT
[0m10:52:43.316303 [debug] [MainThread]: Using duckdb connection "master"
[0m10:52:43.316409 [debug] [MainThread]: On master: COMMIT
[0m10:52:43.316580 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:52:43.316691 [debug] [MainThread]: On master: Close
[0m10:52:43.318206 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m10:52:43.318428 [info ] [Thread-1 (]: 1 of 3 START sql incremental model main.stg_stackoverflow__comments ............ [RUN]
[0m10:52:43.318599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.stackoverflow_analysis_aw.stg_stackoverflow__comments)
[0m10:52:43.318731 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m10:52:43.323579 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m10:52:43.323982 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m10:52:43.346813 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m10:52:43.347427 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m10:52:43.347592 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: BEGIN
[0m10:52:43.347737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:43.348169 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:52:43.348308 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m10:52:43.348455 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__comments"
  
    as (
      -- models/staging/stg_stackoverflow__comments.sql


SELECT
    Id as comment_id,
    PostId as post_id,
    UserId as user_id,
    Text as comment_text,
    CreationDate as created_at
FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/comments.parquet'

    );
  
  
  
[0m11:01:27.683449 [debug] [Thread-1 (]: SQL status: OK in 524.345 seconds
[0m11:01:27.692815 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:01:27.693056 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_created_at ON "dev"."main"."stg_stackoverflow__comments" (created_at)
      
[0m11:01:27.695017 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:01:27.695898 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:01:27.696063 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_post_id ON "dev"."main"."stg_stackoverflow__comments" (post_id)
      
[0m11:01:27.696841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:01:27.697563 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:01:27.697706 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_user ON "dev"."main"."stg_stackoverflow__comments" (user_id)
      
[0m11:01:27.698389 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:01:27.698970 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:01:27.699098 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        ANALYZE "dev"."main"."stg_stackoverflow__comments"
      
[0m11:01:35.914395 [debug] [Thread-1 (]: SQL status: OK in 8.215 seconds
[0m11:01:35.915090 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m11:01:35.915264 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:01:35.915403 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m11:02:25.976719 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: COMMIT
[0m11:02:25.977392 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:02:25.977788 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: ROLLBACK
[0m11:02:25.986919 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.stg_stackoverflow__comments'
[0m11:02:25.987082 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: Close
[0m11:02:25.988743 [debug] [Thread-1 (]: Runtime Error in model stg_stackoverflow__comments (models/staging/stg_stackoverflow__comments.sql)
  TransactionContext Error: Failed to commit: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
[0m11:02:25.990491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '317a2bd8-d36a-4d63-bdd6-e203f1ccf5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c856d0>]}
[0m11:02:25.990993 [error] [Thread-1 (]: 1 of 3 ERROR creating sql incremental model main.stg_stackoverflow__comments ... [[31mERROR[0m in 582.67s]
[0m11:02:25.991252 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:02:25.991465 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m11:02:25.991744 [debug] [Thread-4 (]: Marking all children of 'model.stackoverflow_analysis_aw.stg_stackoverflow__comments' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stackoverflow__comments (models/staging/stg_stackoverflow__comments.sql)
  TransactionContext Error: Failed to commit: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used).
[0m11:02:25.991958 [info ] [Thread-1 (]: 2 of 3 START sql incremental model main.stg_stackoverflow__posts ............... [RUN]
[0m11:02:25.992746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.stg_stackoverflow__comments, now model.stackoverflow_analysis_aw.stg_stackoverflow__posts)
[0m11:02:25.992930 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m11:02:25.995288 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:02:25.996079 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m11:02:25.997182 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:02:25.997700 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:02:25.997820 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: BEGIN
[0m11:02:25.997942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:25.998367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:02:25.998492 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:02:25.998624 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__posts"
  
    as (
      -- models/staging/stg_stackoverflow__posts.sql


SELECT
    Id as post_id,
    OwnerUserId as owner_user_id,
    PostTypeId as post_type_id,
    ViewCount as view_count,
    CreationDate as created_at,
    AcceptedAnswerId as accepted_answer_id
FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/posts.parquet'

    );
  
  
  
[0m11:04:20.408450 [debug] [Thread-1 (]: SQL status: OK in 114.412 seconds
[0m11:04:20.410299 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:04:20.410479 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__posts_created_at ON "dev"."main"."stg_stackoverflow__posts" (created_at)
      
[0m11:04:20.411090 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:04:20.411866 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:04:20.412008 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__posts_post_type ON "dev"."main"."stg_stackoverflow__posts" (post_type_id)
      
[0m11:04:20.412465 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:04:20.413338 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:04:20.413466 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__posts_owner ON "dev"."main"."stg_stackoverflow__posts" (owner_user_id)
      
[0m11:04:20.413904 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:04:20.414396 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:04:20.414516 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        ANALYZE "dev"."main"."stg_stackoverflow__posts"
      
[0m11:04:21.762511 [debug] [Thread-1 (]: SQL status: OK in 1.348 seconds
[0m11:04:21.763007 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m11:04:21.763157 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:04:21.763275 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m11:05:16.136696 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: COMMIT
[0m11:05:16.137396 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:05:16.137627 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: ROLLBACK
[0m11:05:16.139197 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts'
[0m11:05:16.139339 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: Close
[0m11:05:16.140734 [debug] [Thread-1 (]: Runtime Error in model stg_stackoverflow__posts (models/staging/stg_stackoverflow__posts.sql)
  FATAL Error: Failed to create checkpoint because of error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
[0m11:05:16.140938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '317a2bd8-d36a-4d63-bdd6-e203f1ccf5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c945d0>]}
[0m11:05:16.141204 [error] [Thread-1 (]: 2 of 3 ERROR creating sql incremental model main.stg_stackoverflow__posts ...... [[31mERROR[0m in 170.15s]
[0m11:05:16.141421 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m11:05:16.141580 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m11:05:16.141802 [debug] [Thread-4 (]: Marking all children of 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stackoverflow__posts (models/staging/stg_stackoverflow__posts.sql)
  FATAL Error: Failed to create checkpoint because of error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used).
[0m11:05:16.142032 [info ] [Thread-1 (]: 3 of 3 START sql incremental model main.stg_stackoverflow__users ............... [RUN]
[0m11:05:16.142296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.stg_stackoverflow__posts, now model.stackoverflow_analysis_aw.stg_stackoverflow__users)
[0m11:05:16.142444 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m11:05:16.143902 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m11:05:16.144826 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m11:05:16.145885 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m11:05:16.146487 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m11:05:16.146615 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: BEGIN
[0m11:05:16.146730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:16.147083 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: BEGIN
[0m11:05:16.147205 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:05:16.151396 [debug] [Thread-1 (]: Runtime Error in model stg_stackoverflow__users (models/staging/stg_stackoverflow__users.sql)
  FATAL Error: Failed: database has been invalidated because of a previous fatal error. The database must be restarted prior to being used again.
  Original error: "Failed to create checkpoint because of error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)"
[0m11:05:16.151622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '317a2bd8-d36a-4d63-bdd6-e203f1ccf5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f45770>]}
[0m11:05:16.151867 [error] [Thread-1 (]: 3 of 3 ERROR creating sql incremental model main.stg_stackoverflow__users ...... [[31mERROR[0m in 0.01s]
[0m11:05:16.152081 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m11:05:16.152320 [debug] [Thread-4 (]: Marking all children of 'model.stackoverflow_analysis_aw.stg_stackoverflow__users' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stackoverflow__users (models/staging/stg_stackoverflow__users.sql)
  FATAL Error: Failed: database has been invalidated because of a previous fatal error. The database must be restarted prior to being used again.
  Original error: "Failed to create checkpoint because of error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)".
[0m11:05:16.153188 [debug] [MainThread]: Using duckdb connection "master"
[0m11:05:16.153312 [debug] [MainThread]: On master: BEGIN
[0m11:05:16.153416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:05:16.153785 [debug] [MainThread]: DuckDB adapter: Error running SQL: BEGIN
[0m11:05:16.153891 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:05:16.158044 [info ] [MainThread]: 
[0m11:05:16.158252 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m11:05:16.158379 [info ] [MainThread]: 
[0m11:05:16.158529 [error] [MainThread]:   Runtime Error in model stg_stackoverflow__comments (models/staging/stg_stackoverflow__comments.sql)
  TransactionContext Error: Failed to commit: failed to pin block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
[0m11:05:16.158637 [info ] [MainThread]: 
[0m11:05:16.158763 [error] [MainThread]:   Runtime Error in model stg_stackoverflow__posts (models/staging/stg_stackoverflow__posts.sql)
  FATAL Error: Failed to create checkpoint because of error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)
[0m11:05:16.158866 [info ] [MainThread]: 
[0m11:05:16.158998 [error] [MainThread]:   Runtime Error in model stg_stackoverflow__users (models/staging/stg_stackoverflow__users.sql)
  FATAL Error: Failed: database has been invalidated because of a previous fatal error. The database must be restarted prior to being used again.
  Original error: "Failed to create checkpoint because of error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)"
[0m11:05:16.159107 [info ] [MainThread]: 
[0m11:05:16.159233 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m11:05:16.159347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:16.159439 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__users' was properly closed.
[0m11:05:16.159551 [info ] [MainThread]: 
[0m11:05:16.159671 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 12 minutes and 32.98 seconds (752.98s).
[0m11:05:16.159879 [error] [MainThread]: Encountered an error:
Runtime Error
  FATAL Error: Failed: database has been invalidated because of a previous fatal error. The database must be restarted prior to being used again.
  Original error: "Failed to create checkpoint because of error: could not allocate block of size 256.0 KiB (3.7 GiB/3.7 GiB used)"
[0m11:05:16.161878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 753.3231, "process_in_blocks": "0", "process_kernel_time": 34.48257, "process_mem_max_rss": "5412356096", "process_out_blocks": "0", "process_user_time": 225.90181}
[0m11:05:16.162146 [debug] [MainThread]: Command `dbt run` failed at 11:05:16.162102 after 753.32 seconds
[0m11:05:16.162361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105980450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e1320>]}
[0m11:05:16.162507 [debug] [MainThread]: Flushing usage events
[0m11:05:17.129029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:10:02.444168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a875d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b9cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b9cfed0>]}


============================== 11:10:02.446667 | 4b802206-8c9b-40a8-87e8-042b0b423b1e ==============================
[0m11:10:02.446667 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:10:02.446945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:10:02.457102 [info ] [MainThread]: dbt version: 1.9.4
[0m11:10:02.457316 [info ] [MainThread]: python version: 3.13.3
[0m11:10:02.457437 [info ] [MainThread]: python path: /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/bin/python3.13
[0m11:10:02.457547 [info ] [MainThread]: os info: macOS-15.4.1-arm64-arm-64bit-Mach-O
[0m11:10:02.511075 [info ] [MainThread]: Using profiles dir at /Users/yuejwang/.dbt
[0m11:10:02.511303 [info ] [MainThread]: Using profiles.yml file at /Users/yuejwang/.dbt/profiles.yml
[0m11:10:02.511433 [info ] [MainThread]: Using dbt_project.yml file at /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/dbt_project.yml
[0m11:10:02.513264 [info ] [MainThread]: adapter type: duckdb
[0m11:10:02.513410 [info ] [MainThread]: adapter version: 1.9.3
[0m11:10:02.548485 [info ] [MainThread]: Configuration:
[0m11:10:02.548712 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:10:02.548838 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:10:02.548949 [info ] [MainThread]: Required dependencies:
[0m11:10:02.549186 [debug] [MainThread]: Executing "git --help"
[0m11:10:02.558192 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:10:02.558717 [debug] [MainThread]: STDERR: "b''"
[0m11:10:02.558893 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:10:02.559035 [info ] [MainThread]: Connection:
[0m11:10:02.559220 [info ] [MainThread]:   database: dev
[0m11:10:02.559437 [info ] [MainThread]:   schema: main
[0m11:10:02.559544 [info ] [MainThread]:   path: dev.duckdb
[0m11:10:02.559645 [info ] [MainThread]:   config_options: None
[0m11:10:02.559747 [info ] [MainThread]:   extensions: ['httpfs', 'parquet']
[0m11:10:02.559852 [info ] [MainThread]:   settings: {'memory_limit': '8GB', 'temp_directory': '/tmp', 'enable_progress_bar': True}
[0m11:10:02.559950 [info ] [MainThread]:   external_root: .
[0m11:10:02.560048 [info ] [MainThread]:   use_credential_provider: None
[0m11:10:02.560144 [info ] [MainThread]:   attach: None
[0m11:10:02.560401 [info ] [MainThread]:   filesystems: None
[0m11:10:02.560658 [info ] [MainThread]:   remote: None
[0m11:10:02.560981 [info ] [MainThread]:   plugins: None
[0m11:10:02.561130 [info ] [MainThread]:   disable_transactions: False
[0m11:10:02.561577 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:10:02.626100 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:10:02.677805 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:10:02.678037 [debug] [MainThread]: On debug: select 1 as id
[0m11:10:02.678165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:02.715018 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m11:10:02.715544 [debug] [MainThread]: On debug: Close
[0m11:10:02.715712 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:10:02.715852 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:10:02.717189 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.30732206, "process_in_blocks": "0", "process_kernel_time": 0.235532, "process_mem_max_rss": "135593984", "process_out_blocks": "0", "process_user_time": 0.765873}
[0m11:10:02.717440 [debug] [MainThread]: Command `dbt debug` succeeded at 11:10:02.717387 after 0.31 seconds
[0m11:10:02.717586 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:10:02.717739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da59a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bea3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bae9370>]}
[0m11:10:02.717919 [debug] [MainThread]: Flushing usage events
[0m11:10:03.619561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:13:33.467922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108221d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7bed0>]}


============================== 11:13:33.470086 | bb4db061-3337-4e3f-a39f-1f8a51f8fec2 ==============================
[0m11:13:33.470086 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:13:33.470358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select stg_stackoverflow__users', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:13:33.556014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb4db061-3337-4e3f-a39f-1f8a51f8fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109149f30>]}
[0m11:13:33.577490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb4db061-3337-4e3f-a39f-1f8a51f8fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9ce20>]}
[0m11:13:33.579202 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:13:33.623350 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:13:33.684956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:33.685190 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:33.707880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb4db061-3337-4e3f-a39f-1f8a51f8fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109002650>]}
[0m11:13:33.743605 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m11:13:33.744753 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m11:13:33.754938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb4db061-3337-4e3f-a39f-1f8a51f8fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091bff20>]}
[0m11:13:33.755202 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m11:13:33.755355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb4db061-3337-4e3f-a39f-1f8a51f8fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951e510>]}
[0m11:13:33.756109 [info ] [MainThread]: 
[0m11:13:33.756254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:33.756359 [info ] [MainThread]: 
[0m11:13:33.756564 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:13:33.756919 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:13:33.810183 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:13:33.810417 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:13:33.810574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:33.837931 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m11:13:33.838703 [debug] [ThreadPool]: On list_dev: Close
[0m11:13:33.839058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:13:33.839277 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:13:33.842323 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:13:33.842483 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:13:33.842608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:33.843148 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:13:33.843706 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:13:33.843825 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:13:33.843986 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:13:33.844094 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:13:33.844208 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:13:33.844396 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:13:33.844736 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:13:33.844862 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:13:33.844974 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:13:33.845141 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:13:33.845254 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:13:33.848169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_analysis)
[0m11:13:33.851439 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m11:13:33.851644 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m11:13:33.851768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:33.852201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:13:33.852322 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m11:13:33.852449 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m11:13:33.861036 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:13:33.861676 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m11:13:33.862678 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m11:13:33.862818 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m11:13:33.863066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_intermediate)
[0m11:13:33.863835 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m11:13:33.863986 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m11:13:33.864102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:33.864474 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:13:33.864597 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m11:13:33.864710 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m11:13:33.867435 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:13:33.867978 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m11:13:33.868223 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m11:13:33.868335 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m11:13:33.868541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now list_dev_main)
[0m11:13:33.869177 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:13:33.869288 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:13:33.869386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:33.869765 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:13:33.869878 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:13:33.869999 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:13:33.872933 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:13:33.873445 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:13:33.873671 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:13:33.873783 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:13:33.873998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_marts)
[0m11:13:33.874939 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m11:13:33.875056 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m11:13:33.875165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:33.875508 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:13:33.875617 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m11:13:33.875732 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m11:13:33.878476 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:13:33.878976 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m11:13:33.879193 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m11:13:33.879309 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m11:13:33.879568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb4db061-3337-4e3f-a39f-1f8a51f8fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977e410>]}
[0m11:13:33.879781 [debug] [MainThread]: Using duckdb connection "master"
[0m11:13:33.879908 [debug] [MainThread]: On master: BEGIN
[0m11:13:33.880019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:13:33.880354 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:13:33.880474 [debug] [MainThread]: On master: COMMIT
[0m11:13:33.880582 [debug] [MainThread]: Using duckdb connection "master"
[0m11:13:33.880685 [debug] [MainThread]: On master: COMMIT
[0m11:13:33.880869 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:13:33.881040 [debug] [MainThread]: On master: Close
[0m11:13:33.882669 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m11:13:33.882945 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__users ............... [RUN]
[0m11:13:33.883169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_marts, now model.stackoverflow_analysis_aw.stg_stackoverflow__users)
[0m11:13:33.883330 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m11:13:33.888383 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m11:13:33.889023 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m11:13:33.912400 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m11:13:33.913032 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m11:13:33.913199 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: BEGIN
[0m11:13:33.913337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:33.913820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:13:33.913978 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m11:13:33.914123 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__users"
  
    as (
      -- models/staging/stg_stackoverflow__users.sql


WITH source_data AS (
    SELECT *,
           ROW_NUMBER() OVER (ORDER BY CreationDate) as batch_id
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/users.parquet'
    
)
SELECT
    Id as user_id,
    DisplayName as display_name,
    CreationDate as created_at
FROM source_data
    );
  
  
  
[0m11:14:15.097980 [debug] [Thread-1 (]: SQL status: OK in 41.185 seconds
[0m11:14:15.103872 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m11:14:15.104046 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__users_created_at ON "dev"."main"."stg_stackoverflow__users" (created_at)
      
[0m11:14:15.104628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:14:15.105291 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m11:14:15.105461 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

        ANALYZE "dev"."main"."stg_stackoverflow__users"
      
[0m11:14:15.835010 [debug] [Thread-1 (]: SQL status: OK in 0.729 seconds
[0m11:14:15.835492 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: COMMIT
[0m11:14:15.835637 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m11:14:15.835754 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: COMMIT
[0m11:14:22.841566 [debug] [Thread-1 (]: SQL status: OK in 7.006 seconds
[0m11:14:22.842602 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: Close
[0m11:14:22.844245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb4db061-3337-4e3f-a39f-1f8a51f8fec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097859d0>]}
[0m11:14:22.844557 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.stg_stackoverflow__users .......... [[32mOK[0m in 48.96s]
[0m11:14:22.844794 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m11:14:22.845330 [debug] [MainThread]: Using duckdb connection "master"
[0m11:14:22.845450 [debug] [MainThread]: On master: BEGIN
[0m11:14:22.845546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:14:22.846012 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:14:22.846143 [debug] [MainThread]: On master: COMMIT
[0m11:14:22.846256 [debug] [MainThread]: Using duckdb connection "master"
[0m11:14:22.846353 [debug] [MainThread]: On master: COMMIT
[0m11:14:22.846492 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:14:22.846599 [debug] [MainThread]: On master: Close
[0m11:14:22.846736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:22.846832 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__users' was properly closed.
[0m11:14:22.846930 [info ] [MainThread]: 
[0m11:14:22.847048 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 49.09 seconds (49.09s).
[0m11:14:22.847310 [debug] [MainThread]: Command end result
[0m11:14:22.857723 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m11:14:22.859466 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m11:14:22.861883 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m11:14:22.862011 [info ] [MainThread]: 
[0m11:14:22.862164 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:22.862276 [info ] [MainThread]: 
[0m11:14:22.862392 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:14:22.864407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 49.427357, "process_in_blocks": "0", "process_kernel_time": 4.484251, "process_mem_max_rss": "4903534592", "process_out_blocks": "0", "process_user_time": 21.514103}
[0m11:14:22.864582 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:22.864548 after 49.43 seconds
[0m11:14:22.864722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a9440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099571b0>]}
[0m11:14:22.864858 [debug] [MainThread]: Flushing usage events
[0m11:14:23.781973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:14:35.674545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a75d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cfed0>]}


============================== 11:14:35.676623 | 445d5f9e-d96f-407a-9509-99d67a10bf87 ==============================
[0m11:14:35.676623 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:14:35.676894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select stg_stackoverflow__posts', 'send_anonymous_usage_stats': 'True'}
[0m11:14:35.759536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '445d5f9e-d96f-407a-9509-99d67a10bf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa1f30>]}
[0m11:14:35.780080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '445d5f9e-d96f-407a-9509-99d67a10bf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef8e20>]}
[0m11:14:35.781606 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:14:35.824644 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:14:35.885941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:35.886176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:35.908100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '445d5f9e-d96f-407a-9509-99d67a10bf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109976650>]}
[0m11:14:35.943636 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m11:14:35.944692 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m11:14:35.954845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '445d5f9e-d96f-407a-9509-99d67a10bf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b17f20>]}
[0m11:14:35.955089 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m11:14:35.955236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '445d5f9e-d96f-407a-9509-99d67a10bf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e76510>]}
[0m11:14:35.955988 [info ] [MainThread]: 
[0m11:14:35.956138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:35.956247 [info ] [MainThread]: 
[0m11:14:35.956452 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:14:35.956818 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:14:36.009915 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:14:36.010172 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:14:36.010316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:36.039337 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m11:14:36.040066 [debug] [ThreadPool]: On list_dev: Close
[0m11:14:36.040415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:14:36.040671 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:14:36.043671 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:14:36.043840 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:14:36.043964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:36.044495 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:14:36.045081 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:14:36.045205 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:14:36.045369 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:14:36.045484 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:14:36.045596 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:14:36.045776 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:14:36.046108 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:14:36.046228 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:14:36.046334 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:14:36.046508 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:14:36.046618 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:14:36.049243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_analysis)
[0m11:14:36.052048 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m11:14:36.052215 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m11:14:36.052339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:36.052789 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:14:36.052915 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m11:14:36.053033 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m11:14:36.061620 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:14:36.062245 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m11:14:36.063707 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m11:14:36.063851 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m11:14:36.064096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main)
[0m11:14:36.064811 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:14:36.064942 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:14:36.065053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:36.065415 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:14:36.065557 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:14:36.065686 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:14:36.068597 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:14:36.069192 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:14:36.069454 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:14:36.069576 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:14:36.069809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_intermediate)
[0m11:14:36.070646 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m11:14:36.070784 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m11:14:36.070897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:36.071327 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:14:36.071500 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m11:14:36.071648 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m11:14:36.074612 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:14:36.075130 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m11:14:36.075368 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m11:14:36.075482 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m11:14:36.075693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now list_dev_main_marts)
[0m11:14:36.076613 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m11:14:36.076753 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m11:14:36.076886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:36.077255 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:14:36.077387 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m11:14:36.077510 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m11:14:36.080254 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:14:36.080775 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m11:14:36.081016 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m11:14:36.081130 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m11:14:36.081402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '445d5f9e-d96f-407a-9509-99d67a10bf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1d2410>]}
[0m11:14:36.081603 [debug] [MainThread]: Using duckdb connection "master"
[0m11:14:36.081713 [debug] [MainThread]: On master: BEGIN
[0m11:14:36.081821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:36.082152 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:14:36.082271 [debug] [MainThread]: On master: COMMIT
[0m11:14:36.082378 [debug] [MainThread]: Using duckdb connection "master"
[0m11:14:36.082491 [debug] [MainThread]: On master: COMMIT
[0m11:14:36.082662 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:14:36.082796 [debug] [MainThread]: On master: Close
[0m11:14:36.084394 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m11:14:36.084626 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__posts ............... [RUN]
[0m11:14:36.084822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_marts, now model.stackoverflow_analysis_aw.stg_stackoverflow__posts)
[0m11:14:36.084970 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m11:14:36.090006 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:14:36.090439 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m11:14:36.113679 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:14:36.114280 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:14:36.114444 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: BEGIN
[0m11:14:36.114574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:36.115068 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:14:36.115231 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:14:36.115379 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__posts"
  
    as (
      -- models/staging/stg_stackoverflow__posts.sql


WITH source_data AS (
    SELECT *,
           ROW_NUMBER() OVER (ORDER BY CreationDate) as batch_id
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/posts.parquet'
    
)
SELECT
    Id as post_id,
    OwnerUserId as owner_user_id,
    PostTypeId as post_type_id,
    ViewCount as view_count,
    CreationDate as created_at,
    AcceptedAnswerId as accepted_answer_id
FROM source_data
    );
  
  
  
[0m11:16:36.380355 [debug] [Thread-1 (]: SQL status: OK in 120.267 seconds
[0m11:16:36.386496 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:16:36.386743 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__posts_created_at ON "dev"."main"."stg_stackoverflow__posts" (created_at)
      
[0m11:16:36.387491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:16:36.388364 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:16:36.388512 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__posts_post_type ON "dev"."main"."stg_stackoverflow__posts" (post_type_id)
      
[0m11:16:36.389149 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:16:36.389856 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:16:36.389993 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        ANALYZE "dev"."main"."stg_stackoverflow__posts"
      
[0m11:16:37.750864 [debug] [Thread-1 (]: SQL status: OK in 1.361 seconds
[0m11:16:37.751379 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m11:16:37.751530 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m11:16:37.751649 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m11:17:13.292566 [debug] [Thread-1 (]: SQL status: OK in 35.541 seconds
[0m11:17:13.294423 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: Close
[0m11:17:13.296079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d5f9e-d96f-407a-9509-99d67a10bf87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1dd910>]}
[0m11:17:13.367217 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.stg_stackoverflow__posts .......... [[32mOK[0m in 157.21s]
[0m11:17:13.367598 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m11:17:13.368463 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:13.368673 [debug] [MainThread]: On master: BEGIN
[0m11:17:13.369745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:13.370276 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:17:13.370414 [debug] [MainThread]: On master: COMMIT
[0m11:17:13.370541 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:13.370662 [debug] [MainThread]: On master: COMMIT
[0m11:17:13.370878 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:17:13.371083 [debug] [MainThread]: On master: Close
[0m11:17:13.371287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:13.371420 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts' was properly closed.
[0m11:17:13.371570 [info ] [MainThread]: 
[0m11:17:13.371727 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 2 minutes and 37.42 seconds (157.42s).
[0m11:17:13.372068 [debug] [MainThread]: Command end result
[0m11:17:13.384746 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m11:17:13.386396 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m11:17:13.389271 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m11:17:13.389410 [info ] [MainThread]: 
[0m11:17:13.389573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:17:13.389696 [info ] [MainThread]: 
[0m11:17:13.389828 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:17:13.391764 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 157.753, "process_in_blocks": "0", "process_kernel_time": 14.857997, "process_mem_max_rss": "7230881792", "process_out_blocks": "0", "process_user_time": 55.417976}
[0m11:17:13.391973 [debug] [MainThread]: Command `dbt run` succeeded at 11:17:13.391933 after 157.75 seconds
[0m11:17:13.392141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1fd440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3aba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3aaf30>]}
[0m11:17:13.392293 [debug] [MainThread]: Flushing usage events
[0m11:17:14.461183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:17:29.010399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a7ed0>]}


============================== 11:17:29.013093 | 3bb08c20-43f8-424d-b3c5-aa3c12f7afee ==============================
[0m11:17:29.013093 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:17:29.013401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select stg_stackoverflow__comments', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:17:29.101945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bb08c20-43f8-424d-b3c5-aa3c12f7afee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a79f30>]}
[0m11:17:29.123274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bb08c20-43f8-424d-b3c5-aa3c12f7afee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cce20>]}
[0m11:17:29.125834 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:17:29.174111 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:17:29.241004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:17:29.241217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:17:29.261207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bb08c20-43f8-424d-b3c5-aa3c12f7afee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106932650>]}
[0m11:17:29.293017 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m11:17:29.293872 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m11:17:29.306502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bb08c20-43f8-424d-b3c5-aa3c12f7afee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aeff20>]}
[0m11:17:29.306751 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m11:17:29.306900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bb08c20-43f8-424d-b3c5-aa3c12f7afee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e52510>]}
[0m11:17:29.307686 [info ] [MainThread]: 
[0m11:17:29.307844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:17:29.307946 [info ] [MainThread]: 
[0m11:17:29.308149 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:17:29.308518 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:17:29.361909 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:17:29.362129 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:17:29.362258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:29.391999 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m11:17:29.392679 [debug] [ThreadPool]: On list_dev: Close
[0m11:17:29.393011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:17:29.393233 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:17:29.396100 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:17:29.396250 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:17:29.396365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:29.396942 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:17:29.397482 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:17:29.397596 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:17:29.397836 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:17:29.397998 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:17:29.398118 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:17:29.398320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:17:29.398685 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:17:29.398806 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:17:29.398910 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:17:29.399094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:17:29.399248 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:17:29.402369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_intermediate)
[0m11:17:29.405235 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m11:17:29.405407 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m11:17:29.405530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:29.405946 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:17:29.406058 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m11:17:29.406183 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m11:17:29.415052 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m11:17:29.415615 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m11:17:29.416556 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m11:17:29.416729 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m11:17:29.416985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now list_dev_main_analysis)
[0m11:17:29.417709 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m11:17:29.417837 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m11:17:29.417944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:29.418295 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:17:29.418417 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m11:17:29.418538 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m11:17:29.421388 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:17:29.421939 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m11:17:29.422186 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m11:17:29.422301 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m11:17:29.422508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main)
[0m11:17:29.423194 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:17:29.423320 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:17:29.423424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:29.423826 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:17:29.423996 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:17:29.424133 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:17:29.427143 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:17:29.427762 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:17:29.428000 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:17:29.428110 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:17:29.428314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_marts)
[0m11:17:29.429447 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m11:17:29.429574 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m11:17:29.429680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:29.430069 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:17:29.430185 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m11:17:29.430311 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m11:17:29.433505 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:17:29.434074 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m11:17:29.434326 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m11:17:29.434450 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m11:17:29.434724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bb08c20-43f8-424d-b3c5-aa3c12f7afee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070aa410>]}
[0m11:17:29.434929 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:29.435050 [debug] [MainThread]: On master: BEGIN
[0m11:17:29.435156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:29.435543 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:17:29.435687 [debug] [MainThread]: On master: COMMIT
[0m11:17:29.435807 [debug] [MainThread]: Using duckdb connection "master"
[0m11:17:29.435916 [debug] [MainThread]: On master: COMMIT
[0m11:17:29.436073 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:17:29.436185 [debug] [MainThread]: On master: Close
[0m11:17:29.437756 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:17:29.438004 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__comments ............ [RUN]
[0m11:17:29.438212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_marts, now model.stackoverflow_analysis_aw.stg_stackoverflow__comments)
[0m11:17:29.438370 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:17:29.443354 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:17:29.444567 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:17:29.468057 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:17:29.468676 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:17:29.468851 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: BEGIN
[0m11:17:29.468998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:29.469471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:17:29.469605 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:17:29.469745 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__comments"
  
    as (
      -- models/staging/stg_stackoverflow__comments.sql


WITH source_data AS (
    SELECT *,
           ROW_NUMBER() OVER (ORDER BY CreationDate) as batch_id
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/comments.parquet'
    
)
SELECT
    Id as comment_id,
    PostId as post_id,
    UserId as user_id,
    Text as comment_text,
    CreationDate as created_at
FROM source_data
    );
  
  
  
[0m11:26:56.893140 [debug] [Thread-1 (]: SQL status: OK in 567.393 seconds
[0m11:26:56.902192 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:26:56.902429 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_created_at ON "dev"."main"."stg_stackoverflow__comments" (created_at)
      
[0m11:26:56.903511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:26:56.904301 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:26:56.904486 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_post_id ON "dev"."main"."stg_stackoverflow__comments" (post_id)
      
[0m11:26:56.905268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:26:56.905872 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:26:56.905999 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        ANALYZE "dev"."main"."stg_stackoverflow__comments"
      
[0m11:27:04.534023 [debug] [Thread-1 (]: SQL status: OK in 7.627 seconds
[0m11:27:04.535458 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m11:27:04.535683 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:27:04.535825 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m11:28:14.374272 [debug] [Thread-1 (]: SQL status: OK in 69.838 seconds
[0m11:28:14.378708 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: Close
[0m11:28:14.384043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bb08c20-43f8-424d-b3c5-aa3c12f7afee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b59d0>]}
[0m11:28:14.385069 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.stg_stackoverflow__comments ....... [[32mOK[0m in 644.94s]
[0m11:28:14.385368 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:28:14.389570 [debug] [MainThread]: Using duckdb connection "master"
[0m11:28:14.389696 [debug] [MainThread]: On master: BEGIN
[0m11:28:14.389802 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:14.391671 [debug] [MainThread]: DuckDB adapter: Error running SQL: BEGIN
[0m11:28:14.391785 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:28:14.396064 [info ] [MainThread]: 
[0m11:28:14.396286 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m11:28:14.396402 [info ] [MainThread]: 
[0m11:28:14.397620 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:28:14.397801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:14.397910 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__comments' was properly closed.
[0m11:28:14.398032 [info ] [MainThread]: 
[0m11:28:14.398157 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 10 minutes and 45.09 seconds (645.09s).
[0m11:28:14.398394 [error] [MainThread]: Encountered an error:
Runtime Error
  Not implemented Error: Cannot switch temporary directory after the current one has been used
[0m11:28:14.415179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 645.40845, "process_in_blocks": "0", "process_kernel_time": 131.75616, "process_mem_max_rss": "8226095104", "process_out_blocks": "0", "process_user_time": 248.96089}
[0m11:28:14.415500 [debug] [MainThread]: Command `dbt run` failed at 11:28:14.415455 after 645.41 seconds
[0m11:28:14.415786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d9180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107287c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107287890>]}
[0m11:28:14.415919 [debug] [MainThread]: Flushing usage events
[0m11:28:15.463681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:30.628635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a15d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecfed0>]}


============================== 11:36:30.631202 | 0c9f339c-c068-4cec-ba63-614b824664bd ==============================
[0m11:36:30.631202 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:36:30.631470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:36:30.642193 [info ] [MainThread]: dbt version: 1.9.4
[0m11:36:30.642410 [info ] [MainThread]: python version: 3.13.3
[0m11:36:30.642529 [info ] [MainThread]: python path: /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/bin/python3.13
[0m11:36:30.642640 [info ] [MainThread]: os info: macOS-15.4.1-arm64-arm-64bit-Mach-O
[0m11:36:30.644509 [info ] [MainThread]: target not specified in profile 'stackoverflow_analysis_aw', using 'default'
[0m11:36:30.644706 [info ] [MainThread]: Using profiles dir at /Users/yuejwang/.dbt
[0m11:36:30.644825 [info ] [MainThread]: Using profiles.yml file at /Users/yuejwang/.dbt/profiles.yml
[0m11:36:30.644929 [info ] [MainThread]: Using dbt_project.yml file at /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/dbt_project.yml
[0m11:36:30.677829 [info ] [MainThread]: Configuration:
[0m11:36:30.678087 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:36:30.678212 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:36:30.678323 [info ] [MainThread]: Required dependencies:
[0m11:36:30.678605 [debug] [MainThread]: Executing "git --help"
[0m11:36:30.687546 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:36:30.687969 [debug] [MainThread]: STDERR: "b''"
[0m11:36:30.688120 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:36:30.688265 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:36:30.688405 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:36:30.688516 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'stackoverflow_analysis_aw' does not have a target named 'default'. The valid target names for this profile are:
   - dev
   - prod


[0m11:36:30.690095 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.09386209, "process_in_blocks": "0", "process_kernel_time": 0.139186, "process_mem_max_rss": "106741760", "process_out_blocks": "0", "process_user_time": 0.629432}
[0m11:36:30.690402 [debug] [MainThread]: Command `dbt debug` failed at 11:36:30.690348 after 0.09 seconds
[0m11:36:30.690642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fcfce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11213af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df7ce0>]}
[0m11:36:30.690846 [debug] [MainThread]: Flushing usage events
[0m11:36:31.608226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:39.898291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494fed0>]}


============================== 11:38:39.900724 | 04b369d9-741c-480e-910b-0802e9ad665f ==============================
[0m11:38:39.900724 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:38:39.901043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:38:39.907382 [info ] [MainThread]: dbt version: 1.9.4
[0m11:38:39.907735 [info ] [MainThread]: python version: 3.13.3
[0m11:38:39.907889 [info ] [MainThread]: python path: /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/bin/python3.13
[0m11:38:39.908113 [info ] [MainThread]: os info: macOS-15.4.1-arm64-arm-64bit-Mach-O
[0m11:38:39.964747 [info ] [MainThread]: Using profiles dir at /Users/yuejwang/.dbt
[0m11:38:39.964992 [info ] [MainThread]: Using profiles.yml file at /Users/yuejwang/.dbt/profiles.yml
[0m11:38:39.965129 [info ] [MainThread]: Using dbt_project.yml file at /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/dbt_project.yml
[0m11:38:39.967007 [info ] [MainThread]: adapter type: duckdb
[0m11:38:39.967179 [info ] [MainThread]: adapter version: 1.9.3
[0m11:38:40.001961 [info ] [MainThread]: Configuration:
[0m11:38:40.002186 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:38:40.002320 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:38:40.002451 [info ] [MainThread]: Required dependencies:
[0m11:38:40.002687 [debug] [MainThread]: Executing "git --help"
[0m11:38:40.011394 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:38:40.011826 [debug] [MainThread]: STDERR: "b''"
[0m11:38:40.011982 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:38:40.012146 [info ] [MainThread]: Connection:
[0m11:38:40.012303 [info ] [MainThread]:   database: dev
[0m11:38:40.012413 [info ] [MainThread]:   schema: main
[0m11:38:40.012518 [info ] [MainThread]:   path: dev.duckdb
[0m11:38:40.012629 [info ] [MainThread]:   config_options: None
[0m11:38:40.012739 [info ] [MainThread]:   extensions: ['httpfs', 'parquet']
[0m11:38:40.012842 [info ] [MainThread]:   settings: {'memory_limit': '12GB', 'temp_directory': '/tmp/duckdb_temp', 'enable_progress_bar': True, 'default_null_order': 'nulls_first', 'preserve_insertion_order': False, 'external_threads': 4, 'max_memory': '80%'}
[0m11:38:40.012952 [info ] [MainThread]:   external_root: .
[0m11:38:40.013049 [info ] [MainThread]:   use_credential_provider: None
[0m11:38:40.013164 [info ] [MainThread]:   attach: None
[0m11:38:40.013259 [info ] [MainThread]:   filesystems: None
[0m11:38:40.013367 [info ] [MainThread]:   remote: None
[0m11:38:40.013468 [info ] [MainThread]:   plugins: None
[0m11:38:40.013569 [info ] [MainThread]:   disable_transactions: False
[0m11:38:40.013935 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:38:40.054665 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:38:40.108501 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:38:40.108722 [debug] [MainThread]: On debug: select 1 as id
[0m11:38:40.108848 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:40.150925 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m11:38:40.151149 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m11:38:40.151338 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:38:40.151480 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:38:40.151596 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  Parser Error: Unknown unit for memory_limit: '%' (expected: KB, MB, GB, TB for 1000^i units or KiB, MiB, GiB, TiB for 1024^i units)

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:38:40.152881 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.28481445, "process_in_blocks": "0", "process_kernel_time": 0.220468, "process_mem_max_rss": "141574144", "process_out_blocks": "0", "process_user_time": 0.799525}
[0m11:38:40.153143 [debug] [MainThread]: Command `dbt debug` failed at 11:38:40.153092 after 0.29 seconds
[0m11:38:40.153311 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:38:40.153464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd9a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c23bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a6a7a0>]}
[0m11:38:40.153642 [debug] [MainThread]: Flushing usage events
[0m11:38:41.060681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:56.363335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c01d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895bed0>]}


============================== 11:39:56.365545 | ee39d235-5efd-48f2-adc7-2fae7c950aef ==============================
[0m11:39:56.365545 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:39:56.365817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:39:56.372009 [info ] [MainThread]: dbt version: 1.9.4
[0m11:39:56.372211 [info ] [MainThread]: python version: 3.13.3
[0m11:39:56.372335 [info ] [MainThread]: python path: /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/bin/python3.13
[0m11:39:56.372462 [info ] [MainThread]: os info: macOS-15.4.1-arm64-arm-64bit-Mach-O
[0m11:39:56.417009 [info ] [MainThread]: Using profiles dir at /Users/yuejwang/.dbt
[0m11:39:56.417245 [info ] [MainThread]: Using profiles.yml file at /Users/yuejwang/.dbt/profiles.yml
[0m11:39:56.417393 [info ] [MainThread]: Using dbt_project.yml file at /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/dbt_project.yml
[0m11:39:56.418928 [info ] [MainThread]: adapter type: duckdb
[0m11:39:56.419072 [info ] [MainThread]: adapter version: 1.9.3
[0m11:39:56.454787 [info ] [MainThread]: Configuration:
[0m11:39:56.455026 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:39:56.455160 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:39:56.455278 [info ] [MainThread]: Required dependencies:
[0m11:39:56.455525 [debug] [MainThread]: Executing "git --help"
[0m11:39:56.464413 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:39:56.464880 [debug] [MainThread]: STDERR: "b''"
[0m11:39:56.465051 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:39:56.465208 [info ] [MainThread]: Connection:
[0m11:39:56.465387 [info ] [MainThread]:   database: dev
[0m11:39:56.465504 [info ] [MainThread]:   schema: main
[0m11:39:56.465613 [info ] [MainThread]:   path: dev.duckdb
[0m11:39:56.465722 [info ] [MainThread]:   config_options: None
[0m11:39:56.465834 [info ] [MainThread]:   extensions: ['httpfs', 'parquet']
[0m11:39:56.465948 [info ] [MainThread]:   settings: {'memory_limit': '12GB', 'temp_directory': '/tmp/duckdb_temp', 'enable_progress_bar': True, 'default_null_order': 'nulls_first', 'preserve_insertion_order': False, 'external_threads': 4}
[0m11:39:56.466059 [info ] [MainThread]:   external_root: .
[0m11:39:56.466156 [info ] [MainThread]:   use_credential_provider: None
[0m11:39:56.466259 [info ] [MainThread]:   attach: None
[0m11:39:56.466357 [info ] [MainThread]:   filesystems: None
[0m11:39:56.466456 [info ] [MainThread]:   remote: None
[0m11:39:56.466558 [info ] [MainThread]:   plugins: None
[0m11:39:56.466657 [info ] [MainThread]:   disable_transactions: False
[0m11:39:56.466928 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:39:56.505964 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:39:56.554688 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:39:56.554931 [debug] [MainThread]: On debug: select 1 as id
[0m11:39:56.555074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:56.586560 [debug] [MainThread]: SQL status: OK in 0.031 seconds
[0m11:39:56.587122 [debug] [MainThread]: On debug: Close
[0m11:39:56.587306 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:39:56.587467 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:39:56.588979 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.25639474, "process_in_blocks": "0", "process_kernel_time": 0.192204, "process_mem_max_rss": "141017088", "process_out_blocks": "0", "process_user_time": 0.804387}
[0m11:39:56.589262 [debug] [MainThread]: Command `dbt debug` succeeded at 11:39:56.589208 after 0.26 seconds
[0m11:39:56.589430 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:39:56.589606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce5a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c33d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a75370>]}
[0m11:39:56.589803 [debug] [MainThread]: Flushing usage events
[0m11:39:57.429046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:32.528598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d9dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af3ed0>]}


============================== 11:40:32.530925 | c62f0716-c7c6-4bfa-80fd-38679d5d937b ==============================
[0m11:40:32.530925 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:40:32.531189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --select stg_stackoverflow__comments', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:40:32.619673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62f0716-c7c6-4bfa-80fd-38679d5d937b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc5f30>]}
[0m11:40:32.641100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c62f0716-c7c6-4bfa-80fd-38679d5d937b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a18e20>]}
[0m11:40:32.642739 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:40:32.685035 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:40:32.721821 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:40:32.722071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c62f0716-c7c6-4bfa-80fd-38679d5d937b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e82b50>]}
[0m11:40:33.062006 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_stackoverflow__comments (models/staging/stg_stackoverflow__comments.sql)
  invalid syntax for function call expression
    line 3
      config(
[0m11:40:33.063379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.56506646, "process_in_blocks": "0", "process_kernel_time": 0.167691, "process_mem_max_rss": "120569856", "process_out_blocks": "0", "process_user_time": 1.03305}
[0m11:40:33.063570 [debug] [MainThread]: Command `dbt run` failed at 11:40:33.063532 after 0.57 seconds
[0m11:40:33.063712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f69040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4d470>]}
[0m11:40:33.063844 [debug] [MainThread]: Flushing usage events
[0m11:40:33.983588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:30.783677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109015d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cfed0>]}


============================== 11:42:30.786082 | 269eef8b-2a4d-43ff-8761-1f2ba666779f ==============================
[0m11:42:30.786082 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:42:30.786385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select stg_stackoverflow__comments', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:42:30.869022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '269eef8b-2a4d-43ff-8761-1f2ba666779f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6a1f30>]}
[0m11:42:30.889849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '269eef8b-2a4d-43ff-8761-1f2ba666779f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1f4e20>]}
[0m11:42:30.891496 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:42:30.933460 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:42:30.995861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:42:30.996108 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:42:31.017092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '269eef8b-2a4d-43ff-8761-1f2ba666779f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a476c50>]}
[0m11:42:31.054588 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m11:42:31.055919 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m11:42:31.066213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '269eef8b-2a4d-43ff-8761-1f2ba666779f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a717f20>]}
[0m11:42:31.066473 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m11:42:31.066619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '269eef8b-2a4d-43ff-8761-1f2ba666779f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab76510>]}
[0m11:42:31.067416 [info ] [MainThread]: 
[0m11:42:31.067558 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:42:31.067668 [info ] [MainThread]: 
[0m11:42:31.067881 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:42:31.068264 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:42:31.129383 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:42:31.129629 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:42:31.129772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:31.161899 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m11:42:31.162643 [debug] [ThreadPool]: On list_dev: Close
[0m11:42:31.163009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:42:31.164046 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:42:31.167056 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:42:31.167220 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:42:31.167349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:31.168080 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:42:31.168720 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:42:31.168864 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:42:31.169053 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:42:31.169169 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:42:31.169287 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:42:31.169511 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:42:31.169949 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:42:31.170101 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:42:31.170222 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:42:31.170406 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:42:31.170523 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:42:31.173108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m11:42:31.173336 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_intermediate'
[0m11:42:31.176048 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:42:31.176795 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m11:42:31.176953 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:42:31.177087 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m11:42:31.177217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:31.177348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:31.178002 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:42:31.178142 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:42:31.178297 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:42:31.178825 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:42:31.179003 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m11:42:31.179148 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m11:42:31.186837 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:42:31.187021 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:42:31.187698 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:42:31.188232 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m11:42:31.189272 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m11:42:31.189517 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:42:31.189647 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m11:42:31.189777 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:42:31.190017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now list_dev_main_marts)
[0m11:42:31.190200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_analysis)
[0m11:42:31.190864 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m11:42:31.191901 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m11:42:31.192031 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m11:42:31.192147 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m11:42:31.192256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:31.192361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:31.192962 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:42:31.193069 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m11:42:31.193182 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m11:42:31.193548 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:42:31.193686 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m11:42:31.193809 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m11:42:31.196120 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:42:31.196677 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m11:42:31.196844 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:42:31.197099 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m11:42:31.197253 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m11:42:31.197731 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m11:42:31.198046 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m11:42:31.198190 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m11:42:31.198484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '269eef8b-2a4d-43ff-8761-1f2ba666779f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add2750>]}
[0m11:42:31.198683 [debug] [MainThread]: Using duckdb connection "master"
[0m11:42:31.198803 [debug] [MainThread]: On master: BEGIN
[0m11:42:31.198906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:31.199459 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:42:31.199574 [debug] [MainThread]: On master: COMMIT
[0m11:42:31.199688 [debug] [MainThread]: Using duckdb connection "master"
[0m11:42:31.199801 [debug] [MainThread]: On master: COMMIT
[0m11:42:31.199960 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:42:31.200068 [debug] [MainThread]: On master: Close
[0m11:42:31.201697 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:42:31.201921 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__comments ............ [RUN]
[0m11:42:31.202100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now model.stackoverflow_analysis_aw.stg_stackoverflow__comments)
[0m11:42:31.202239 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:42:31.207895 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:42:31.208548 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:42:31.230980 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:42:31.231566 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:42:31.231736 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: BEGIN
[0m11:42:31.231871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:31.232481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:42:31.232626 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:42:31.232789 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__comments__dbt_tmp"
  
    as (
      -- models/staging/stg_stackoverflow__comments.sql


WITH source_data AS (
    SELECT 
        Id as comment_id,
        PostId as post_id,
        UserId as user_id,
        Text as comment_text,
        CreationDate as created_at,
        DATE_TRUNC('month', CreationDate) as created_at_month
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/comments.parquet'
    WHERE Id IS NOT NULL
    
),

validated_data AS (
    SELECT 
        CAST(comment_id AS BIGINT) as comment_id,
        CAST(post_id AS BIGINT) as post_id,
        CAST(user_id AS BIGINT) as user_id,
        comment_text,
        created_at,
        created_at_month
    FROM source_data
    WHERE comment_id > 0
    AND post_id > 0
)

SELECT 
    comment_id,
    post_id,
    user_id,
    comment_text,
    created_at,
    created_at_month
FROM validated_data
    );
  
  
  
[0m11:51:52.900018 [debug] [Thread-1 (]: SQL status: OK in 561.674 seconds
[0m11:51:52.909639 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:51:52.909858 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */
alter table "dev"."main"."stg_stackoverflow__comments" rename to "stg_stackoverflow__comments__dbt_backup"
[0m11:51:52.911693 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */
alter table "dev"."main"."stg_stackoverflow__comments" rename to "stg_stackoverflow__comments__dbt_backup"
[0m11:51:52.911885 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:51:52.912318 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: ROLLBACK
[0m11:51:52.923041 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.stg_stackoverflow__comments'
[0m11:51:52.923234 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: Close
[0m11:51:53.237064 [debug] [Thread-1 (]: Runtime Error in model stg_stackoverflow__comments (models/staging/stg_stackoverflow__comments.sql)
  Dependency Error: Cannot alter entry "stg_stackoverflow__comments" because there are entries that depend on it.
[0m11:51:53.241124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '269eef8b-2a4d-43ff-8761-1f2ba666779f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adddf10>]}
[0m11:51:53.241590 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.stg_stackoverflow__comments ... [[31mERROR[0m in 562.04s]
[0m11:51:53.241871 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:51:53.242116 [debug] [Thread-5 (]: Marking all children of 'model.stackoverflow_analysis_aw.stg_stackoverflow__comments' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stackoverflow__comments (models/staging/stg_stackoverflow__comments.sql)
  Dependency Error: Cannot alter entry "stg_stackoverflow__comments" because there are entries that depend on it..
[0m11:51:53.243354 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:53.243487 [debug] [MainThread]: On master: BEGIN
[0m11:51:53.243588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:51:53.244224 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:51:53.244350 [debug] [MainThread]: On master: COMMIT
[0m11:51:53.244452 [debug] [MainThread]: Using duckdb connection "master"
[0m11:51:53.244561 [debug] [MainThread]: On master: COMMIT
[0m11:51:53.244724 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:51:53.244816 [debug] [MainThread]: On master: Close
[0m11:51:53.244952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:53.245041 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__comments' was properly closed.
[0m11:51:53.245122 [debug] [MainThread]: Connection 'list_dev_main_marts' was properly closed.
[0m11:51:53.245245 [info ] [MainThread]: 
[0m11:51:53.245386 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 9 minutes and 22.18 seconds (562.18s).
[0m11:51:53.245649 [debug] [MainThread]: Command end result
[0m11:51:53.256641 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m11:51:53.258780 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m11:51:53.261742 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m11:51:53.261861 [info ] [MainThread]: 
[0m11:51:53.262031 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:51:53.262150 [info ] [MainThread]: 
[0m11:51:53.262302 [error] [MainThread]:   Runtime Error in model stg_stackoverflow__comments (models/staging/stg_stackoverflow__comments.sql)
  Dependency Error: Cannot alter entry "stg_stackoverflow__comments" because there are entries that depend on it.
[0m11:51:53.262408 [info ] [MainThread]: 
[0m11:51:53.262540 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:51:53.264263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 562.5178, "process_in_blocks": "0", "process_kernel_time": 25.171972, "process_mem_max_rss": "5257035776", "process_out_blocks": "0", "process_user_time": 87.76736}
[0m11:51:53.264461 [debug] [MainThread]: Command `dbt run` failed at 11:51:53.264428 after 562.52 seconds
[0m11:51:53.264645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af015a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af60cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af61e50>]}
[0m11:51:53.264775 [debug] [MainThread]: Flushing usage events
[0m11:51:54.224892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:56.975536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106875d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccfed0>]}


============================== 11:53:56.978044 | 8915b4c3-fd8d-48cb-8a4c-4d077a8be6fd ==============================
[0m11:53:56.978044 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:53:56.978300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:53:57.023851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8915b4c3-fd8d-48cb-8a4c-4d077a8be6fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db1e00>]}
[0m11:53:57.044123 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.099633664, "process_in_blocks": "0", "process_kernel_time": 0.146429, "process_mem_max_rss": "105398272", "process_out_blocks": "0", "process_user_time": 0.576664}
[0m11:53:57.044367 [debug] [MainThread]: Command `dbt clean` succeeded at 11:53:57.044319 after 0.10 seconds
[0m11:53:57.044531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf1bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3e450>]}
[0m11:53:57.045261 [debug] [MainThread]: Flushing usage events
[0m11:53:57.973658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:21.056584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107775d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188cfed0>]}


============================== 11:54:21.058858 | 7c410c3f-9ffa-4b2b-95f6-129972a3de0b ==============================
[0m11:54:21.058858 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:54:21.059181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --select stg_stackoverflow__comments', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:21.147022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c410c3f-9ffa-4b2b-95f6-129972a3de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118aa1f30>]}
[0m11:54:21.167888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c410c3f-9ffa-4b2b-95f6-129972a3de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187f8e20>]}
[0m11:54:21.170532 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:54:21.215191 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:54:21.215768 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:54:21.215937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c410c3f-9ffa-4b2b-95f6-129972a3de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11897b250>]}
[0m11:54:21.711914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c410c3f-9ffa-4b2b-95f6-129972a3de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b198b0>]}
[0m11:54:21.744644 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m11:54:21.745674 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m11:54:21.757550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c410c3f-9ffa-4b2b-95f6-129972a3de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab67d90>]}
[0m11:54:21.757763 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m11:54:21.757903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c410c3f-9ffa-4b2b-95f6-129972a3de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad172b0>]}
[0m11:54:21.758588 [info ] [MainThread]: 
[0m11:54:21.758721 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:54:21.758824 [info ] [MainThread]: 
[0m11:54:21.759011 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:54:21.759347 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:54:21.812648 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:54:21.812865 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m11:54:21.812991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:21.841923 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m11:54:21.842594 [debug] [ThreadPool]: On list_dev: Close
[0m11:54:21.842924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:54:21.843154 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:54:21.845931 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:54:21.846086 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m11:54:21.846199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:21.846907 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:54:21.847479 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:54:21.847608 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:54:21.847770 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:21.847872 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:54:21.847975 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:54:21.848150 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:21.848459 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:54:21.848576 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:54:21.848678 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:54:21.848828 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:54:21.848931 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:54:21.851499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_marts)
[0m11:54:21.853902 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m11:54:21.854429 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:54:21.854564 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m11:54:21.855258 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:54:21.855391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:21.855507 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:54:21.855710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:21.856218 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:54:21.856395 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m11:54:21.856566 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m11:54:21.857046 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:54:21.857171 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:54:21.857296 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m11:54:21.865246 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:54:21.865443 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m11:54:21.866020 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:54:21.866563 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m11:54:21.867462 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:54:21.867715 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m11:54:21.867845 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:54:21.867970 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m11:54:21.868239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_analysis)
[0m11:54:21.868956 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m11:54:21.869159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_marts, now list_dev_main_intermediate)
[0m11:54:21.869299 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m11:54:21.871276 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m11:54:21.871418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:21.871541 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m11:54:21.871718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:21.872197 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:54:21.872312 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m11:54:21.872456 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m11:54:21.872965 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:54:21.873097 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m11:54:21.873216 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m11:54:21.875167 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m11:54:21.875686 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m11:54:21.875935 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m11:54:21.876043 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m11:54:21.876153 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m11:54:21.876709 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m11:54:21.876937 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m11:54:21.877061 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m11:54:21.877360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c410c3f-9ffa-4b2b-95f6-129972a3de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af68d10>]}
[0m11:54:21.877576 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:21.877700 [debug] [MainThread]: On master: BEGIN
[0m11:54:21.877812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:21.878319 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:21.878459 [debug] [MainThread]: On master: COMMIT
[0m11:54:21.878582 [debug] [MainThread]: Using duckdb connection "master"
[0m11:54:21.878688 [debug] [MainThread]: On master: COMMIT
[0m11:54:21.878865 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:54:21.878986 [debug] [MainThread]: On master: Close
[0m11:54:21.880613 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:54:21.880842 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__comments ............ [RUN]
[0m11:54:21.881036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now model.stackoverflow_analysis_aw.stg_stackoverflow__comments)
[0m11:54:21.881170 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:54:21.884717 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:54:21.885364 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m11:54:21.908506 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:54:21.909432 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:54:21.909597 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: BEGIN
[0m11:54:21.909739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:21.910377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:54:21.910531 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m11:54:21.910687 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__comments"
  
    as (
      -- models/staging/stg_stackoverflow__comments.sql


WITH source_data AS (
    SELECT 
        Id as comment_id,
        PostId as post_id,
        UserId as user_id,
        Text as comment_text,
        CreationDate as created_at,
        DATE_TRUNC('month', CreationDate) as created_at_month
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/comments.parquet'
    WHERE Id IS NOT NULL
    
),

validated_data AS (
    SELECT 
        CAST(comment_id AS BIGINT) as comment_id,
        CAST(post_id AS BIGINT) as post_id,
        CAST(user_id AS BIGINT) as user_id,
        comment_text,
        created_at,
        created_at_month
    FROM source_data
    WHERE comment_id > 0
    AND post_id > 0
)

SELECT 
    comment_id,
    post_id,
    user_id,
    comment_text,
    created_at,
    created_at_month
FROM validated_data
    );
  
  
  
[0m12:02:40.137743 [debug] [Thread-1 (]: SQL status: OK in 498.233 seconds
[0m12:02:40.154620 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:02:40.155106 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_created_at ON "dev"."main"."stg_stackoverflow__comments" (created_at)
      
[0m12:02:40.157039 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:40.158598 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:02:40.158817 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_post_id ON "dev"."main"."stg_stackoverflow__comments" (post_id)
      
[0m12:02:40.159970 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:02:40.160779 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:02:40.160923 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        ANALYZE "dev"."main"."stg_stackoverflow__comments"
      
[0m12:02:46.831208 [debug] [Thread-1 (]: SQL status: OK in 6.670 seconds
[0m12:02:46.831749 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m12:02:46.831914 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:02:46.832039 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m12:03:58.449792 [debug] [Thread-1 (]: SQL status: OK in 71.618 seconds
[0m12:03:58.453324 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: Close
[0m12:03:58.455165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c410c3f-9ffa-4b2b-95f6-129972a3de0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abefcd0>]}
[0m12:03:58.455740 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.stg_stackoverflow__comments ....... [[32mOK[0m in 576.57s]
[0m12:03:58.456041 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m12:03:58.457293 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:58.457420 [debug] [MainThread]: On master: BEGIN
[0m12:03:58.457520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:58.458327 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:03:58.458494 [debug] [MainThread]: On master: COMMIT
[0m12:03:58.458620 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:58.458729 [debug] [MainThread]: On master: COMMIT
[0m12:03:58.458877 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:03:58.458988 [debug] [MainThread]: On master: Close
[0m12:03:58.459147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:58.459257 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__comments' was properly closed.
[0m12:03:58.459352 [debug] [MainThread]: Connection 'list_dev_main_analysis' was properly closed.
[0m12:03:58.459473 [info ] [MainThread]: 
[0m12:03:58.459606 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 9 minutes and 36.70 seconds (576.70s).
[0m12:03:58.460005 [debug] [MainThread]: Command end result
[0m12:03:58.471408 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m12:03:58.473416 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m12:03:58.475976 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m12:03:58.476106 [info ] [MainThread]: 
[0m12:03:58.476296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:58.476407 [info ] [MainThread]: 
[0m12:03:58.476537 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:03:58.478746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 577.46075, "process_in_blocks": "0", "process_kernel_time": 28.83347, "process_mem_max_rss": "7969538048", "process_out_blocks": "0", "process_user_time": 161.92361}
[0m12:03:58.479015 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:58.478975 after 577.46 seconds
[0m12:03:58.479255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b12fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b07fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118aa7250>]}
[0m12:03:58.479394 [debug] [MainThread]: Flushing usage events
[0m12:03:59.377578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:00.173826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124265d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253cfed0>]}


============================== 12:12:00.176551 | 08f46561-2f03-4850-989f-455cd9aa9e0b ==============================
[0m12:12:00.176551 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:12:00.176822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:12:00.303868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08f46561-2f03-4850-989f-455cd9aa9e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ba1f30>]}
[0m12:12:00.337041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08f46561-2f03-4850-989f-455cd9aa9e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1252f8e20>]}
[0m12:12:00.339637 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:12:00.385369 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:12:00.454702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:00.454922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:00.474489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08f46561-2f03-4850-989f-455cd9aa9e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125576c50>]}
[0m12:12:00.506290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m12:12:00.507179 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m12:12:00.519051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08f46561-2f03-4850-989f-455cd9aa9e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126c17f20>]}
[0m12:12:00.519284 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m12:12:00.519427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f46561-2f03-4850-989f-455cd9aa9e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138076190>]}
[0m12:12:00.520236 [info ] [MainThread]: 
[0m12:12:00.520378 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:12:00.520488 [info ] [MainThread]: 
[0m12:12:00.520698 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:12:00.522646 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:12:00.575297 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:12:00.575528 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:12:00.575656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:00.605736 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m12:12:00.606499 [debug] [ThreadPool]: On list_dev: Close
[0m12:12:00.606973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_intermediate)
[0m12:12:00.607228 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_intermediate"
"
[0m12:12:00.610556 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m12:12:00.610772 [debug] [ThreadPool]: On create_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:12:00.610897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:00.611738 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:12:00.612339 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m12:12:00.612468 [debug] [ThreadPool]: On create_dev_main_intermediate: BEGIN
[0m12:12:00.612631 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:12:00.612736 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m12:12:00.612839 [debug] [ThreadPool]: On create_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_intermediate"} */

    
    
        create schema if not exists "dev"."main_intermediate"
    
[0m12:12:00.613031 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:12:00.613395 [debug] [ThreadPool]: On create_dev_main_intermediate: COMMIT
[0m12:12:00.613516 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m12:12:00.613618 [debug] [ThreadPool]: On create_dev_main_intermediate: COMMIT
[0m12:12:00.614027 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:12:00.614150 [debug] [ThreadPool]: On create_dev_main_intermediate: Close
[0m12:12:00.614856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_intermediate, now list_dev_main_analysis)
[0m12:12:00.617119 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m12:12:00.617314 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_marts'
[0m12:12:00.617428 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m12:12:00.618367 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m12:12:00.618498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:00.618623 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m12:12:00.618805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:00.619299 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:12:00.619425 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m12:12:00.619545 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m12:12:00.619928 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:12:00.620039 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m12:12:00.620149 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m12:12:00.627620 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m12:12:00.627836 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:12:00.628519 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m12:12:00.629057 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m12:12:00.630119 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m12:12:00.630374 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m12:12:00.630517 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m12:12:00.630658 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m12:12:00.630955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_marts, now list_dev_main)
[0m12:12:00.631179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_intermediate)
[0m12:12:00.631878 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:12:00.632526 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m12:12:00.632655 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:12:00.632773 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m12:12:00.632887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:00.633001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:00.633599 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:12:00.633712 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:12:00.633828 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:12:00.634426 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:12:00.634543 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m12:12:00.634655 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m12:12:00.636851 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:12:00.637442 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:12:00.637614 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:12:00.637829 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:12:00.637966 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:12:00.638408 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m12:12:00.638691 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m12:12:00.638914 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m12:12:00.639187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f46561-2f03-4850-989f-455cd9aa9e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1382d68f0>]}
[0m12:12:00.639388 [debug] [MainThread]: Using duckdb connection "master"
[0m12:12:00.639501 [debug] [MainThread]: On master: BEGIN
[0m12:12:00.639615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:00.640126 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:12:00.640260 [debug] [MainThread]: On master: COMMIT
[0m12:12:00.640376 [debug] [MainThread]: Using duckdb connection "master"
[0m12:12:00.640476 [debug] [MainThread]: On master: COMMIT
[0m12:12:00.640652 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:12:00.640773 [debug] [MainThread]: On master: Close
[0m12:12:00.642538 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m12:12:00.642717 [debug] [Thread-2 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m12:12:00.642943 [info ] [Thread-1 (]: 1 of 3 START sql table model main_intermediate.int_stackoverflow__answer_timing  [RUN]
[0m12:12:00.643196 [info ] [Thread-2 (]: 2 of 3 START sql table model main_intermediate.int_stackoverflow__at_replies ... [RUN]
[0m12:12:00.643403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing)
[0m12:12:00.643569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.stackoverflow_analysis_aw.int_stackoverflow__at_replies)
[0m12:12:00.643727 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m12:12:00.643875 [debug] [Thread-2 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m12:12:00.647238 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m12:12:00.648459 [debug] [Thread-2 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m12:12:00.648930 [debug] [Thread-2 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m12:12:00.654788 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m12:12:00.662929 [debug] [Thread-2 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m12:12:00.664341 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m12:12:00.665007 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m12:12:00.665193 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m12:12:00.665340 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: BEGIN
[0m12:12:00.665486 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: BEGIN
[0m12:12:00.665628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:00.665754 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:12:00.666386 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:12:00.666556 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m12:12:00.666761 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__answer_timing.sql


WITH answer_timing AS (
    SELECT 
        q.post_id as question_id,
        q.created_at as question_date,
        a.created_at as answer_date,
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL
        AND DATEDIFF('minute', q.created_at, a.created_at) >= 0  -- Filter out negative times
)

SELECT 
    question_id,
    question_date,
    answer_date,
    minutes_to_answer,
    CASE 
        WHEN minutes_to_answer < 15 THEN 'Very Fast (<15 mins)'
        WHEN minutes_to_answer < 60 THEN 'Fast (15-60 mins)'
        WHEN minutes_to_answer < 480 THEN 'Same Day (1-8 hours)'
        WHEN minutes_to_answer < 1440 THEN 'Next Day (<24 hours)'
        WHEN minutes_to_answer < 7200 THEN 'Within 5 Days'
        ELSE 'More than 5 Days'
    END as response_time_band
    );
  
  
[0m12:12:00.667277 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:12:00.667410 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m12:12:00.667552 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__at_replies__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__at_replies.sql


WITH question_authors AS (
    SELECT 
        post_id,
        owner_user_id as author_id
    FROM "dev"."main"."stg_stackoverflow__posts"
    WHERE post_type_id = 1  -- Questions only
)

SELECT
    c.comment_id,
    c.post_id,
    c.comment_text,
    c.user_id,
    c.created_at as comment_date,
    qa.author_id as question_author_id
FROM "dev"."main"."stg_stackoverflow__comments" c
INNER JOIN question_authors qa 
    ON c.post_id = qa.post_id
WHERE c.comment_text LIKE '@%'  -- Comments with @mentions
  AND c.user_id = qa.author_id  -- Comment made by question author
    );
  
  
[0m12:12:00.668046 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__answer_timing.sql


WITH answer_timing AS (
    SELECT 
        q.post_id as question_id,
        q.created_at as question_date,
        a.created_at as answer_date,
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL
        AND DATEDIFF('minute', q.created_at, a.created_at) >= 0  -- Filter out negative times
)

SELECT 
    question_id,
    question_date,
    answer_date,
    minutes_to_answer,
    CASE 
        WHEN minutes_to_answer < 15 THEN 'Very Fast (<15 mins)'
        WHEN minutes_to_answer < 60 THEN 'Fast (15-60 mins)'
        WHEN minutes_to_answer < 480 THEN 'Same Day (1-8 hours)'
        WHEN minutes_to_answer < 1440 THEN 'Next Day (<24 hours)'
        WHEN minutes_to_answer < 7200 THEN 'Within 5 Days'
        ELSE 'More than 5 Days'
    END as response_time_band
    );
  
  
[0m12:12:00.668224 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:12:00.668407 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: ROLLBACK
[0m12:12:00.669710 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__at_replies__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__at_replies.sql


WITH question_authors AS (
    SELECT 
        post_id,
        owner_user_id as author_id
    FROM "dev"."main"."stg_stackoverflow__posts"
    WHERE post_type_id = 1  -- Questions only
)

SELECT
    c.comment_id,
    c.post_id,
    c.comment_text,
    c.user_id,
    c.created_at as comment_date,
    qa.author_id as question_author_id
FROM "dev"."main"."stg_stackoverflow__comments" c
INNER JOIN question_authors qa 
    ON c.post_id = qa.post_id
WHERE c.comment_text LIKE '@%'  -- Comments with @mentions
  AND c.user_id = qa.author_id  -- Comment made by question author
    );
  
  
[0m12:12:00.669884 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:12:00.670063 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: ROLLBACK
[0m12:12:00.675956 [debug] [Thread-2 (]: Failed to rollback 'model.stackoverflow_analysis_aw.int_stackoverflow__at_replies'
[0m12:12:00.676339 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing'
[0m12:12:00.676506 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: Close
[0m12:12:00.676659 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: Close
[0m12:12:00.679810 [debug] [Thread-2 (]: Runtime Error in model int_stackoverflow__at_replies (models/intermediate/int_stackoverflow__at_replies.sql)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "stg_stackoverflow__comments"?
  
  LINE 18:     FROM "dev"."main"."stg_stackoverflow__posts"
                    ^
[0m12:12:00.680184 [debug] [Thread-1 (]: Runtime Error in model int_stackoverflow__answer_timing (models/intermediate/int_stackoverflow__answer_timing.sql)
  Binder Error: Referenced column "question_id" not found in FROM clause!
  
  LINE 29:     question_id,
               ^
[0m12:12:00.681120 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f46561-2f03-4850-989f-455cd9aa9e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1382e1b50>]}
[0m12:12:00.681265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f46561-2f03-4850-989f-455cd9aa9e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1382ecf70>]}
[0m12:12:00.681539 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model main_intermediate.int_stackoverflow__at_replies  [[31mERROR[0m in 0.04s]
[0m12:12:00.681814 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model main_intermediate.int_stackoverflow__answer_timing  [[31mERROR[0m in 0.04s]
[0m12:12:00.682068 [debug] [Thread-2 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m12:12:00.682275 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m12:12:00.682445 [debug] [Thread-2 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m12:12:00.682634 [debug] [Thread-5 (]: Marking all children of 'model.stackoverflow_analysis_aw.int_stackoverflow__at_replies' to be skipped because of status 'error'.  Reason: Runtime Error in model int_stackoverflow__at_replies (models/intermediate/int_stackoverflow__at_replies.sql)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "stg_stackoverflow__comments"?
  
  LINE 18:     FROM "dev"."main"."stg_stackoverflow__posts"
                    ^.
[0m12:12:00.682835 [info ] [Thread-2 (]: 3 of 3 START sql table model main_intermediate.int_stackoverflow__question_views  [RUN]
[0m12:12:00.683313 [debug] [Thread-5 (]: Marking all children of 'model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing' to be skipped because of status 'error'.  Reason: Runtime Error in model int_stackoverflow__answer_timing (models/intermediate/int_stackoverflow__answer_timing.sql)
  Binder Error: Referenced column "question_id" not found in FROM clause!
  
  LINE 29:     question_id,
               ^.
[0m12:12:00.683492 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.int_stackoverflow__at_replies, now model.stackoverflow_analysis_aw.int_stackoverflow__question_views)
[0m12:12:00.683677 [debug] [Thread-2 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m12:12:00.684895 [debug] [Thread-2 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m12:12:00.685270 [debug] [Thread-2 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m12:12:00.686328 [debug] [Thread-2 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m12:12:00.686631 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m12:12:00.686760 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: BEGIN
[0m12:12:00.686881 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:12:00.687495 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:12:00.687648 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m12:12:00.687791 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__question_views__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__question_views.sql


SELECT
    owner_user_id,
    COUNT(*) as total_questions,
    SUM(view_count) as total_views,
    ROUND(AVG(view_count), 2) as avg_views_per_question
FROM "dev"."main"."stg_stackoverflow__posts"
WHERE post_type_id = 1  -- Questions only
  AND owner_user_id IS NOT NULL
GROUP BY owner_user_id
    );
  
  
[0m12:12:00.689416 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__question_views__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__question_views.sql


SELECT
    owner_user_id,
    COUNT(*) as total_questions,
    SUM(view_count) as total_views,
    ROUND(AVG(view_count), 2) as avg_views_per_question
FROM "dev"."main"."stg_stackoverflow__posts"
WHERE post_type_id = 1  -- Questions only
  AND owner_user_id IS NOT NULL
GROUP BY owner_user_id
    );
  
  
[0m12:12:00.689567 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:12:00.689741 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: ROLLBACK
[0m12:12:00.691789 [debug] [Thread-2 (]: Failed to rollback 'model.stackoverflow_analysis_aw.int_stackoverflow__question_views'
[0m12:12:00.691938 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: Close
[0m12:12:00.693597 [debug] [Thread-2 (]: Runtime Error in model int_stackoverflow__question_views (models/intermediate/int_stackoverflow__question_views.sql)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "stg_stackoverflow__comments"?
  
  LINE 19: FROM "dev"."main"."stg_stackoverflow__posts"
                ^
[0m12:12:00.693791 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f46561-2f03-4850-989f-455cd9aa9e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245ba530>]}
[0m12:12:00.694043 [error] [Thread-2 (]: 3 of 3 ERROR creating sql table model main_intermediate.int_stackoverflow__question_views  [[31mERROR[0m in 0.01s]
[0m12:12:00.694264 [debug] [Thread-2 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m12:12:00.694464 [debug] [Thread-5 (]: Marking all children of 'model.stackoverflow_analysis_aw.int_stackoverflow__question_views' to be skipped because of status 'error'.  Reason: Runtime Error in model int_stackoverflow__question_views (models/intermediate/int_stackoverflow__question_views.sql)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "stg_stackoverflow__comments"?
  
  LINE 19: FROM "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m12:12:00.695007 [debug] [MainThread]: Using duckdb connection "master"
[0m12:12:00.695128 [debug] [MainThread]: On master: BEGIN
[0m12:12:00.695229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:12:00.695790 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:12:00.695913 [debug] [MainThread]: On master: COMMIT
[0m12:12:00.696020 [debug] [MainThread]: Using duckdb connection "master"
[0m12:12:00.696118 [debug] [MainThread]: On master: COMMIT
[0m12:12:00.696271 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:12:00.696374 [debug] [MainThread]: On master: Close
[0m12:12:00.696516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:00.696612 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing' was properly closed.
[0m12:12:00.696704 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.int_stackoverflow__question_views' was properly closed.
[0m12:12:00.696830 [info ] [MainThread]: 
[0m12:12:00.696950 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:12:00.697307 [debug] [MainThread]: Command end result
[0m12:12:00.708559 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m12:12:00.709533 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m12:12:00.712142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m12:12:00.712268 [info ] [MainThread]: 
[0m12:12:00.712415 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:12:00.712529 [info ] [MainThread]: 
[0m12:12:00.712672 [error] [MainThread]:   Runtime Error in model int_stackoverflow__at_replies (models/intermediate/int_stackoverflow__at_replies.sql)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "stg_stackoverflow__comments"?
  
  LINE 18:     FROM "dev"."main"."stg_stackoverflow__posts"
                    ^
[0m12:12:00.712780 [info ] [MainThread]: 
[0m12:12:00.712906 [error] [MainThread]:   Runtime Error in model int_stackoverflow__answer_timing (models/intermediate/int_stackoverflow__answer_timing.sql)
  Binder Error: Referenced column "question_id" not found in FROM clause!
  
  LINE 29:     question_id,
               ^
[0m12:12:00.713011 [info ] [MainThread]: 
[0m12:12:00.713134 [error] [MainThread]:   Runtime Error in model int_stackoverflow__question_views (models/intermediate/int_stackoverflow__question_views.sql)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "stg_stackoverflow__comments"?
  
  LINE 19: FROM "dev"."main"."stg_stackoverflow__posts"
                ^
[0m12:12:00.713238 [info ] [MainThread]: 
[0m12:12:00.713355 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m12:12:00.714720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5740687, "process_in_blocks": "0", "process_kernel_time": 0.234826, "process_mem_max_rss": "153108480", "process_out_blocks": "0", "process_user_time": 1.015932}
[0m12:12:00.714927 [debug] [MainThread]: Command `dbt run` failed at 12:12:00.714887 after 0.57 seconds
[0m12:12:00.715092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245c37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1245d4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12553d320>]}
[0m12:12:00.715236 [debug] [MainThread]: Flushing usage events
[0m12:12:01.643671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:27.650759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113015d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dcfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dcfed0>]}


============================== 12:13:27.653111 | e04a15cb-ba75-4af8-bfc4-ca1107f0f595 ==============================
[0m12:13:27.653111 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:13:27.653423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:13:27.741288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e04a15cb-ba75-4af8-bfc4-ca1107f0f595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fa1f30>]}
[0m12:13:27.762015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e04a15cb-ba75-4af8-bfc4-ca1107f0f595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cf4e20>]}
[0m12:13:27.763655 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:13:27.805852 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:13:27.871187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:13:27.871447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:13:27.892492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e04a15cb-ba75-4af8-bfc4-ca1107f0f595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e76c50>]}
[0m12:13:27.930140 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m12:13:27.931093 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m12:13:27.940063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e04a15cb-ba75-4af8-bfc4-ca1107f0f595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11501bf20>]}
[0m12:13:27.940317 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m12:13:27.940472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04a15cb-ba75-4af8-bfc4-ca1107f0f595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115476190>]}
[0m12:13:27.941379 [info ] [MainThread]: 
[0m12:13:27.941529 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:13:27.941638 [info ] [MainThread]: 
[0m12:13:27.941846 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:13:27.943889 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:13:27.999472 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:13:27.999716 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:13:27.999865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:28.030171 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m12:13:28.030980 [debug] [ThreadPool]: On list_dev: Close
[0m12:13:28.031347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:13:28.031566 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:13:28.034955 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:13:28.035155 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:13:28.035289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:28.036055 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:13:28.036637 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:13:28.036761 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:13:28.036948 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:13:28.037050 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:13:28.037160 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:13:28.037381 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:13:28.037773 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:13:28.037910 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:13:28.038027 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:13:28.038201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:13:28.038321 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:13:28.039092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_marts)
[0m12:13:28.041615 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m12:13:28.041827 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_analysis'
[0m12:13:28.041954 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m12:13:28.042991 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m12:13:28.043156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:28.043300 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m12:13:28.043503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:28.044046 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:13:28.044176 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m12:13:28.044300 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m12:13:28.044780 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:13:28.044929 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m12:13:28.045060 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m12:13:28.052960 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:13:28.053117 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m12:13:28.053737 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m12:13:28.054215 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m12:13:28.054891 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m12:13:28.055098 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m12:13:28.055349 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m12:13:28.055522 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m12:13:28.055740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_marts, now list_dev_main_intermediate)
[0m12:13:28.056515 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m12:13:28.056740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main)
[0m12:13:28.056894 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m12:13:28.057531 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:13:28.057663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:28.057802 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:13:28.057982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:28.058446 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:13:28.058581 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m12:13:28.058742 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m12:13:28.059204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:13:28.059341 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:13:28.059677 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:13:28.061721 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:13:28.062334 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m12:13:28.062579 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m12:13:28.062695 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m12:13:28.062817 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:13:28.063413 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:13:28.063649 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:13:28.063768 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:13:28.064155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04a15cb-ba75-4af8-bfc4-ca1107f0f595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156d6750>]}
[0m12:13:28.064362 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:28.064484 [debug] [MainThread]: On master: BEGIN
[0m12:13:28.064596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:28.065055 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:13:28.065174 [debug] [MainThread]: On master: COMMIT
[0m12:13:28.065278 [debug] [MainThread]: Using duckdb connection "master"
[0m12:13:28.065390 [debug] [MainThread]: On master: COMMIT
[0m12:13:28.065550 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:13:28.065663 [debug] [MainThread]: On master: Close
[0m12:13:28.066839 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m12:13:28.067007 [debug] [Thread-2 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m12:13:28.067243 [info ] [Thread-1 (]: 1 of 3 START sql incremental model main.stg_stackoverflow__comments ............ [RUN]
[0m12:13:28.067452 [info ] [Thread-2 (]: 2 of 3 START sql incremental model main.stg_stackoverflow__posts ............... [RUN]
[0m12:13:28.067716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now model.stackoverflow_analysis_aw.stg_stackoverflow__comments)
[0m12:13:28.067885 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.stackoverflow_analysis_aw.stg_stackoverflow__posts)
[0m12:13:28.068045 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m12:13:28.068202 [debug] [Thread-2 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m12:13:28.074579 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:13:28.076536 [debug] [Thread-2 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m12:13:28.077283 [debug] [Thread-2 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m12:13:28.077478 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m12:13:28.100665 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m12:13:28.104545 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:13:28.104719 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: BEGIN
[0m12:13:28.104902 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

    
  
    
    

    create temporary table
      "stg_stackoverflow__comments__dbt_tmp20250518121328092626"
  
    as (
      -- models/staging/stg_stackoverflow__comments.sql


WITH source_data AS (
    SELECT 
        Id as comment_id,
        PostId as post_id,
        UserId as user_id,
        Text as comment_text,
        CreationDate as created_at,
        DATE_TRUNC('month', CreationDate) as created_at_month
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/comments.parquet'
    WHERE Id IS NOT NULL
    
        AND CreationDate > (SELECT MAX(created_at) FROM "dev"."main"."stg_stackoverflow__comments")
    
),

validated_data AS (
    SELECT 
        CAST(comment_id AS BIGINT) as comment_id,
        CAST(post_id AS BIGINT) as post_id,
        CAST(user_id AS BIGINT) as user_id,
        comment_text,
        created_at,
        created_at_month
    FROM source_data
    WHERE comment_id > 0
    AND post_id > 0
)

SELECT 
    comment_id,
    post_id,
    user_id,
    comment_text,
    created_at,
    created_at_month
FROM validated_data
    );
  
  
  
[0m12:13:28.105070 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:13:28.105206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:28.105905 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:13:28.106085 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m12:13:28.106233 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        DROP INDEX IF EXISTS idx_stg_stackoverflow__posts_created_at
      
[0m12:13:28.106515 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:13:28.107323 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m12:13:28.107507 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        DROP INDEX IF EXISTS idx_stg_stackoverflow__posts_post_id
      
[0m12:13:28.107734 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:13:28.108312 [debug] [Thread-2 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m12:13:28.108843 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m12:13:28.109009 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__posts"
  
    as (
      -- models/staging/stg_stackoverflow__comments.sql


WITH source_data AS (
    SELECT 
        Id as comment_id,
        PostId as post_id,
        UserId as user_id,
        Text as comment_text,
        CreationDate as created_at,
        DATE_TRUNC('month', CreationDate) as created_at_month
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/comments.parquet'
    WHERE Id IS NOT NULL
    
),

validated_data AS (
    SELECT 
        CAST(comment_id AS BIGINT) as comment_id,
        CAST(post_id AS BIGINT) as post_id,
        CAST(user_id AS BIGINT) as user_id,
        comment_text,
        created_at,
        created_at_month
    FROM source_data
    WHERE comment_id > 0
    AND post_id > 0
)

SELECT 
    comment_id,
    post_id,
    user_id,
    comment_text,
    created_at,
    created_at_month
FROM validated_data
    );
  
  
  
[0m12:22:13.495423 [debug] [Thread-2 (]: SQL status: OK in 525.384 seconds
[0m12:22:13.501597 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m12:22:13.501798 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__posts_created_at ON "dev"."main"."stg_stackoverflow__posts" (created_at)
      
[0m12:22:13.502617 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:22:13.503267 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m12:22:13.503405 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__posts_post_id ON "dev"."main"."stg_stackoverflow__posts" (post_id)
      
[0m12:22:13.504051 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:22:13.504603 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m12:22:13.504731 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        ANALYZE "dev"."main"."stg_stackoverflow__posts"
      
[0m12:22:19.639755 [debug] [Thread-2 (]: SQL status: OK in 6.135 seconds
[0m12:22:19.640274 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m12:22:19.640422 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m12:22:19.640540 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m12:29:58.637485 [debug] [Thread-1 (]: SQL status: OK in 990.527 seconds
[0m12:29:58.648598 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:29:58.648896 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: BEGIN
[0m12:29:58.649320 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:29:58.649464 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:29:58.649623 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_stackoverflow__comments__dbt_tmp20250518121328092626'
      
      
      order by ordinal_position

  
[0m12:29:58.655086 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:29:58.657485 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:29:58.657701 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_stackoverflow__comments'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'dev'
      
      order by ordinal_position

  
[0m12:29:58.660054 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:29:58.663338 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:29:58.663508 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_stackoverflow__comments'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'dev'
      
      order by ordinal_position

  
[0m12:29:58.664737 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:29:58.671556 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:29:58.672488 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:29:58.672663 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        
            delete from "dev"."main"."stg_stackoverflow__comments"
            where (
                comment_id) in (
                select (comment_id)
                from "stg_stackoverflow__comments__dbt_tmp20250518121328092626"
            );

        
    

    insert into "dev"."main"."stg_stackoverflow__comments" ("comment_id", "post_id", "user_id", "comment_text", "created_at", "created_at_month")
    (
        select "comment_id", "post_id", "user_id", "comment_text", "created_at", "created_at_month"
        from "stg_stackoverflow__comments__dbt_tmp20250518121328092626"
    )
  
[0m12:30:22.630881 [debug] [Thread-2 (]: SQL status: OK in 482.987 seconds
[0m12:30:22.634405 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: Close
[0m12:30:22.636957 [debug] [Thread-1 (]: SQL status: OK in 23.964 seconds
[0m12:30:22.638902 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:30:22.639231 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04a15cb-ba75-4af8-bfc4-ca1107f0f595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156e1cd0>]}
[0m12:30:22.639448 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_created_at ON "dev"."main"."stg_stackoverflow__comments" (created_at)
      
[0m12:30:22.639975 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model main.stg_stackoverflow__posts .......... [[32mOK[0m in 1014.57s]
[0m12:30:22.640435 [debug] [Thread-2 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m12:30:22.640688 [debug] [Thread-2 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m12:30:22.640958 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:30:22.641172 [info ] [Thread-2 (]: 3 of 3 START sql incremental model main.stg_stackoverflow__users ............... [RUN]
[0m12:30:22.641990 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:30:22.642201 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.stg_stackoverflow__posts, now model.stackoverflow_analysis_aw.stg_stackoverflow__users)
[0m12:30:22.642369 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_post_id ON "dev"."main"."stg_stackoverflow__comments" (post_id)
      
[0m12:30:22.642556 [debug] [Thread-2 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m12:30:22.644813 [debug] [Thread-2 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m12:30:22.645004 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:30:22.645687 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:30:22.645826 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        ANALYZE "dev"."main"."stg_stackoverflow__comments"
      
[0m12:30:22.646048 [debug] [Thread-2 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m12:30:22.647681 [debug] [Thread-2 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m12:30:22.648166 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m12:30:22.648296 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: BEGIN
[0m12:30:22.648423 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:30:22.648937 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:30:22.649067 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m12:30:22.649205 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__users"
  
    as (
      -- models/staging/stg_stackoverflow__users.sql


WITH source_data AS (
    SELECT *,
           ROW_NUMBER() OVER (ORDER BY CreationDate) as batch_id
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/users.parquet'
    
)
SELECT
    Id as user_id,
    DisplayName as display_name,
    CreationDate as created_at
FROM source_data
    );
  
  
  
[0m12:30:24.637202 [debug] [Thread-1 (]: SQL status: OK in 1.991 seconds
[0m12:30:24.637891 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m12:30:24.638054 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m12:30:24.638188 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m12:30:24.638411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:30:24.638742 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: Close
[0m12:30:24.639041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04a15cb-ba75-4af8-bfc4-ca1107f0f595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156ed180>]}
[0m12:30:24.639291 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model main.stg_stackoverflow__comments ....... [[32mOK[0m in 1016.57s]
[0m12:30:24.639514 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m12:31:13.214846 [debug] [Thread-2 (]: SQL status: OK in 50.565 seconds
[0m12:31:13.218954 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m12:31:13.219214 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__users_created_at ON "dev"."main"."stg_stackoverflow__users" (created_at)
      
[0m12:31:13.219978 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:31:13.220808 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m12:31:13.220966 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

        ANALYZE "dev"."main"."stg_stackoverflow__users"
      
[0m12:31:14.039429 [debug] [Thread-2 (]: SQL status: OK in 0.818 seconds
[0m12:31:14.040014 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: COMMIT
[0m12:31:14.040175 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m12:31:14.040294 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: COMMIT
[0m12:31:20.653703 [debug] [Thread-2 (]: SQL status: OK in 6.613 seconds
[0m12:31:20.655061 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: Close
[0m12:31:20.655741 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04a15cb-ba75-4af8-bfc4-ca1107f0f595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c1c4b0>]}
[0m12:31:20.656207 [info ] [Thread-2 (]: 3 of 3 OK created sql incremental model main.stg_stackoverflow__users .......... [[32mOK[0m in 58.01s]
[0m12:31:20.656472 [debug] [Thread-2 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m12:31:20.673213 [debug] [MainThread]: Using duckdb connection "master"
[0m12:31:20.673390 [debug] [MainThread]: On master: BEGIN
[0m12:31:20.673824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:20.675002 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:31:20.675181 [debug] [MainThread]: On master: COMMIT
[0m12:31:20.675307 [debug] [MainThread]: Using duckdb connection "master"
[0m12:31:20.675413 [debug] [MainThread]: On master: COMMIT
[0m12:31:20.675575 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:31:20.675696 [debug] [MainThread]: On master: Close
[0m12:31:20.675857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:20.675962 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__comments' was properly closed.
[0m12:31:20.676056 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__users' was properly closed.
[0m12:31:20.677164 [info ] [MainThread]: 
[0m12:31:20.677484 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 17 minutes and 52.73 seconds (1072.73s).
[0m12:31:20.679949 [debug] [MainThread]: Command end result
[0m12:31:20.708802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m12:31:20.728354 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m12:31:20.736490 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m12:31:20.736620 [info ] [MainThread]: 
[0m12:31:20.737082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:20.737197 [info ] [MainThread]: 
[0m12:31:20.737326 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:31:20.740407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1073.1174, "process_in_blocks": "0", "process_kernel_time": 44.25044, "process_mem_max_rss": "7922712576", "process_out_blocks": "0", "process_user_time": 613.29126}
[0m12:31:20.740620 [debug] [MainThread]: Command `dbt run` succeeded at 12:31:20.740586 after 1073.12 seconds
[0m12:31:20.741696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115044550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115302a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e39320>]}
[0m12:31:20.741908 [debug] [MainThread]: Flushing usage events
[0m12:31:21.692920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:50.444642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af69d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1cfed0>]}


============================== 12:45:50.447157 | 1a2fefb9-15f5-4099-b8c7-5c8509a468c5 ==============================
[0m12:45:50.447157 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:45:50.447426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intermediate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:50.535058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a2fefb9-15f5-4099-b8c7-5c8509a468c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3a1f30>]}
[0m12:45:50.559807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a2fefb9-15f5-4099-b8c7-5c8509a468c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bff4e20>]}
[0m12:45:50.562003 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:45:50.607869 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:45:50.679775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:50.679996 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:50.700781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a2fefb9-15f5-4099-b8c7-5c8509a468c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c27ac50>]}
[0m12:45:50.735903 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m12:45:50.737169 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m12:45:50.751392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a2fefb9-15f5-4099-b8c7-5c8509a468c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c417f20>]}
[0m12:45:50.751631 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m12:45:50.751773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a2fefb9-15f5-4099-b8c7-5c8509a468c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c87a190>]}
[0m12:45:50.752578 [info ] [MainThread]: 
[0m12:45:50.752725 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:45:50.752832 [info ] [MainThread]: 
[0m12:45:50.753044 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:45:50.754924 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:45:50.809584 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:45:50.809807 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:45:50.809939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:50.842977 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m12:45:50.843871 [debug] [ThreadPool]: On list_dev: Close
[0m12:45:50.844224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_intermediate)
[0m12:45:50.844425 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_intermediate"
"
[0m12:45:50.847606 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m12:45:50.847797 [debug] [ThreadPool]: On create_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:45:50.847916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:50.848694 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:45:50.849262 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m12:45:50.849392 [debug] [ThreadPool]: On create_dev_main_intermediate: BEGIN
[0m12:45:50.849553 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:45:50.849656 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m12:45:50.849761 [debug] [ThreadPool]: On create_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_intermediate"} */

    
    
        create schema if not exists "dev"."main_intermediate"
    
[0m12:45:50.849947 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:45:50.850302 [debug] [ThreadPool]: On create_dev_main_intermediate: COMMIT
[0m12:45:50.850421 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m12:45:50.850521 [debug] [ThreadPool]: On create_dev_main_intermediate: COMMIT
[0m12:45:50.850668 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:45:50.850777 [debug] [ThreadPool]: On create_dev_main_intermediate: Close
[0m12:45:50.851479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_intermediate, now list_dev_main)
[0m12:45:50.851725 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_marts'
[0m12:45:50.854086 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:45:50.855181 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m12:45:50.855332 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:45:50.855452 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m12:45:50.855564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:50.855676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:50.856287 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:45:50.856418 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:45:50.856569 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:45:50.857016 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:45:50.857149 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m12:45:50.857273 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m12:45:50.865455 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:45:50.865614 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m12:45:50.866254 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m12:45:50.866866 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:45:50.867790 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m12:45:50.868028 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:45:50.868162 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m12:45:50.868312 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:45:50.868588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_marts, now list_dev_main_intermediate)
[0m12:45:50.868778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_analysis)
[0m12:45:50.869673 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m12:45:50.870328 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m12:45:50.870456 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m12:45:50.870749 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m12:45:50.870866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:50.870978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:50.871533 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:45:50.871653 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m12:45:50.871785 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m12:45:50.872205 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:45:50.872316 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m12:45:50.872427 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m12:45:50.874638 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:45:50.875138 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m12:45:50.875285 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:45:50.875502 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m12:45:50.875626 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m12:45:50.876035 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m12:45:50.876319 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m12:45:50.876459 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m12:45:50.876757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a2fefb9-15f5-4099-b8c7-5c8509a468c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccd6750>]}
[0m12:45:50.876961 [debug] [MainThread]: Using duckdb connection "master"
[0m12:45:50.877073 [debug] [MainThread]: On master: BEGIN
[0m12:45:50.877179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:50.877682 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:45:50.877812 [debug] [MainThread]: On master: COMMIT
[0m12:45:50.877931 [debug] [MainThread]: Using duckdb connection "master"
[0m12:45:50.878045 [debug] [MainThread]: On master: COMMIT
[0m12:45:50.878197 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:45:50.878310 [debug] [MainThread]: On master: Close
[0m12:45:50.880069 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m12:45:50.880249 [debug] [Thread-2 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m12:45:50.880468 [info ] [Thread-1 (]: 1 of 3 START sql table model main_intermediate.int_stackoverflow__answer_timing  [RUN]
[0m12:45:50.880701 [info ] [Thread-2 (]: 2 of 3 START sql table model main_intermediate.int_stackoverflow__at_replies ... [RUN]
[0m12:45:50.880891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing)
[0m12:45:50.881048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now model.stackoverflow_analysis_aw.int_stackoverflow__at_replies)
[0m12:45:50.881214 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m12:45:50.881374 [debug] [Thread-2 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m12:45:50.884734 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m12:45:50.885992 [debug] [Thread-2 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m12:45:50.886608 [debug] [Thread-2 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m12:45:50.886763 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m12:45:50.900470 [debug] [Thread-2 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m12:45:50.901854 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m12:45:50.902556 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m12:45:50.902757 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m12:45:50.902908 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: BEGIN
[0m12:45:50.903052 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: BEGIN
[0m12:45:50.903218 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:50.903394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:50.904097 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:45:50.904237 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m12:45:50.904411 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__at_replies__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__at_replies.sql


WITH question_authors AS (
    SELECT 
        post_id,
        owner_user_id as author_id
    FROM "dev"."main"."stg_stackoverflow__posts"
    WHERE post_type_id = 1  -- Questions only
)

SELECT
    c.comment_id,
    c.post_id,
    c.comment_text,
    c.user_id,
    c.created_at as comment_date,
    qa.author_id as question_author_id
FROM "dev"."main"."stg_stackoverflow__comments" c
INNER JOIN question_authors qa 
    ON c.post_id = qa.post_id
WHERE c.comment_text LIKE '@%'  -- Comments with @mentions
  AND c.user_id = qa.author_id  -- Comment made by question author
    );
  
  
[0m12:45:50.904857 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:45:50.905102 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__at_replies__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__at_replies.sql


WITH question_authors AS (
    SELECT 
        post_id,
        owner_user_id as author_id
    FROM "dev"."main"."stg_stackoverflow__posts"
    WHERE post_type_id = 1  -- Questions only
)

SELECT
    c.comment_id,
    c.post_id,
    c.comment_text,
    c.user_id,
    c.created_at as comment_date,
    qa.author_id as question_author_id
FROM "dev"."main"."stg_stackoverflow__comments" c
INNER JOIN question_authors qa 
    ON c.post_id = qa.post_id
WHERE c.comment_text LIKE '@%'  -- Comments with @mentions
  AND c.user_id = qa.author_id  -- Comment made by question author
    );
  
  
[0m12:45:50.905273 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m12:45:50.905427 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:45:50.905600 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__answer_timing.sql


WITH answer_timing AS (
    SELECT 
        q.post_id as question_id,
        q.created_at as question_date,
        a.created_at as answer_date,
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL
        AND DATEDIFF('minute', q.created_at, a.created_at) >= 0  -- Filter out negative times
)

SELECT 
    question_id,
    question_date,
    answer_date,
    minutes_to_answer,
    CASE 
        WHEN minutes_to_answer < 15 THEN 'Very Fast (<15 mins)'
        WHEN minutes_to_answer < 60 THEN 'Fast (15-60 mins)'
        WHEN minutes_to_answer < 480 THEN 'Same Day (1-8 hours)'
        WHEN minutes_to_answer < 1440 THEN 'Next Day (<24 hours)'
        WHEN minutes_to_answer < 7200 THEN 'Within 5 Days'
        ELSE 'More than 5 Days'
    END as response_time_band
    );
  
  
[0m12:45:50.905838 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: ROLLBACK
[0m12:45:50.906585 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__answer_timing.sql


WITH answer_timing AS (
    SELECT 
        q.post_id as question_id,
        q.created_at as question_date,
        a.created_at as answer_date,
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL
        AND DATEDIFF('minute', q.created_at, a.created_at) >= 0  -- Filter out negative times
)

SELECT 
    question_id,
    question_date,
    answer_date,
    minutes_to_answer,
    CASE 
        WHEN minutes_to_answer < 15 THEN 'Very Fast (<15 mins)'
        WHEN minutes_to_answer < 60 THEN 'Fast (15-60 mins)'
        WHEN minutes_to_answer < 480 THEN 'Same Day (1-8 hours)'
        WHEN minutes_to_answer < 1440 THEN 'Next Day (<24 hours)'
        WHEN minutes_to_answer < 7200 THEN 'Within 5 Days'
        ELSE 'More than 5 Days'
    END as response_time_band
    );
  
  
[0m12:45:50.906781 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:45:50.906978 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: ROLLBACK
[0m12:45:50.913618 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing'
[0m12:45:50.914106 [debug] [Thread-2 (]: Failed to rollback 'model.stackoverflow_analysis_aw.int_stackoverflow__at_replies'
[0m12:45:50.914260 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: Close
[0m12:45:50.914411 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: Close
[0m12:45:50.917567 [debug] [Thread-1 (]: Runtime Error in model int_stackoverflow__answer_timing (models/intermediate/int_stackoverflow__answer_timing.sql)
  Binder Error: Referenced column "question_id" not found in FROM clause!
  
  LINE 29:     question_id,
               ^
[0m12:45:50.917983 [debug] [Thread-2 (]: Runtime Error in model int_stackoverflow__at_replies (models/intermediate/int_stackoverflow__at_replies.sql)
  Binder Error: Referenced column "post_type_id" not found in FROM clause!
  Candidate bindings: "post_id", "comment_id", "user_id", "created_at"
  
  LINE 19:     WHERE post_type_id = 1  -- Questions only
                     ^
[0m12:45:50.919060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2fefb9-15f5-4099-b8c7-5c8509a468c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce1a90>]}
[0m12:45:50.919208 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2fefb9-15f5-4099-b8c7-5c8509a468c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccecf70>]}
[0m12:45:50.919506 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model main_intermediate.int_stackoverflow__answer_timing  [[31mERROR[0m in 0.04s]
[0m12:45:50.919794 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model main_intermediate.int_stackoverflow__at_replies  [[31mERROR[0m in 0.04s]
[0m12:45:50.920048 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m12:45:50.920255 [debug] [Thread-2 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m12:45:50.920426 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m12:45:50.920631 [debug] [Thread-5 (]: Marking all children of 'model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing' to be skipped because of status 'error'.  Reason: Runtime Error in model int_stackoverflow__answer_timing (models/intermediate/int_stackoverflow__answer_timing.sql)
  Binder Error: Referenced column "question_id" not found in FROM clause!
  
  LINE 29:     question_id,
               ^.
[0m12:45:50.920842 [info ] [Thread-1 (]: 3 of 3 START sql table model main_intermediate.int_stackoverflow__question_views  [RUN]
[0m12:45:50.921332 [debug] [Thread-5 (]: Marking all children of 'model.stackoverflow_analysis_aw.int_stackoverflow__at_replies' to be skipped because of status 'error'.  Reason: Runtime Error in model int_stackoverflow__at_replies (models/intermediate/int_stackoverflow__at_replies.sql)
  Binder Error: Referenced column "post_type_id" not found in FROM clause!
  Candidate bindings: "post_id", "comment_id", "user_id", "created_at"
  
  LINE 19:     WHERE post_type_id = 1  -- Questions only
                     ^.
[0m12:45:50.921518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing, now model.stackoverflow_analysis_aw.int_stackoverflow__question_views)
[0m12:45:50.921705 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m12:45:50.922942 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m12:45:50.923319 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m12:45:50.924361 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m12:45:50.924686 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m12:45:50.924828 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: BEGIN
[0m12:45:50.924952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:50.925608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:45:50.925744 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m12:45:50.925882 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__question_views__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__question_views.sql


SELECT
    owner_user_id,
    COUNT(*) as total_questions,
    SUM(view_count) as total_views,
    ROUND(AVG(view_count), 2) as avg_views_per_question
FROM "dev"."main"."stg_stackoverflow__posts"
WHERE post_type_id = 1  -- Questions only
  AND owner_user_id IS NOT NULL
GROUP BY owner_user_id
    );
  
  
[0m12:45:50.926323 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__question_views__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__question_views.sql


SELECT
    owner_user_id,
    COUNT(*) as total_questions,
    SUM(view_count) as total_views,
    ROUND(AVG(view_count), 2) as avg_views_per_question
FROM "dev"."main"."stg_stackoverflow__posts"
WHERE post_type_id = 1  -- Questions only
  AND owner_user_id IS NOT NULL
GROUP BY owner_user_id
    );
  
  
[0m12:45:50.926472 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:45:50.926650 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: ROLLBACK
[0m12:45:50.928643 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.int_stackoverflow__question_views'
[0m12:45:50.928784 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: Close
[0m12:45:50.930404 [debug] [Thread-1 (]: Runtime Error in model int_stackoverflow__question_views (models/intermediate/int_stackoverflow__question_views.sql)
  Binder Error: Referenced column "post_type_id" not found in FROM clause!
  Candidate bindings: "post_id", "comment_id", "user_id", "created_at"
  
  LINE 20: WHERE post_type_id = 1  -- Questions only
                 ^
[0m12:45:50.930577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2fefb9-15f5-4099-b8c7-5c8509a468c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ba530>]}
[0m12:45:50.930821 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model main_intermediate.int_stackoverflow__question_views  [[31mERROR[0m in 0.01s]
[0m12:45:50.931039 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m12:45:50.931231 [debug] [Thread-5 (]: Marking all children of 'model.stackoverflow_analysis_aw.int_stackoverflow__question_views' to be skipped because of status 'error'.  Reason: Runtime Error in model int_stackoverflow__question_views (models/intermediate/int_stackoverflow__question_views.sql)
  Binder Error: Referenced column "post_type_id" not found in FROM clause!
  Candidate bindings: "post_id", "comment_id", "user_id", "created_at"
  
  LINE 20: WHERE post_type_id = 1  -- Questions only
                 ^.
[0m12:45:50.931783 [debug] [MainThread]: Using duckdb connection "master"
[0m12:45:50.931903 [debug] [MainThread]: On master: BEGIN
[0m12:45:50.932006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:50.932535 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:45:50.932659 [debug] [MainThread]: On master: COMMIT
[0m12:45:50.932766 [debug] [MainThread]: Using duckdb connection "master"
[0m12:45:50.932864 [debug] [MainThread]: On master: COMMIT
[0m12:45:50.933023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:45:50.933141 [debug] [MainThread]: On master: Close
[0m12:45:50.933282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:50.933394 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.int_stackoverflow__question_views' was properly closed.
[0m12:45:50.933491 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.int_stackoverflow__at_replies' was properly closed.
[0m12:45:50.933619 [info ] [MainThread]: 
[0m12:45:50.933742 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:45:50.934093 [debug] [MainThread]: Command end result
[0m12:45:50.949905 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m12:45:50.950997 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m12:45:50.954121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m12:45:50.954296 [info ] [MainThread]: 
[0m12:45:50.954458 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:45:50.954579 [info ] [MainThread]: 
[0m12:45:50.954760 [error] [MainThread]:   Runtime Error in model int_stackoverflow__answer_timing (models/intermediate/int_stackoverflow__answer_timing.sql)
  Binder Error: Referenced column "question_id" not found in FROM clause!
  
  LINE 29:     question_id,
               ^
[0m12:45:50.954911 [info ] [MainThread]: 
[0m12:45:50.955134 [error] [MainThread]:   Runtime Error in model int_stackoverflow__at_replies (models/intermediate/int_stackoverflow__at_replies.sql)
  Binder Error: Referenced column "post_type_id" not found in FROM clause!
  Candidate bindings: "post_id", "comment_id", "user_id", "created_at"
  
  LINE 19:     WHERE post_type_id = 1  -- Questions only
                     ^
[0m12:45:50.955268 [info ] [MainThread]: 
[0m12:45:50.955425 [error] [MainThread]:   Runtime Error in model int_stackoverflow__question_views (models/intermediate/int_stackoverflow__question_views.sql)
  Binder Error: Referenced column "post_type_id" not found in FROM clause!
  Candidate bindings: "post_id", "comment_id", "user_id", "created_at"
  
  LINE 20: WHERE post_type_id = 1  -- Questions only
                 ^
[0m12:45:50.955538 [info ] [MainThread]: 
[0m12:45:50.955671 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m12:45:50.957090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5449303, "process_in_blocks": "0", "process_kernel_time": 0.231258, "process_mem_max_rss": "155271168", "process_out_blocks": "0", "process_user_time": 1.005748}
[0m12:45:50.957295 [debug] [MainThread]: Command `dbt run` failed at 12:45:50.957256 after 0.55 seconds
[0m12:45:50.957460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2c37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2d4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c239320>]}
[0m12:45:50.957603 [debug] [MainThread]: Flushing usage events
[0m12:45:51.852605 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:48.830029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105119d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cfd90>]}


============================== 13:35:48.832524 | 5e1de698-61a1-483d-868b-ccd71e88885a ==============================
[0m13:35:48.832524 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:35:48.832823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:35:48.926243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e1de698-61a1-483d-868b-ccd71e88885a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a1f30>]}
[0m13:35:48.947989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e1de698-61a1-483d-868b-ccd71e88885a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f8e20>]}
[0m13:35:48.949875 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:35:48.994757 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:35:49.033121 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:35:49.033359 [debug] [MainThread]: previous checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m13:35:49.033524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e1de698-61a1-483d-868b-ccd71e88885a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5f050>]}
[0m13:35:49.517284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e1de698-61a1-483d-868b-ccd71e88885a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b54410>]}
[0m13:35:49.548337 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m13:35:49.549652 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m13:35:49.566302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e1de698-61a1-483d-868b-ccd71e88885a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df6350>]}
[0m13:35:49.566525 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m13:35:49.566662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e1de698-61a1-483d-868b-ccd71e88885a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cb110>]}
[0m13:35:49.567477 [info ] [MainThread]: 
[0m13:35:49.567608 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:35:49.567715 [info ] [MainThread]: 
[0m13:35:49.567899 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:35:49.569884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_intermediate'
[0m13:35:49.573729 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_marts'
[0m13:35:49.620864 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m13:35:49.621113 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m13:35:49.621283 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m13:35:49.621446 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m13:35:49.621579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:49.621699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:49.649363 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m13:35:49.649593 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m13:35:49.649727 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m13:35:49.650203 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m13:35:49.650354 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m13:35:49.650476 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m13:35:49.658019 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:35:49.658208 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:35:49.658888 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m13:35:49.659434 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m13:35:49.660036 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m13:35:49.660223 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m13:35:49.660458 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m13:35:49.660626 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m13:35:49.660877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now list_dev_main)
[0m13:35:49.661708 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:35:49.661932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_marts, now list_dev_main_analysis)
[0m13:35:49.662085 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:35:49.662817 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m13:35:49.662954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:49.663073 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m13:35:49.663267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:49.663799 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:49.663934 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:35:49.664057 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:35:49.664537 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:49.664673 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m13:35:49.664794 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m13:35:49.667105 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:35:49.667703 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:35:49.667878 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:35:49.668131 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:35:49.668332 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:35:49.668841 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m13:35:49.669107 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m13:35:49.669314 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m13:35:49.669668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e1de698-61a1-483d-868b-ccd71e88885a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716b290>]}
[0m13:35:49.669897 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:49.670018 [debug] [MainThread]: On master: BEGIN
[0m13:35:49.670132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:49.670706 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:49.670827 [debug] [MainThread]: On master: COMMIT
[0m13:35:49.670938 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:49.671045 [debug] [MainThread]: On master: COMMIT
[0m13:35:49.671215 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:49.671322 [debug] [MainThread]: On master: Close
[0m13:35:49.672624 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m13:35:49.672809 [debug] [Thread-2 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m13:35:49.672971 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 .. [RUN]
[0m13:35:49.673188 [info ] [Thread-2 (]: 2 of 9 START test not_null_stg_stackoverflow__posts_created_at ................. [RUN]
[0m13:35:49.673879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96)
[0m13:35:49.674098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf)
[0m13:35:49.674270 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m13:35:49.674436 [debug] [Thread-2 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m13:35:49.678402 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m13:35:49.682460 [debug] [Thread-2 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m13:35:49.683070 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m13:35:49.683232 [debug] [Thread-2 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m13:35:49.689506 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m13:35:49.690532 [debug] [Thread-2 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m13:35:49.691177 [debug] [Thread-2 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m13:35:49.691375 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m13:35:49.691533 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: BEGIN
[0m13:35:49.691679 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: BEGIN
[0m13:35:49.691828 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:35:49.691968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:49.692646 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:35:49.692795 [debug] [Thread-2 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"
[0m13:35:49.692977 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select created_at
from "dev"."main"."stg_stackoverflow__posts"
where created_at is null



      
    ) dbt_internal_test
[0m13:35:49.693454 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:49.693596 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"
[0m13:35:49.693736 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        post_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_stackoverflow__posts"
    group by post_type_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m13:35:49.694770 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select created_at
from "dev"."main"."stg_stackoverflow__posts"
where created_at is null



      
    ) dbt_internal_test
[0m13:35:49.694924 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:49.695103 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: ROLLBACK
[0m13:35:49.695735 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        post_type_id as value_field,
        count(*) as n_records

    from "dev"."main"."stg_stackoverflow__posts"
    group by post_type_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m13:35:49.695904 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:49.696119 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: ROLLBACK
[0m13:35:49.700917 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96'
[0m13:35:49.701186 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96: Close
[0m13:35:49.701591 [debug] [Thread-2 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf'
[0m13:35:49.701755 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf: Close
[0m13:35:49.703894 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 17:     from "dev"."main"."stg_stackoverflow__posts"
                    ^
[0m13:35:49.704114 [error] [Thread-1 (]: 1 of 9 ERROR accepted_values_stg_stackoverflow__posts_post_type_id__1__2 ....... [[31mERROR[0m in 0.03s]
[0m13:35:49.704415 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96
[0m13:35:49.704571 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m13:35:49.704769 [debug] [Thread-5 (]: Marking all children of 'test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96' to be skipped because of status 'error'.  Reason: Runtime Error in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 17:     from "dev"."main"."stg_stackoverflow__posts"
                    ^.
[0m13:35:49.704930 [info ] [Thread-1 (]: 3 of 9 START test not_null_stg_stackoverflow__posts_post_id .................... [RUN]
[0m13:35:49.706455 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.706654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.accepted_values_stg_stackoverflow__posts_post_type_id__1__2.f9aa30ef96, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba)
[0m13:35:49.706866 [error] [Thread-2 (]: 2 of 9 ERROR not_null_stg_stackoverflow__posts_created_at ...................... [[31mERROR[0m in 0.03s]
[0m13:35:49.707038 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m13:35:49.707249 [debug] [Thread-2 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf
[0m13:35:49.709135 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m13:35:49.709320 [debug] [Thread-2 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m13:35:49.709512 [debug] [Thread-5 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m13:35:49.709683 [info ] [Thread-2 (]: 4 of 9 START test not_null_stg_stackoverflow__posts_post_type_id ............... [RUN]
[0m13:35:49.709970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_created_at.d8a5c22baf, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3)
[0m13:35:49.710121 [debug] [Thread-2 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m13:35:49.711609 [debug] [Thread-2 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m13:35:49.711773 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m13:35:49.712654 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m13:35:49.712906 [debug] [Thread-2 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m13:35:49.713976 [debug] [Thread-2 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m13:35:49.714263 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m13:35:49.714415 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: BEGIN
[0m13:35:49.714542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:49.714695 [debug] [Thread-2 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m13:35:49.714913 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: BEGIN
[0m13:35:49.715047 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:35:49.715526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:49.715657 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"
[0m13:35:49.715817 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."main"."stg_stackoverflow__posts"
where post_id is null



      
    ) dbt_internal_test
[0m13:35:49.716331 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:35:49.716467 [debug] [Thread-2 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"
[0m13:35:49.716601 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_type_id
from "dev"."main"."stg_stackoverflow__posts"
where post_type_id is null



      
    ) dbt_internal_test
[0m13:35:49.717560 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."main"."stg_stackoverflow__posts"
where post_id is null



      
    ) dbt_internal_test
[0m13:35:49.717701 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:49.717864 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: ROLLBACK
[0m13:35:49.718470 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_type_id
from "dev"."main"."stg_stackoverflow__posts"
where post_type_id is null



      
    ) dbt_internal_test
[0m13:35:49.718614 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:49.718769 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: ROLLBACK
[0m13:35:49.720575 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba'
[0m13:35:49.720710 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba: Close
[0m13:35:49.722350 [debug] [Thread-2 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3'
[0m13:35:49.722490 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3: Close
[0m13:35:49.724414 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_stackoverflow__posts_post_type_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.724643 [error] [Thread-2 (]: 4 of 9 ERROR not_null_stg_stackoverflow__posts_post_type_id .................... [[31mERROR[0m in 0.01s]
[0m13:35:49.725733 [debug] [Thread-2 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3
[0m13:35:49.726062 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.726228 [debug] [Thread-2 (]: Began running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m13:35:49.726408 [debug] [Thread-5 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_post_type_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m13:35:49.726583 [error] [Thread-1 (]: 3 of 9 ERROR not_null_stg_stackoverflow__posts_post_id ......................... [[31mERROR[0m in 0.02s]
[0m13:35:49.726760 [info ] [Thread-2 (]: 5 of 9 START test not_null_stg_stackoverflow__posts_view_count ................. [RUN]
[0m13:35:49.727074 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba
[0m13:35:49.727257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_type_id.2fdd0c0fe3, now test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653)
[0m13:35:49.727422 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m13:35:49.727564 [debug] [Thread-2 (]: Began compiling node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m13:35:49.727734 [debug] [Thread-5 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m13:35:49.729875 [debug] [Thread-2 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m13:35:49.727891 [info ] [Thread-1 (]: 6 of 9 START test positive_value_stg_stackoverflow__posts_view_count ........... [RUN]
[0m13:35:49.730256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_post_id.45e0e770ba, now test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35)
[0m13:35:49.730415 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m13:35:49.731992 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m13:35:49.732256 [debug] [Thread-2 (]: Began executing node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m13:35:49.733442 [debug] [Thread-2 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m13:35:49.733688 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m13:35:49.734487 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m13:35:49.734755 [debug] [Thread-2 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m13:35:49.734902 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: BEGIN
[0m13:35:49.735027 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:35:49.735176 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m13:35:49.735389 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: BEGIN
[0m13:35:49.735519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:49.736008 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:35:49.736137 [debug] [Thread-2 (]: Using duckdb connection "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"
[0m13:35:49.736281 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "dev"."main"."stg_stackoverflow__posts"
where view_count is null



      
    ) dbt_internal_test
[0m13:35:49.736723 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:49.736857 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"
[0m13:35:49.736987 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main"."stg_stackoverflow__posts"
where view_count < 0


      
    ) dbt_internal_test
[0m13:35:49.737976 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "dev"."main"."stg_stackoverflow__posts"
where view_count is null



      
    ) dbt_internal_test
[0m13:35:49.738136 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:49.738304 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: ROLLBACK
[0m13:35:49.738908 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main"."stg_stackoverflow__posts"
where view_count < 0


      
    ) dbt_internal_test
[0m13:35:49.739062 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:49.739237 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: ROLLBACK
[0m13:35:49.741058 [debug] [Thread-2 (]: Failed to rollback 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653'
[0m13:35:49.741195 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653: Close
[0m13:35:49.742343 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35'
[0m13:35:49.742915 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35: Close
[0m13:35:49.744525 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.744725 [error] [Thread-2 (]: 5 of 9 ERROR not_null_stg_stackoverflow__posts_view_count ...................... [[31mERROR[0m in 0.02s]
[0m13:35:49.744947 [debug] [Thread-2 (]: Finished running node test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653
[0m13:35:49.745105 [debug] [Thread-2 (]: Began running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m13:35:49.745287 [debug] [Thread-5 (]: Marking all children of 'test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m13:35:49.745443 [info ] [Thread-2 (]: 7 of 9 START test unique_stg_stackoverflow__posts_post_id ...................... [RUN]
[0m13:35:49.746732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.not_null_stg_stackoverflow__posts_view_count.1cc54ce653, now test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed)
[0m13:35:49.746973 [debug] [Thread-2 (]: Began compiling node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m13:35:49.747310 [debug] [Thread-1 (]: Runtime Error in test positive_value_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.750264 [debug] [Thread-2 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m13:35:49.750510 [error] [Thread-1 (]: 6 of 9 ERROR positive_value_stg_stackoverflow__posts_view_count ................ [[31mERROR[0m in 0.02s]
[0m13:35:49.750817 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35
[0m13:35:49.750999 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285
[0m13:35:49.751198 [debug] [Thread-5 (]: Marking all children of 'test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35' to be skipped because of status 'error'.  Reason: Runtime Error in test positive_value_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m13:35:49.751366 [info ] [Thread-1 (]: 8 of 9 START test valid_id_range_stg_stackoverflow__posts_post_id .............. [RUN]
[0m13:35:49.751665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.positive_value_stg_stackoverflow__posts_view_count.47b481cf35, now test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285)
[0m13:35:49.751822 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285
[0m13:35:49.753405 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285"
[0m13:35:49.753572 [debug] [Thread-2 (]: Began executing node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m13:35:49.754388 [debug] [Thread-2 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m13:35:49.754624 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285
[0m13:35:49.757321 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285"
[0m13:35:49.757619 [debug] [Thread-2 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m13:35:49.757761 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: BEGIN
[0m13:35:49.757902 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:35:49.758135 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285"
[0m13:35:49.758268 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285: BEGIN
[0m13:35:49.758400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:49.758856 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:35:49.758996 [debug] [Thread-2 (]: Using duckdb connection "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"
[0m13:35:49.759132 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_stackoverflow__posts"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:35:49.759581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:49.759719 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285"
[0m13:35:49.759858 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with unusual_ids as (
    select 
        post_id as id_value,
        case
            when post_id < 0 then 'negative_id'
            when post_id > 100000000 then 'suspiciously_high_id'
            else 'valid_id'
        end as issue_type
    from "dev"."main"."stg_stackoverflow__posts"
    where post_id < 0  -- catch negative IDs
       or post_id > 100000000  -- catch suspiciously high IDs
)

select *
from unusual_ids
where issue_type != 'valid_id'


      
    ) dbt_internal_test
[0m13:35:49.760834 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_stackoverflow__posts"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:35:49.760986 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:49.761150 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: ROLLBACK
[0m13:35:49.761749 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with unusual_ids as (
    select 
        post_id as id_value,
        case
            when post_id < 0 then 'negative_id'
            when post_id > 100000000 then 'suspiciously_high_id'
            else 'valid_id'
        end as issue_type
    from "dev"."main"."stg_stackoverflow__posts"
    where post_id < 0  -- catch negative IDs
       or post_id > 100000000  -- catch suspiciously high IDs
)

select *
from unusual_ids
where issue_type != 'valid_id'


      
    ) dbt_internal_test
[0m13:35:49.761904 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:49.762065 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285: ROLLBACK
[0m13:35:49.765354 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285'
[0m13:35:49.765842 [debug] [Thread-2 (]: Failed to rollback 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed'
[0m13:35:49.766003 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285: Close
[0m13:35:49.766162 [debug] [Thread-2 (]: On test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed: Close
[0m13:35:49.769257 [debug] [Thread-1 (]: Runtime Error in test valid_id_range_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 17:     from "dev"."main"."stg_stackoverflow__posts"
                    ^
[0m13:35:49.769595 [debug] [Thread-2 (]: Runtime Error in test unique_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.769810 [error] [Thread-1 (]: 8 of 9 ERROR valid_id_range_stg_stackoverflow__posts_post_id ................... [[31mERROR[0m in 0.02s]
[0m13:35:49.770028 [error] [Thread-2 (]: 7 of 9 ERROR unique_stg_stackoverflow__posts_post_id ........................... [[31mERROR[0m in 0.02s]
[0m13:35:49.770383 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285
[0m13:35:49.770607 [debug] [Thread-2 (]: Finished running node test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed
[0m13:35:49.770770 [debug] [Thread-1 (]: Began running node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m13:35:49.770986 [debug] [Thread-5 (]: Marking all children of 'test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285' to be skipped because of status 'error'.  Reason: Runtime Error in test valid_id_range_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 17:     from "dev"."main"."stg_stackoverflow__posts"
                    ^.
[0m13:35:49.771183 [info ] [Thread-1 (]: 9 of 9 START test valid_timestamp_stg_stackoverflow__posts_created_at .......... [RUN]
[0m13:35:49.771454 [debug] [Thread-5 (]: Marking all children of 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m13:35:49.771681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stackoverflow_analysis_aw.valid_id_range_stg_stackoverflow__posts_post_id.6192408285, now test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe)
[0m13:35:49.771880 [debug] [Thread-1 (]: Began compiling node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m13:35:49.773643 [debug] [Thread-1 (]: Writing injected SQL for node "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m13:35:49.774069 [debug] [Thread-1 (]: Began executing node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m13:35:49.774925 [debug] [Thread-1 (]: Writing runtime sql for node "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m13:35:49.775325 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m13:35:49.775485 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: BEGIN
[0m13:35:49.775619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:49.776216 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:49.776354 [debug] [Thread-1 (]: Using duckdb connection "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"
[0m13:35:49.776504 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main"."stg_stackoverflow__posts"
where created_at > CURRENT_TIMESTAMP
  or created_at < '2008-01-01'


      
    ) dbt_internal_test
[0m13:35:49.778367 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select *
from "dev"."main"."stg_stackoverflow__posts"
where created_at > CURRENT_TIMESTAMP
  or created_at < '2008-01-01'


      
    ) dbt_internal_test
[0m13:35:49.778516 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:49.778684 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: ROLLBACK
[0m13:35:49.780594 [debug] [Thread-1 (]: Failed to rollback 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe'
[0m13:35:49.780769 [debug] [Thread-1 (]: On test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe: Close
[0m13:35:49.782671 [debug] [Thread-1 (]: Runtime Error in test valid_timestamp_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.782915 [error] [Thread-1 (]: 9 of 9 ERROR valid_timestamp_stg_stackoverflow__posts_created_at ............... [[31mERROR[0m in 0.01s]
[0m13:35:49.783139 [debug] [Thread-1 (]: Finished running node test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe
[0m13:35:49.783381 [debug] [Thread-5 (]: Marking all children of 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe' to be skipped because of status 'error'.  Reason: Runtime Error in test valid_timestamp_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^.
[0m13:35:49.783951 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:49.784067 [debug] [MainThread]: On master: BEGIN
[0m13:35:49.784166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:49.784752 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:49.784858 [debug] [MainThread]: On master: COMMIT
[0m13:35:49.784959 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:49.785054 [debug] [MainThread]: On master: COMMIT
[0m13:35:49.785224 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:49.785366 [debug] [MainThread]: On master: Close
[0m13:35:49.785522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:49.785627 [debug] [MainThread]: Connection 'test.stackoverflow_analysis_aw.valid_timestamp_stg_stackoverflow__posts_created_at.c1f4563fbe' was properly closed.
[0m13:35:49.785726 [debug] [MainThread]: Connection 'test.stackoverflow_analysis_aw.unique_stg_stackoverflow__posts_post_id.f1b80246ed' was properly closed.
[0m13:35:49.785848 [info ] [MainThread]: 
[0m13:35:49.785981 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m13:35:49.786775 [debug] [MainThread]: Command end result
[0m13:35:49.797268 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m13:35:49.798425 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m13:35:49.801591 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m13:35:49.801741 [info ] [MainThread]: 
[0m13:35:49.801894 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m13:35:49.802008 [info ] [MainThread]: 
[0m13:35:49.802169 [error] [MainThread]:   Runtime Error in test accepted_values_stg_stackoverflow__posts_post_type_id__1__2 (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 17:     from "dev"."main"."stg_stackoverflow__posts"
                    ^
[0m13:35:49.802308 [info ] [MainThread]: 
[0m13:35:49.802446 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.802595 [info ] [MainThread]: 
[0m13:35:49.802776 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_post_type_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.802933 [info ] [MainThread]: 
[0m13:35:49.803103 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.803218 [info ] [MainThread]: 
[0m13:35:49.803382 [error] [MainThread]:   Runtime Error in test not_null_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 14: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.803533 [info ] [MainThread]: 
[0m13:35:49.803685 [error] [MainThread]:   Runtime Error in test positive_value_stg_stackoverflow__posts_view_count (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.803812 [info ] [MainThread]: 
[0m13:35:49.803979 [error] [MainThread]:   Runtime Error in test valid_id_range_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 17:     from "dev"."main"."stg_stackoverflow__posts"
                    ^
[0m13:35:49.804085 [info ] [MainThread]: 
[0m13:35:49.804230 [error] [MainThread]:   Runtime Error in test unique_stg_stackoverflow__posts_post_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 15: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.804339 [info ] [MainThread]: 
[0m13:35:49.804459 [error] [MainThread]:   Runtime Error in test valid_timestamp_stg_stackoverflow__posts_created_at (models/staging/schema.yml)
  Catalog Error: Table with name stg_stackoverflow__posts does not exist!
  Did you mean "sqlite_temp_master"?
  
  LINE 10: from "dev"."main"."stg_stackoverflow__posts"
                ^
[0m13:35:49.804566 [info ] [MainThread]: 
[0m13:35:49.804720 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=9 SKIP=0 TOTAL=9
[0m13:35:49.806181 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.0073835, "process_in_blocks": "0", "process_kernel_time": 0.240851, "process_mem_max_rss": "156680192", "process_out_blocks": "0", "process_user_time": 1.521972}
[0m13:35:49.806368 [debug] [MainThread]: Command `cli test` failed at 13:35:49.806330 after 1.01 seconds
[0m13:35:49.806513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107964eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107965270>]}
[0m13:35:49.806646 [debug] [MainThread]: Flushing usage events
[0m13:35:50.778919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:50.930031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe7ed0>]}


============================== 13:44:50.932039 | 78893f87-fdd6-43ab-b011-b4124710aee6 ==============================
[0m13:44:50.932039 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:44:50.932308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/yuejwang/.dbt', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stackoverflow__posts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:44:51.014674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78893f87-fdd6-43ab-b011-b4124710aee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b9f30>]}
[0m13:44:51.035638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78893f87-fdd6-43ab-b011-b4124710aee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f10e20>]}
[0m13:44:51.037315 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:44:51.079735 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:44:51.140987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:51.141220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:51.162020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78893f87-fdd6-43ab-b011-b4124710aee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109092c50>]}
[0m13:44:51.199531 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m13:44:51.200752 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m13:44:51.210224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78893f87-fdd6-43ab-b011-b4124710aee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922ff20>]}
[0m13:44:51.210479 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m13:44:51.210626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78893f87-fdd6-43ab-b011-b4124710aee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10958e510>]}
[0m13:44:51.211423 [info ] [MainThread]: 
[0m13:44:51.211573 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:44:51.211681 [info ] [MainThread]: 
[0m13:44:51.211889 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:44:51.212264 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:44:51.265001 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:44:51.265245 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:44:51.265391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:51.297750 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m13:44:51.298499 [debug] [ThreadPool]: On list_dev: Close
[0m13:44:51.298830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:44:51.299034 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:44:51.302712 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:44:51.302937 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:44:51.303065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:51.303823 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:44:51.304429 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:44:51.304556 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:44:51.304719 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:44:51.304826 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:44:51.304934 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:44:51.305118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:44:51.305461 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:44:51.305590 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:44:51.305692 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:44:51.305843 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:44:51.305957 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:44:51.308572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:44:51.308848 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_analysis'
[0m13:44:51.311654 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:44:51.312418 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m13:44:51.312594 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:44:51.312727 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m13:44:51.312844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:51.312965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:51.313614 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:44:51.313797 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:44:51.313970 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:44:51.314414 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:44:51.314550 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m13:44:51.314688 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m13:44:51.322771 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:44:51.322953 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m13:44:51.323573 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m13:44:51.324191 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:44:51.324823 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:44:51.325067 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m13:44:51.325204 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:44:51.325329 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m13:44:51.325564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_marts)
[0m13:44:51.326501 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m13:44:51.326725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_intermediate)
[0m13:44:51.326887 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m13:44:51.327779 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m13:44:51.327923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:51.328048 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m13:44:51.328233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:51.328782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:44:51.328912 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m13:44:51.329064 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m13:44:51.329521 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:44:51.329659 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m13:44:51.329793 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m13:44:51.332049 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:44:51.332601 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m13:44:51.332836 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m13:44:51.332961 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:44:51.333083 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m13:44:51.333556 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m13:44:51.333864 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m13:44:51.334001 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m13:44:51.334295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78893f87-fdd6-43ab-b011-b4124710aee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ea750>]}
[0m13:44:51.334519 [debug] [MainThread]: Using duckdb connection "master"
[0m13:44:51.334645 [debug] [MainThread]: On master: BEGIN
[0m13:44:51.334758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:51.335248 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:44:51.335378 [debug] [MainThread]: On master: COMMIT
[0m13:44:51.335492 [debug] [MainThread]: Using duckdb connection "master"
[0m13:44:51.335600 [debug] [MainThread]: On master: COMMIT
[0m13:44:51.335769 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:44:51.335898 [debug] [MainThread]: On master: Close
[0m13:44:51.337120 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m13:44:51.337367 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__posts ............... [RUN]
[0m13:44:51.337561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_marts, now model.stackoverflow_analysis_aw.stg_stackoverflow__posts)
[0m13:44:51.337707 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m13:44:51.343987 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m13:44:51.345219 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m13:44:51.368866 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m13:44:51.369125 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

    
  
    
    

    create temporary table
      "stg_stackoverflow__posts__dbt_tmp20250518134451359334"
  
    as (
      -- models/staging/stg_stackoverflow__posts.sql


WITH source_data AS (
    SELECT 
        Id,
        OwnerUserId,
        PostTypeId,
        ViewCount,
        CreationDate,
        AcceptedAnswerId,
        Score
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/posts.parquet'
    WHERE Id IS NOT NULL
    
        AND CreationDate > (SELECT MAX(created_at) FROM "dev"."main"."stg_stackoverflow__posts")
    
),

validated_data AS (
    SELECT 
        CAST(Id AS BIGINT) as post_id,
        CAST(OwnerUserId AS BIGINT) as user_id,
        CAST(PostTypeId AS INT) as post_type_id,
        CAST(ViewCount AS INT) as view_count,
        CreationDate as created_at,
        DATE_TRUNC('month', CreationDate) as created_at_month,
        CAST(AcceptedAnswerId AS BIGINT) as accepted_answer_id,
        CAST(Score AS INT) as score
    FROM source_data
    WHERE Id > 0 
    AND PostTypeId IN (1, 2)  -- 1 for questions, 2 for answers
)

SELECT 
    post_id,
    user_id,
    post_type_id,
    view_count,
    created_at,
    created_at_month,
    accepted_answer_id,
    score
FROM validated_data
    );
  
  
  
[0m13:44:51.369314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:51.340166 [debug] [Thread-1 (]: SQL status: OK in 179.972 seconds
[0m13:47:51.343561 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m13:47:51.343717 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: BEGIN
[0m13:47:51.343964 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:47:51.344078 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m13:47:51.344198 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_stackoverflow__posts__dbt_tmp20250518134451359334'
      
      
      order by ordinal_position

  
[0m13:47:51.346591 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:47:51.348507 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m13:47:51.348650 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_stackoverflow__posts'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'dev'
      
      order by ordinal_position

  
[0m13:47:51.349750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:47:51.352436 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m13:47:51.352592 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_stackoverflow__posts'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'dev'
      
      order by ordinal_position

  
[0m13:47:51.353712 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:47:51.359452 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m13:47:51.360208 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m13:47:51.360382 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        
            delete from "dev"."main"."stg_stackoverflow__posts"
            where (
                post_id) in (
                select (post_id)
                from "stg_stackoverflow__posts__dbt_tmp20250518134451359334"
            );

        
    

    insert into "dev"."main"."stg_stackoverflow__posts" ("comment_id", "post_id", "user_id", "comment_text", "created_at", "created_at_month")
    (
        select "comment_id", "post_id", "user_id", "comment_text", "created_at", "created_at_month"
        from "stg_stackoverflow__posts__dbt_tmp20250518134451359334"
    )
  
[0m13:47:51.364294 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        
            delete from "dev"."main"."stg_stackoverflow__posts"
            where (
                post_id) in (
                select (post_id)
                from "stg_stackoverflow__posts__dbt_tmp20250518134451359334"
            );

        
    

    insert into "dev"."main"."stg_stackoverflow__posts" ("comment_id", "post_id", "user_id", "comment_text", "created_at", "created_at_month")
    (
        select "comment_id", "post_id", "user_id", "comment_text", "created_at", "created_at_month"
        from "stg_stackoverflow__posts__dbt_tmp20250518134451359334"
    )
  
[0m13:47:51.364494 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:47:51.364692 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: ROLLBACK
[0m13:47:51.369071 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts'
[0m13:47:51.369220 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: Close
[0m13:47:51.370878 [debug] [Thread-1 (]: Runtime Error in model stg_stackoverflow__posts (models/staging/stg_stackoverflow__posts.sql)
  Binder Error: Referenced column "comment_id" not found in FROM clause!
  Candidate bindings: "post_id", "user_id", "post_type_id", "score", "accepted_answer_id"
  
  LINE 16:         select "comment_id", "post_id", "user_id", "comment_text", "create...
                          ^
[0m13:47:51.371761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78893f87-fdd6-43ab-b011-b4124710aee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f5550>]}
[0m13:47:51.372015 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.stg_stackoverflow__posts ...... [[31mERROR[0m in 180.03s]
[0m13:47:51.372252 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m13:47:51.372428 [debug] [Thread-5 (]: Marking all children of 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stackoverflow__posts (models/staging/stg_stackoverflow__posts.sql)
  Binder Error: Referenced column "comment_id" not found in FROM clause!
  Candidate bindings: "post_id", "user_id", "post_type_id", "score", "accepted_answer_id"
  
  LINE 16:         select "comment_id", "post_id", "user_id", "comment_text", "create...
                          ^.
[0m13:47:51.373178 [debug] [MainThread]: Using duckdb connection "master"
[0m13:47:51.373323 [debug] [MainThread]: On master: BEGIN
[0m13:47:51.373429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:51.373989 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:47:51.374094 [debug] [MainThread]: On master: COMMIT
[0m13:47:51.374188 [debug] [MainThread]: Using duckdb connection "master"
[0m13:47:51.374296 [debug] [MainThread]: On master: COMMIT
[0m13:47:51.374446 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:47:51.374542 [debug] [MainThread]: On master: Close
[0m13:47:51.374686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:51.374788 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts' was properly closed.
[0m13:47:51.374888 [debug] [MainThread]: Connection 'list_dev_main_intermediate' was properly closed.
[0m13:47:51.375007 [info ] [MainThread]: 
[0m13:47:51.375124 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 3 minutes and 0.16 seconds (180.16s).
[0m13:47:51.375399 [debug] [MainThread]: Command end result
[0m13:47:51.384784 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m13:47:51.385685 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m13:47:51.388131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m13:47:51.388248 [info ] [MainThread]: 
[0m13:47:51.388399 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:47:51.388511 [info ] [MainThread]: 
[0m13:47:51.388652 [error] [MainThread]:   Runtime Error in model stg_stackoverflow__posts (models/staging/stg_stackoverflow__posts.sql)
  Binder Error: Referenced column "comment_id" not found in FROM clause!
  Candidate bindings: "post_id", "user_id", "post_type_id", "score", "accepted_answer_id"
  
  LINE 16:         select "comment_id", "post_id", "user_id", "comment_text", "create...
                          ^
[0m13:47:51.388760 [info ] [MainThread]: 
[0m13:47:51.388885 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:47:51.390212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 180.49059, "process_in_blocks": "0", "process_kernel_time": 5.266233, "process_mem_max_rss": "785596416", "process_out_blocks": "0", "process_user_time": 16.57677}
[0m13:47:51.390374 [debug] [MainThread]: Command `dbt run` failed at 13:47:51.390342 after 180.49 seconds
[0m13:47:51.390515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098199c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0e850>]}
[0m13:47:51.390638 [debug] [MainThread]: Flushing usage events
[0m13:47:52.309013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:52.638033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104309d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105063c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105063ed0>]}


============================== 14:01:52.640630 | 0315f392-3831-41ac-97de-a65c665eb5f4 ==============================
[0m14:01:52.640630 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:01:52.640945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stackoverflow__posts --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:01:52.757483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0315f392-3831-41ac-97de-a65c665eb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105235f30>]}
[0m14:01:52.780402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0315f392-3831-41ac-97de-a65c665eb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f88e20>]}
[0m14:01:52.782146 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:01:52.824837 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:01:52.898139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:01:52.898380 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:01:52.920100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0315f392-3831-41ac-97de-a65c665eb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050eac50>]}
[0m14:01:52.957082 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m14:01:52.958132 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m14:01:52.967434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0315f392-3831-41ac-97de-a65c665eb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105417f20>]}
[0m14:01:52.967700 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m14:01:52.967846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0315f392-3831-41ac-97de-a65c665eb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105776510>]}
[0m14:01:52.969122 [info ] [MainThread]: 
[0m14:01:52.969373 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:01:52.969547 [info ] [MainThread]: 
[0m14:01:52.969827 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:01:52.970417 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:01:53.027603 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:01:53.027829 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:01:53.027970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:53.060791 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m14:01:53.061658 [debug] [ThreadPool]: On list_dev: Close
[0m14:01:53.062223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:01:53.062526 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:01:53.065683 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:01:53.065881 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:01:53.066003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:53.066923 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:01:53.067559 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:01:53.067699 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:01:53.067911 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:01:53.068090 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:01:53.068230 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:01:53.068464 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:01:53.068855 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:01:53.068994 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:01:53.069108 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:01:53.069289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:01:53.069403 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:01:53.072059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_marts)
[0m14:01:53.072333 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_analysis'
[0m14:01:53.075263 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m14:01:53.076041 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m14:01:53.076198 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m14:01:53.076371 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m14:01:53.076544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:53.076674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:53.077371 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:01:53.077519 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m14:01:53.077685 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m14:01:53.078193 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:01:53.078339 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m14:01:53.078463 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m14:01:53.086119 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:01:53.086296 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:01:53.086936 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m14:01:53.087471 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m14:01:53.088120 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m14:01:53.088335 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m14:01:53.088564 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m14:01:53.088706 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m14:01:53.088927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_intermediate)
[0m14:01:53.089726 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m14:01:53.089983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_marts, now list_dev_main)
[0m14:01:53.090149 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m14:01:53.091075 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:01:53.091223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:53.091347 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:01:53.091559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:53.092091 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:01:53.092222 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m14:01:53.092383 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m14:01:53.092844 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:01:53.092968 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:01:53.093092 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:01:53.095388 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:01:53.095969 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m14:01:53.096238 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m14:01:53.096375 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:01:53.096503 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m14:01:53.097143 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:01:53.097461 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:01:53.097614 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:01:53.098151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0315f392-3831-41ac-97de-a65c665eb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad2750>]}
[0m14:01:53.098373 [debug] [MainThread]: Using duckdb connection "master"
[0m14:01:53.098502 [debug] [MainThread]: On master: BEGIN
[0m14:01:53.098621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:53.099196 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:01:53.099335 [debug] [MainThread]: On master: COMMIT
[0m14:01:53.099455 [debug] [MainThread]: Using duckdb connection "master"
[0m14:01:53.099565 [debug] [MainThread]: On master: COMMIT
[0m14:01:53.099733 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:01:53.099850 [debug] [MainThread]: On master: Close
[0m14:01:53.101046 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m14:01:53.101306 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__posts ............... [RUN]
[0m14:01:53.101523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.stackoverflow_analysis_aw.stg_stackoverflow__posts)
[0m14:01:53.101835 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m14:01:53.108360 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:01:53.108955 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m14:01:53.132575 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:01:53.133175 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:01:53.133337 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: BEGIN
[0m14:01:53.133489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:53.134119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:01:53.134281 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:01:53.134441 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__posts__dbt_tmp"
  
    as (
      -- models/staging/stg_stackoverflow__posts.sql


WITH source_data AS (
    SELECT 
        Id,
        OwnerUserId,
        PostTypeId,
        ViewCount,
        CreationDate,
        AcceptedAnswerId,
        Score
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/posts.parquet'
    WHERE Id IS NOT NULL
    
),

validated_data AS (
    SELECT 
        CAST(Id AS BIGINT) as post_id,
        CAST(OwnerUserId AS BIGINT) as user_id,
        CAST(PostTypeId AS INT) as post_type_id,
        CAST(ViewCount AS INT) as view_count,
        CreationDate as created_at,
        DATE_TRUNC('month', CreationDate) as created_at_month,
        CAST(AcceptedAnswerId AS BIGINT) as accepted_answer_id,
        CAST(Score AS INT) as score
    FROM source_data
    WHERE Id > 0 
    AND PostTypeId IN (1, 2)  -- 1 for questions, 2 for answers
)

SELECT 
    post_id,
    user_id,
    post_type_id,
    view_count,
    created_at,
    created_at_month,
    accepted_answer_id,
    score
FROM validated_data
    );
  
  
  
[0m14:05:01.940057 [debug] [Thread-1 (]: SQL status: OK in 188.807 seconds
[0m14:05:01.943819 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:05:01.943976 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */
alter table "dev"."main"."stg_stackoverflow__posts" rename to "stg_stackoverflow__posts__dbt_backup"
[0m14:05:01.944472 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */
alter table "dev"."main"."stg_stackoverflow__posts" rename to "stg_stackoverflow__posts__dbt_backup"
[0m14:05:01.944593 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:05:01.944762 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: ROLLBACK
[0m14:05:01.950843 [debug] [Thread-1 (]: Failed to rollback 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts'
[0m14:05:01.951085 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: Close
[0m14:05:01.984674 [debug] [Thread-1 (]: Runtime Error in model stg_stackoverflow__posts (models/staging/stg_stackoverflow__posts.sql)
  Dependency Error: Cannot alter entry "stg_stackoverflow__posts" because there are entries that depend on it.
[0m14:05:01.985668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0315f392-3831-41ac-97de-a65c665eb5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105addf10>]}
[0m14:05:01.985947 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.stg_stackoverflow__posts ...... [[31mERROR[0m in 188.88s]
[0m14:05:01.986184 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m14:05:01.986364 [debug] [Thread-5 (]: Marking all children of 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_stackoverflow__posts (models/staging/stg_stackoverflow__posts.sql)
  Dependency Error: Cannot alter entry "stg_stackoverflow__posts" because there are entries that depend on it..
[0m14:05:01.987101 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:01.987209 [debug] [MainThread]: On master: BEGIN
[0m14:05:01.987300 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:01.987857 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:05:01.987952 [debug] [MainThread]: On master: COMMIT
[0m14:05:01.988043 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:01.988128 [debug] [MainThread]: On master: COMMIT
[0m14:05:01.988288 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:05:01.988443 [debug] [MainThread]: On master: Close
[0m14:05:01.988590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:01.988686 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts' was properly closed.
[0m14:05:01.988771 [debug] [MainThread]: Connection 'list_dev_main_intermediate' was properly closed.
[0m14:05:01.988870 [info ] [MainThread]: 
[0m14:05:01.988995 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 3 minutes and 9.02 seconds (189.02s).
[0m14:05:01.989237 [debug] [MainThread]: Command end result
[0m14:05:01.999590 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m14:05:02.000756 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m14:05:02.003416 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m14:05:02.003537 [info ] [MainThread]: 
[0m14:05:02.003681 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:05:02.003794 [info ] [MainThread]: 
[0m14:05:02.003933 [error] [MainThread]:   Runtime Error in model stg_stackoverflow__posts (models/staging/stg_stackoverflow__posts.sql)
  Dependency Error: Cannot alter entry "stg_stackoverflow__posts" because there are entries that depend on it.
[0m14:05:02.004037 [info ] [MainThread]: 
[0m14:05:02.004152 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:05:02.006203 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 189.40392, "process_in_blocks": "0", "process_kernel_time": 4.622823, "process_mem_max_rss": "1234026496", "process_out_blocks": "0", "process_user_time": 25.994286}
[0m14:05:02.006364 [debug] [MainThread]: Command `dbt run` failed at 14:05:02.006331 after 189.40 seconds
[0m14:05:02.006511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105afd5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cad310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cad3b0>]}
[0m14:05:02.006639 [debug] [MainThread]: Flushing usage events
[0m14:05:03.037664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:39.975481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca15d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dccfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dccfed0>]}


============================== 14:06:39.977610 | 755e983f-56a9-496c-ad5c-d65a1321979a ==============================
[0m14:06:39.977610 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:06:39.977877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:40.026005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '755e983f-56a9-496c-ad5c-d65a1321979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdb1e00>]}
[0m14:06:40.040910 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.096739955, "process_in_blocks": "0", "process_kernel_time": 0.140311, "process_mem_max_rss": "106233856", "process_out_blocks": "0", "process_user_time": 0.616798}
[0m14:06:40.041168 [debug] [MainThread]: Command `dbt clean` succeeded at 14:06:40.041120 after 0.10 seconds
[0m14:06:40.041337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbf5bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbf5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de42350>]}
[0m14:06:40.041490 [debug] [MainThread]: Flushing usage events
[0m14:06:40.965794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:51.928606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111475d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140cfed0>]}


============================== 14:06:51.930624 | cd0d8eee-bc10-44b6-b643-94d81c0ad0b0 ==============================
[0m14:06:51.930624 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:06:51.930895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'profiles_dir': '/Users/yuejwang/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_stackoverflow__posts --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:52.014756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd0d8eee-bc10-44b6-b643-94d81c0ad0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143a1f30>]}
[0m14:06:52.035437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd0d8eee-bc10-44b6-b643-94d81c0ad0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf8e20>]}
[0m14:06:52.036987 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:06:52.080348 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:06:52.081023 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:52.081223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd0d8eee-bc10-44b6-b643-94d81c0ad0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11417b250>]}
[0m14:06:52.576116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd0d8eee-bc10-44b6-b643-94d81c0ad0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11459f4d0>]}
[0m14:06:52.608750 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m14:06:52.609753 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m14:06:52.620822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd0d8eee-bc10-44b6-b643-94d81c0ad0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114755e10>]}
[0m14:06:52.620999 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m14:06:52.621134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd0d8eee-bc10-44b6-b643-94d81c0ad0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149ef450>]}
[0m14:06:52.621793 [info ] [MainThread]: 
[0m14:06:52.621928 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:06:52.622035 [info ] [MainThread]: 
[0m14:06:52.622222 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:06:52.622531 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:06:52.674037 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:06:52.674275 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:06:52.674417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:52.702076 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m14:06:52.702723 [debug] [ThreadPool]: On list_dev: Close
[0m14:06:52.703052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:06:52.703284 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:06:52.706035 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:06:52.706186 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:06:52.706300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:52.706990 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:06:52.707554 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:06:52.707682 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:06:52.707840 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:06:52.707944 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:06:52.708046 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:06:52.708250 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:06:52.708652 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:06:52.708790 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:06:52.708904 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:06:52.709080 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:06:52.709190 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:06:52.711665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_intermediate)
[0m14:06:52.713961 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m14:06:52.714470 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:06:52.714600 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m14:06:52.715309 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:06:52.715436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:52.715558 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:06:52.715726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:52.716159 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:06:52.716280 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m14:06:52.716439 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m14:06:52.716850 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:06:52.716988 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:06:52.717111 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:06:52.725066 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:06:52.725272 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:06:52.725856 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m14:06:52.726380 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:06:52.726937 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m14:06:52.727126 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m14:06:52.727381 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:06:52.727549 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:06:52.727766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now list_dev_main_analysis)
[0m14:06:52.728555 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m14:06:52.728766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_marts)
[0m14:06:52.728894 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m14:06:52.731019 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m14:06:52.731169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:52.731291 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m14:06:52.731490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:52.731992 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:06:52.732130 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m14:06:52.732283 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m14:06:52.732747 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:06:52.732883 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m14:06:52.733009 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m14:06:52.735233 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:06:52.735821 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m14:06:52.735971 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:06:52.736237 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m14:06:52.736708 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m14:06:52.736846 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m14:06:52.737129 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m14:06:52.737331 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m14:06:52.737637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd0d8eee-bc10-44b6-b643-94d81c0ad0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d6cc50>]}
[0m14:06:52.737838 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:52.737954 [debug] [MainThread]: On master: BEGIN
[0m14:06:52.738061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:52.738590 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:06:52.738722 [debug] [MainThread]: On master: COMMIT
[0m14:06:52.738835 [debug] [MainThread]: Using duckdb connection "master"
[0m14:06:52.738938 [debug] [MainThread]: On master: COMMIT
[0m14:06:52.739092 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:06:52.739223 [debug] [MainThread]: On master: Close
[0m14:06:52.740401 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m14:06:52.740665 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__posts ............... [RUN]
[0m14:06:52.740878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now model.stackoverflow_analysis_aw.stg_stackoverflow__posts)
[0m14:06:52.741033 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m14:06:52.744932 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:06:52.745724 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m14:06:52.769397 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:06:52.770548 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:06:52.770740 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: BEGIN
[0m14:06:52.771180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:52.772187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:06:52.772360 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:06:52.772529 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__posts"
  
    as (
      -- models/staging/stg_stackoverflow__posts.sql


WITH source_data AS (
    SELECT 
        Id,
        OwnerUserId,
        PostTypeId,
        ViewCount,
        CreationDate,
        AcceptedAnswerId,
        Score
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/posts.parquet'
    WHERE Id IS NOT NULL
    
),

validated_data AS (
    SELECT 
        CAST(Id AS BIGINT) as post_id,
        CAST(OwnerUserId AS BIGINT) as user_id,
        CAST(PostTypeId AS INT) as post_type_id,
        CAST(ViewCount AS INT) as view_count,
        CreationDate as created_at,
        DATE_TRUNC('month', CreationDate) as created_at_month,
        CAST(AcceptedAnswerId AS BIGINT) as accepted_answer_id,
        CAST(Score AS INT) as score
    FROM source_data
    WHERE Id > 0 
    AND PostTypeId IN (1, 2)  -- 1 for questions, 2 for answers
)

SELECT 
    post_id,
    user_id,
    post_type_id,
    view_count,
    created_at,
    created_at_month,
    accepted_answer_id,
    score
FROM validated_data
    );
  
  
  
[0m14:09:57.417481 [debug] [Thread-1 (]: SQL status: OK in 184.646 seconds
[0m14:09:57.423194 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:09:57.423454 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__posts_created_at ON "dev"."main"."stg_stackoverflow__posts" (created_at)
      
[0m14:09:57.424276 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:09:57.425104 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:09:57.425262 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__posts_post_type ON "dev"."main"."stg_stackoverflow__posts" (post_type_id)
      
[0m14:09:57.425908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:09:57.426658 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:09:57.426819 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

        ANALYZE "dev"."main"."stg_stackoverflow__posts"
      
[0m14:09:58.811288 [debug] [Thread-1 (]: SQL status: OK in 1.384 seconds
[0m14:09:58.811792 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m14:09:58.811946 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m14:09:58.812065 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: COMMIT
[0m14:10:30.155156 [debug] [Thread-1 (]: SQL status: OK in 31.343 seconds
[0m14:10:30.158186 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: Close
[0m14:10:30.160801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0d8eee-bc10-44b6-b643-94d81c0ad0b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114643cd0>]}
[0m14:10:30.161162 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.stg_stackoverflow__posts .......... [[32mOK[0m in 217.42s]
[0m14:10:30.161407 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m14:10:30.162339 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:30.162509 [debug] [MainThread]: On master: BEGIN
[0m14:10:30.162635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:30.163323 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:10:30.163511 [debug] [MainThread]: On master: COMMIT
[0m14:10:30.163636 [debug] [MainThread]: Using duckdb connection "master"
[0m14:10:30.163742 [debug] [MainThread]: On master: COMMIT
[0m14:10:30.163900 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:10:30.164023 [debug] [MainThread]: On master: Close
[0m14:10:30.164173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:30.164277 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts' was properly closed.
[0m14:10:30.164372 [debug] [MainThread]: Connection 'list_dev_main_marts' was properly closed.
[0m14:10:30.164490 [info ] [MainThread]: 
[0m14:10:30.164606 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 3 minutes and 37.54 seconds (217.54s).
[0m14:10:30.164918 [debug] [MainThread]: Command end result
[0m14:10:30.176002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m14:10:30.177779 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m14:10:30.180131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m14:10:30.180280 [info ] [MainThread]: 
[0m14:10:30.180450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:30.180576 [info ] [MainThread]: 
[0m14:10:30.180706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:10:30.182658 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 218.28764, "process_in_blocks": "0", "process_kernel_time": 5.120839, "process_mem_max_rss": "4634755072", "process_out_blocks": "0", "process_user_time": 54.639275}
[0m14:10:30.182898 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:30.182860 after 218.29 seconds
[0m14:10:30.183083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f2f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e83ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b0add0>]}
[0m14:10:30.183234 [debug] [MainThread]: Flushing usage events
[0m14:10:31.101511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:44.232858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3fed0>]}


============================== 14:17:44.235038 | 98a0eef7-ed7e-422b-b367-64f3dacdc2fa ==============================
[0m14:17:44.235038 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:17:44.235335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stackoverflow__users --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:17:44.317674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98a0eef7-ed7e-422b-b367-64f3dacdc2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f11f30>]}
[0m14:17:44.338982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98a0eef7-ed7e-422b-b367-64f3dacdc2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c64e20>]}
[0m14:17:44.340500 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:17:44.385764 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:17:44.450024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:44.450268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:44.472314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98a0eef7-ed7e-422b-b367-64f3dacdc2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcac50>]}
[0m14:17:44.510151 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m14:17:44.511118 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m14:17:44.520435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98a0eef7-ed7e-422b-b367-64f3dacdc2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f87f20>]}
[0m14:17:44.520691 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m14:17:44.520859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a0eef7-ed7e-422b-b367-64f3dacdc2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c6510>]}
[0m14:17:44.521676 [info ] [MainThread]: 
[0m14:17:44.521826 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:17:44.521939 [info ] [MainThread]: 
[0m14:17:44.522144 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:17:44.522480 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:17:44.570182 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:17:44.570423 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:17:44.570563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:44.600426 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m14:17:44.601161 [debug] [ThreadPool]: On list_dev: Close
[0m14:17:44.601497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:17:44.601707 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:17:44.604731 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:17:44.604896 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:17:44.605021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:44.605814 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:17:44.606407 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:17:44.606532 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:17:44.606703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:44.606803 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:17:44.606909 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:17:44.607134 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:44.607565 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:17:44.607715 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:17:44.607829 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:17:44.607999 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:17:44.608107 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:17:44.611144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_analysis)
[0m14:17:44.614456 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m14:17:44.614712 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:17:44.614876 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m14:17:44.615652 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:17:44.615809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:44.615940 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:17:44.616187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:44.616691 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:17:44.616825 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m14:17:44.616976 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m14:17:44.617464 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:17:44.617610 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:17:44.617753 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:17:44.625546 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:17:44.625749 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:17:44.626360 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m14:17:44.626931 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:17:44.627671 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:17:44.627930 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m14:17:44.628060 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:17:44.628187 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m14:17:44.628440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_intermediate)
[0m14:17:44.629268 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m14:17:44.629479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_marts)
[0m14:17:44.629639 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m14:17:44.630560 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m14:17:44.630702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:44.630826 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m14:17:44.631001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:44.631488 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:17:44.631622 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m14:17:44.631747 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m14:17:44.632227 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:17:44.632349 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m14:17:44.632477 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m14:17:44.634731 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:17:44.635320 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m14:17:44.635464 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:17:44.635749 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m14:17:44.635880 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m14:17:44.636361 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m14:17:44.636687 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m14:17:44.636811 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m14:17:44.637093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a0eef7-ed7e-422b-b367-64f3dacdc2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109542750>]}
[0m14:17:44.637321 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:44.637439 [debug] [MainThread]: On master: BEGIN
[0m14:17:44.637543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:44.638062 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:17:44.638178 [debug] [MainThread]: On master: COMMIT
[0m14:17:44.638284 [debug] [MainThread]: Using duckdb connection "master"
[0m14:17:44.638388 [debug] [MainThread]: On master: COMMIT
[0m14:17:44.638528 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:17:44.638635 [debug] [MainThread]: On master: Close
[0m14:17:44.640490 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m14:17:44.640756 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__users ............... [RUN]
[0m14:17:44.640972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_marts, now model.stackoverflow_analysis_aw.stg_stackoverflow__users)
[0m14:17:44.641129 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m14:17:44.646205 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m14:17:44.646651 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m14:17:44.669819 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m14:17:44.670415 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m14:17:44.670582 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: BEGIN
[0m14:17:44.670724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:44.671377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:17:44.671541 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m14:17:44.671703 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__users"
  
    as (
      -- models/staging/stg_stackoverflow__users.sql


WITH source_data AS (
    SELECT *,
           ROW_NUMBER() OVER (ORDER BY CreationDate) as batch_id
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/users.parquet'
    
)
SELECT
    Id as user_id,
    DisplayName as display_name,
    CreationDate as created_at
FROM source_data
    );
  
  
  
[0m14:18:37.952139 [debug] [Thread-1 (]: SQL status: OK in 53.281 seconds
[0m14:18:37.958232 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m14:18:37.958406 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__users_created_at ON "dev"."main"."stg_stackoverflow__users" (created_at)
      
[0m14:18:37.958989 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:37.959657 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m14:18:37.959800 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__users"} */

        ANALYZE "dev"."main"."stg_stackoverflow__users"
      
[0m14:18:38.694231 [debug] [Thread-1 (]: SQL status: OK in 0.734 seconds
[0m14:18:38.694746 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: COMMIT
[0m14:18:38.694893 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__users"
[0m14:18:38.695007 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: COMMIT
[0m14:18:45.002260 [debug] [Thread-1 (]: SQL status: OK in 6.307 seconds
[0m14:18:45.003600 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__users: Close
[0m14:18:45.005222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a0eef7-ed7e-422b-b367-64f3dacdc2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10954da90>]}
[0m14:18:45.005524 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.stg_stackoverflow__users .......... [[32mOK[0m in 60.36s]
[0m14:18:45.005771 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__users
[0m14:18:45.006340 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:45.006506 [debug] [MainThread]: On master: BEGIN
[0m14:18:45.006618 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:45.007279 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:18:45.007447 [debug] [MainThread]: On master: COMMIT
[0m14:18:45.007573 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:45.007681 [debug] [MainThread]: On master: COMMIT
[0m14:18:45.007832 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:45.007941 [debug] [MainThread]: On master: Close
[0m14:18:45.008092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:45.008196 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__users' was properly closed.
[0m14:18:45.008282 [debug] [MainThread]: Connection 'list_dev_main_intermediate' was properly closed.
[0m14:18:45.008397 [info ] [MainThread]: 
[0m14:18:45.008524 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 1 minutes and 0.49 seconds (60.49s).
[0m14:18:45.008787 [debug] [MainThread]: Command end result
[0m14:18:45.018526 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m14:18:45.020360 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m14:18:45.022810 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m14:18:45.022936 [info ] [MainThread]: 
[0m14:18:45.023087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:45.023195 [info ] [MainThread]: 
[0m14:18:45.023308 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:18:45.025447 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 60.827415, "process_in_blocks": "0", "process_kernel_time": 3.675847, "process_mem_max_rss": "5049401344", "process_out_blocks": "0", "process_user_time": 20.57604}
[0m14:18:45.025662 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:45.025620 after 60.83 seconds
[0m14:18:45.025816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109571440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971cff0>]}
[0m14:18:45.025952 [debug] [MainThread]: Flushing usage events
[0m14:18:45.939667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:02.887829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105965d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bfed0>]}


============================== 14:28:02.889949 | f8bae0e3-68d9-4957-ae69-c54c2cb9e046 ==============================
[0m14:28:02.889949 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:28:02.890217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stackoverflow__comments', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:02.973013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8bae0e3-68d9-4957-ae69-c54c2cb9e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106891f30>]}
[0m14:28:02.994120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8bae0e3-68d9-4957-ae69-c54c2cb9e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e4e20>]}
[0m14:28:02.995687 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:28:03.039502 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:28:03.099738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:03.099976 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:03.121459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8bae0e3-68d9-4957-ae69-c54c2cb9e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676ac50>]}
[0m14:28:03.157163 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m14:28:03.158163 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m14:28:03.167635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8bae0e3-68d9-4957-ae69-c54c2cb9e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106907f20>]}
[0m14:28:03.167896 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m14:28:03.168041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8bae0e3-68d9-4957-ae69-c54c2cb9e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6a510>]}
[0m14:28:03.168784 [info ] [MainThread]: 
[0m14:28:03.168927 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:28:03.169035 [info ] [MainThread]: 
[0m14:28:03.169230 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:28:03.169597 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:28:03.223082 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:28:03.223333 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:28:03.223471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:03.253142 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m14:28:03.253864 [debug] [ThreadPool]: On list_dev: Close
[0m14:28:03.254185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:28:03.254380 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:28:03.257375 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:28:03.257522 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:28:03.257649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:03.258370 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:28:03.259008 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:28:03.259152 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:28:03.259322 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:28:03.259438 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:28:03.259548 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:28:03.259735 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:28:03.260078 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:28:03.260209 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:28:03.260323 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:28:03.260477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:28:03.260587 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:28:03.263659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:28:03.263944 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_analysis'
[0m14:28:03.267165 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:28:03.267952 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m14:28:03.268100 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:28:03.268225 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m14:28:03.268338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:03.268480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:03.269219 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:28:03.269375 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:28:03.269546 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:28:03.270034 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:28:03.270150 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m14:28:03.270269 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m14:28:03.278399 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:28:03.278611 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:28:03.279237 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:28:03.279778 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m14:28:03.280356 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:28:03.280573 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:28:03.280845 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m14:28:03.280989 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m14:28:03.281203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_marts)
[0m14:28:03.282078 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m14:28:03.282294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_intermediate)
[0m14:28:03.282437 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m14:28:03.283333 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m14:28:03.283466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:03.283584 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m14:28:03.283767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:03.284231 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:28:03.284378 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m14:28:03.284539 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m14:28:03.285016 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:28:03.285142 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m14:28:03.285262 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m14:28:03.287542 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:28:03.288128 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m14:28:03.288296 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:28:03.288522 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m14:28:03.289000 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m14:28:03.289127 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m14:28:03.289347 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m14:28:03.289488 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m14:28:03.289846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8bae0e3-68d9-4957-ae69-c54c2cb9e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec2750>]}
[0m14:28:03.290052 [debug] [MainThread]: Using duckdb connection "master"
[0m14:28:03.290172 [debug] [MainThread]: On master: BEGIN
[0m14:28:03.290274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:03.290766 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:28:03.290903 [debug] [MainThread]: On master: COMMIT
[0m14:28:03.291027 [debug] [MainThread]: Using duckdb connection "master"
[0m14:28:03.291144 [debug] [MainThread]: On master: COMMIT
[0m14:28:03.291318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:28:03.291432 [debug] [MainThread]: On master: Close
[0m14:28:03.293588 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m14:28:03.293844 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__comments ............ [RUN]
[0m14:28:03.294058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_marts, now model.stackoverflow_analysis_aw.stg_stackoverflow__comments)
[0m14:28:03.294207 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m14:28:03.299733 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m14:28:03.300194 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m14:28:03.323782 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m14:28:03.324359 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m14:28:03.324525 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: BEGIN
[0m14:28:03.324667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:03.325372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:28:03.325556 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m14:28:03.325724 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

  
    
    

    create  table
      "dev"."main"."stg_stackoverflow__comments"
  
    as (
      -- models/staging/stg_stackoverflow__comments.sql


WITH source_data AS (
    SELECT 
        Id as comment_id,
        PostId as post_id,
        UserId as user_id,
        Text as comment_text,
        CreationDate as created_at,
        DATE_TRUNC('month', CreationDate) as created_at_month
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/comments.parquet'
    WHERE Id IS NOT NULL
    
),

validated_data AS (
    SELECT 
        CAST(comment_id AS BIGINT) as comment_id,
        CAST(post_id AS BIGINT) as post_id,
        CAST(user_id AS BIGINT) as user_id,
        comment_text,
        created_at,
        created_at_month
    FROM source_data
    WHERE comment_id > 0
    AND post_id > 0
)

SELECT 
    comment_id,
    post_id,
    user_id,
    comment_text,
    created_at,
    created_at_month
FROM validated_data
    );
  
  
  
[0m14:37:04.024361 [debug] [Thread-1 (]: SQL status: OK in 540.696 seconds
[0m14:37:04.033379 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m14:37:04.033627 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_created_at ON "dev"."main"."stg_stackoverflow__comments" (created_at)
      
[0m14:37:04.034574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:37:04.035272 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m14:37:04.035547 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        CREATE INDEX IF NOT EXISTS idx_stg_stackoverflow__comments_post_id ON "dev"."main"."stg_stackoverflow__comments" (post_id)
      
[0m14:37:04.036567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:37:04.039329 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m14:37:04.039475 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"} */

        ANALYZE "dev"."main"."stg_stackoverflow__comments"
      
[0m14:37:10.768855 [debug] [Thread-1 (]: SQL status: OK in 6.729 seconds
[0m14:37:10.769435 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m14:37:10.769590 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__comments"
[0m14:37:10.769709 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: COMMIT
[0m14:38:24.070604 [debug] [Thread-1 (]: SQL status: OK in 73.300 seconds
[0m14:38:24.096265 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__comments: Close
[0m14:38:24.109687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8bae0e3-68d9-4957-ae69-c54c2cb9e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecda90>]}
[0m14:38:24.113493 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main.stg_stackoverflow__comments ....... [[32mOK[0m in 620.81s]
[0m14:38:24.114211 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__comments
[0m14:38:24.122121 [debug] [MainThread]: Using duckdb connection "master"
[0m14:38:24.122266 [debug] [MainThread]: On master: BEGIN
[0m14:38:24.122527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:24.124584 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:38:24.124739 [debug] [MainThread]: On master: COMMIT
[0m14:38:24.124860 [debug] [MainThread]: Using duckdb connection "master"
[0m14:38:24.124965 [debug] [MainThread]: On master: COMMIT
[0m14:38:24.125295 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:38:24.125408 [debug] [MainThread]: On master: Close
[0m14:38:24.125567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:24.125671 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__comments' was properly closed.
[0m14:38:24.125754 [debug] [MainThread]: Connection 'list_dev_main_intermediate' was properly closed.
[0m14:38:24.126095 [info ] [MainThread]: 
[0m14:38:24.126256 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 10 minutes and 20.96 seconds (620.96s).
[0m14:38:24.128193 [debug] [MainThread]: Command end result
[0m14:38:24.170954 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m14:38:24.180454 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m14:38:24.187925 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m14:38:24.188122 [info ] [MainThread]: 
[0m14:38:24.188322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:24.188440 [info ] [MainThread]: 
[0m14:38:24.188804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:38:24.191113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 621.33374, "process_in_blocks": "0", "process_kernel_time": 29.69732, "process_mem_max_rss": "7120584704", "process_out_blocks": "0", "process_user_time": 158.24393}
[0m14:38:24.191336 [debug] [MainThread]: Command `dbt run` succeeded at 14:38:24.191298 after 621.33 seconds
[0m14:38:24.192126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef1440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105387cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a0af0>]}
[0m14:38:24.192265 [debug] [MainThread]: Flushing usage events
[0m14:38:25.142876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:01.875939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120dbdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220cfed0>]}


============================== 14:44:01.878620 | 2aed972c-8016-4895-a6a3-e1910fb04325 ==============================
[0m14:44:01.878620 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:44:01.878891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m14:44:01.963399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aed972c-8016-4895-a6a3-e1910fb04325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223a1f30>]}
[0m14:44:01.984129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aed972c-8016-4895-a6a3-e1910fb04325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ff4e20>]}
[0m14:44:01.986764 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:44:02.034247 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:44:02.101886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:44:02.102105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:44:02.121493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aed972c-8016-4895-a6a3-e1910fb04325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12217ac50>]}
[0m14:44:02.153269 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m14:44:02.154419 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m14:44:02.166334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2aed972c-8016-4895-a6a3-e1910fb04325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122417f20>]}
[0m14:44:02.166560 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m14:44:02.166706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aed972c-8016-4895-a6a3-e1910fb04325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122976510>]}
[0m14:44:02.167514 [info ] [MainThread]: 
[0m14:44:02.167656 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:44:02.167762 [info ] [MainThread]: 
[0m14:44:02.167963 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:44:02.169803 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:44:02.217263 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:44:02.217492 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:44:02.217622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:02.250464 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m14:44:02.251126 [debug] [ThreadPool]: On list_dev: Close
[0m14:44:02.251451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_intermediate)
[0m14:44:02.251681 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_intermediate"
"
[0m14:44:02.254478 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m14:44:02.254636 [debug] [ThreadPool]: On create_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:44:02.254844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:02.255620 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:44:02.256192 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m14:44:02.256403 [debug] [ThreadPool]: On create_dev_main_intermediate: BEGIN
[0m14:44:02.256617 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:44:02.256733 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m14:44:02.256843 [debug] [ThreadPool]: On create_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_intermediate"} */

    
    
        create schema if not exists "dev"."main_intermediate"
    
[0m14:44:02.257030 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:44:02.257389 [debug] [ThreadPool]: On create_dev_main_intermediate: COMMIT
[0m14:44:02.257508 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m14:44:02.257607 [debug] [ThreadPool]: On create_dev_main_intermediate: COMMIT
[0m14:44:02.258282 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:44:02.258409 [debug] [ThreadPool]: On create_dev_main_intermediate: Close
[0m14:44:02.259169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_intermediate, now list_dev_main)
[0m14:44:02.261506 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:44:02.261709 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_analysis'
[0m14:44:02.261851 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:44:02.262800 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m14:44:02.262925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:02.263052 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m14:44:02.263243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:02.263749 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:44:02.263864 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:44:02.263991 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:44:02.264412 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:44:02.264526 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m14:44:02.264635 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m14:44:02.271929 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:44:02.272090 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:44:02.272671 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m14:44:02.273253 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:44:02.273845 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m14:44:02.273991 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m14:44:02.274273 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:44:02.274548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_intermediate)
[0m14:44:02.274717 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:44:02.275451 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m14:44:02.275633 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m14:44:02.275835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_marts)
[0m14:44:02.276174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:02.277044 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m14:44:02.277239 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m14:44:02.277361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:02.277855 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:44:02.277995 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m14:44:02.278150 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m14:44:02.278516 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:44:02.278654 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m14:44:02.278787 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m14:44:02.281095 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:44:02.281692 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m14:44:02.281857 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:44:02.282092 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m14:44:02.282249 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m14:44:02.282716 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m14:44:02.283034 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m14:44:02.283158 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m14:44:02.283465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aed972c-8016-4895-a6a3-e1910fb04325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122bd6750>]}
[0m14:44:02.283671 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:02.283791 [debug] [MainThread]: On master: BEGIN
[0m14:44:02.283900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:02.284411 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:44:02.284528 [debug] [MainThread]: On master: COMMIT
[0m14:44:02.284643 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:02.284745 [debug] [MainThread]: On master: COMMIT
[0m14:44:02.284921 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:44:02.285053 [debug] [MainThread]: On master: Close
[0m14:44:02.286828 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m14:44:02.287006 [debug] [Thread-2 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m14:44:02.287233 [info ] [Thread-1 (]: 1 of 3 START sql table model main_intermediate.int_stackoverflow__answer_timing  [RUN]
[0m14:44:02.287466 [info ] [Thread-2 (]: 2 of 3 START sql table model main_intermediate.int_stackoverflow__at_replies ... [RUN]
[0m14:44:02.287658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_marts, now model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing)
[0m14:44:02.287834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now model.stackoverflow_analysis_aw.int_stackoverflow__at_replies)
[0m14:44:02.287984 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m14:44:02.288124 [debug] [Thread-2 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m14:44:02.291473 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m14:44:02.292842 [debug] [Thread-2 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m14:44:02.293371 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m14:44:02.293540 [debug] [Thread-2 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m14:44:02.307595 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m14:44:02.309075 [debug] [Thread-2 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m14:44:02.309654 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m14:44:02.309861 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m14:44:02.310021 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: BEGIN
[0m14:44:02.310175 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: BEGIN
[0m14:44:02.310322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:02.310480 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:44:02.311173 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:44:02.311306 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m14:44:02.311468 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__answer_timing.sql


WITH answer_timing AS (
    SELECT 
        q.post_id as question_id,
        q.created_at as question_date,
        a.created_at as answer_date,
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL
        AND DATEDIFF('minute', q.created_at, a.created_at) >= 0  -- Filter out negative times
)

SELECT 
    at.question_id,           -- Added 'at.' prefix
    at.question_date,         -- Added 'at.' prefix
    at.answer_date,          -- Added 'at.' prefix
    at.minutes_to_answer,    -- Added 'at.' prefix
    CASE 
        WHEN at.minutes_to_answer < 15 THEN 'Very Fast (<15 mins)'
        WHEN at.minutes_to_answer < 60 THEN 'Fast (15-60 mins)'
        WHEN at.minutes_to_answer < 480 THEN 'Same Day (1-8 hours)'
        WHEN at.minutes_to_answer < 1440 THEN 'Next Day (<24 hours)'
        WHEN at.minutes_to_answer < 7200 THEN 'Within 5 Days'
        ELSE 'More than 5 Days'
    END as response_time_band
FROM answer_timing at  -- Added alias 'at'
    );
  
  
[0m14:44:02.312001 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:44:02.312135 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m14:44:02.312279 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__at_replies__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__at_replies.sql


WITH question_authors AS (
    SELECT 
        post_id,
        user_id as author_id
    FROM "dev"."main"."stg_stackoverflow__posts"
    WHERE post_type_id = 1  -- Questions only
)

SELECT
    c.comment_id,
    c.post_id,
    c.comment_text,
    c.user_id,
    c.created_at as comment_date,
    qa.author_id as question_author_id
FROM "dev"."main"."stg_stackoverflow__comments" c
INNER JOIN question_authors qa 
    ON c.post_id = qa.post_id
WHERE c.comment_text LIKE '@%'  -- Comments with @mentions
  AND c.user_id = qa.author_id  -- Comment made by question author
    );
  
  
[0m14:44:06.436507 [debug] [Thread-1 (]: SQL status: OK in 4.124 seconds
[0m14:44:06.452024 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m14:44:06.452745 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */
alter table "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_tmp" rename to "int_stackoverflow__answer_timing"
[0m14:44:06.453523 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:44:06.471255 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: COMMIT
[0m14:44:06.471930 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m14:44:06.472416 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: COMMIT
[0m14:44:06.507559 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m14:44:06.512002 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m14:44:06.512296 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */
drop table if exists "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_backup" cascade
[0m14:44:06.512660 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:44:06.514680 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: Close
[0m14:44:06.516879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aed972c-8016-4895-a6a3-e1910fb04325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122be1850>]}
[0m14:44:06.517646 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main_intermediate.int_stackoverflow__answer_timing  [[32mOK[0m in 4.23s]
[0m14:44:06.518001 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m14:44:06.518227 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m14:44:06.518437 [info ] [Thread-1 (]: 3 of 3 START sql table model main_intermediate.int_stackoverflow__question_views  [RUN]
[0m14:44:06.518699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing, now model.stackoverflow_analysis_aw.int_stackoverflow__question_views)
[0m14:44:06.519068 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m14:44:06.520982 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m14:44:06.521958 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m14:44:06.525466 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m14:44:06.526856 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m14:44:06.527331 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: BEGIN
[0m14:44:06.527535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:06.529058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:44:06.529320 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m14:44:06.529518 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__question_views__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__question_views.sql


SELECT
    p.user_id,
    u.display_name,  -- Added for readability
    COUNT(*) as total_questions,
    SUM(p.view_count) as total_views,
    ROUND(AVG(p.view_count), 2) as avg_views_per_question
FROM "dev"."main"."stg_stackoverflow__posts" p
LEFT JOIN "dev"."main"."stg_stackoverflow__users" u
    ON p.user_id = u.user_id
WHERE p.post_type_id = 1  -- Questions only
  AND p.user_id IS NOT NULL
GROUP BY 
    p.user_id,
    u.display_name
    );
  
  
[0m14:44:07.339221 [debug] [Thread-2 (]: SQL status: OK in 5.027 seconds
[0m14:44:07.343030 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m14:44:07.343280 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"} */
alter table "dev"."main_intermediate"."int_stackoverflow__at_replies__dbt_tmp" rename to "int_stackoverflow__at_replies"
[0m14:44:07.343696 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:44:07.344344 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: COMMIT
[0m14:44:07.344527 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m14:44:07.344660 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: COMMIT
[0m14:44:07.348025 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:44:07.349211 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"
[0m14:44:07.349598 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__at_replies"} */
drop table if exists "dev"."main_intermediate"."int_stackoverflow__at_replies__dbt_backup" cascade
[0m14:44:07.350600 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:44:07.352472 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__at_replies: Close
[0m14:44:07.352878 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aed972c-8016-4895-a6a3-e1910fb04325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122becf70>]}
[0m14:44:07.353226 [info ] [Thread-2 (]: 2 of 3 OK created sql table model main_intermediate.int_stackoverflow__at_replies  [[32mOK[0m in 5.06s]
[0m14:44:07.353475 [debug] [Thread-2 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__at_replies
[0m14:44:08.145777 [debug] [Thread-1 (]: SQL status: OK in 1.616 seconds
[0m14:44:08.146976 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m14:44:08.147121 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"} */
alter table "dev"."main_intermediate"."int_stackoverflow__question_views__dbt_tmp" rename to "int_stackoverflow__question_views"
[0m14:44:08.147436 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:44:08.147868 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: COMMIT
[0m14:44:08.147993 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m14:44:08.148102 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: COMMIT
[0m14:44:08.149170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:44:08.150157 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"
[0m14:44:08.150291 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__question_views"} */
drop table if exists "dev"."main_intermediate"."int_stackoverflow__question_views__dbt_backup" cascade
[0m14:44:08.150502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:44:08.150961 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__question_views: Close
[0m14:44:08.151168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aed972c-8016-4895-a6a3-e1910fb04325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122db27b0>]}
[0m14:44:08.151407 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main_intermediate.int_stackoverflow__question_views  [[32mOK[0m in 1.63s]
[0m14:44:08.151618 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__question_views
[0m14:44:08.152426 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:08.152579 [debug] [MainThread]: On master: BEGIN
[0m14:44:08.152690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:08.153190 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:44:08.153300 [debug] [MainThread]: On master: COMMIT
[0m14:44:08.153407 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:08.153503 [debug] [MainThread]: On master: COMMIT
[0m14:44:08.153637 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:44:08.153739 [debug] [MainThread]: On master: Close
[0m14:44:08.153874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:08.153983 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.int_stackoverflow__question_views' was properly closed.
[0m14:44:08.154068 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.int_stackoverflow__at_replies' was properly closed.
[0m14:44:08.154197 [info ] [MainThread]: 
[0m14:44:08.154334 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m14:44:08.154682 [debug] [MainThread]: Command end result
[0m14:44:08.165117 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m14:44:08.166969 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m14:44:08.169760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m14:44:08.169892 [info ] [MainThread]: 
[0m14:44:08.170049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:08.170159 [info ] [MainThread]: 
[0m14:44:08.170287 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:44:08.172205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.327848, "process_in_blocks": "0", "process_kernel_time": 5.720537, "process_mem_max_rss": "8089649152", "process_out_blocks": "0", "process_user_time": 23.585709}
[0m14:44:08.172411 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:08.172378 after 6.33 seconds
[0m14:44:08.172600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12283dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c660d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12213d320>]}
[0m14:44:08.172729 [debug] [MainThread]: Flushing usage events
[0m14:44:09.083913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:43.271976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121065d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223cfed0>]}


============================== 15:02:43.274158 | 4d300a87-64c5-40bf-9228-b5553a22efef ==============================
[0m15:02:43.274158 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:02:43.274434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_stackoverflow__answer_timing', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:02:43.357343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d300a87-64c5-40bf-9228-b5553a22efef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240a1f30>]}
[0m15:02:43.378238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d300a87-64c5-40bf-9228-b5553a22efef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221f8e20>]}
[0m15:02:43.379875 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:02:43.424983 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:02:43.485891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:43.486117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:43.507407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d300a87-64c5-40bf-9228-b5553a22efef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122476c50>]}
[0m15:02:43.543201 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m15:02:43.544489 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m15:02:43.552928 [error] [MainThread]: Encountered an error:
Found a cycle: model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m15:02:43.555348 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 574, in run
    self._runtime_initialize()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/compilation.py", line 475, in compile
    linker.link_graph(manifest)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing

[0m15:02:43.556777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.32282966, "process_in_blocks": "0", "process_kernel_time": 0.172013, "process_mem_max_rss": "119062528", "process_out_blocks": "0", "process_user_time": 0.782829}
[0m15:02:43.556993 [debug] [MainThread]: Command `dbt run` failed at 15:02:43.556950 after 0.32 seconds
[0m15:02:43.557167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124117f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12445e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223dbd90>]}
[0m15:02:43.557320 [debug] [MainThread]: Flushing usage events
[0m15:02:44.595328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:51.963773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d51d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aabc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aabed0>]}


============================== 15:04:51.965949 | a38c4456-42e0-47ba-ae45-540514657bfa ==============================
[0m15:04:51.965949 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:04:51.966227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_stackoverflow__posts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:04:52.048132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a38c4456-42e0-47ba-ae45-540514657bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7df30>]}
[0m15:04:52.069146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a38c4456-42e0-47ba-ae45-540514657bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d4e20>]}
[0m15:04:52.070798 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:04:52.113224 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:04:52.174313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:52.174566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:52.195612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a38c4456-42e0-47ba-ae45-540514657bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b32c50>]}
[0m15:04:52.236438 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m15:04:52.237563 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m15:04:52.246951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a38c4456-42e0-47ba-ae45-540514657bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ceff20>]}
[0m15:04:52.247215 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m15:04:52.247365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38c4456-42e0-47ba-ae45-540514657bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107036510>]}
[0m15:04:52.248118 [info ] [MainThread]: 
[0m15:04:52.248259 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:04:52.248365 [info ] [MainThread]: 
[0m15:04:52.248569 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:04:52.248945 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:04:52.308011 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:04:52.308240 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:04:52.308372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:52.340494 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m15:04:52.341253 [debug] [ThreadPool]: On list_dev: Close
[0m15:04:52.341597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:04:52.341836 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:04:52.344788 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:52.345009 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:04:52.345132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:52.345938 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:04:52.346575 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:52.346696 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:04:52.346860 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:52.346957 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:52.347057 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:04:52.347241 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:52.347567 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:04:52.347687 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:52.347792 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:04:52.347949 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:52.348069 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:04:52.350730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main_marts)
[0m15:04:52.353626 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m15:04:52.353869 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_intermediate'
[0m15:04:52.354010 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m15:04:52.354738 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m15:04:52.354894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:52.355025 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m15:04:52.355219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:52.355710 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:04:52.355839 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m15:04:52.355995 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m15:04:52.356456 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:04:52.356589 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m15:04:52.356723 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m15:04:52.364722 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:04:52.364868 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m15:04:52.365535 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m15:04:52.366114 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m15:04:52.366763 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m15:04:52.367007 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m15:04:52.367151 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m15:04:52.367290 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m15:04:52.367539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now list_dev_main_analysis)
[0m15:04:52.368488 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m15:04:52.368683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_marts, now list_dev_main)
[0m15:04:52.368821 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m15:04:52.369701 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:04:52.369847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:52.370013 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:04:52.370196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:52.370689 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:04:52.370818 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m15:04:52.370946 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m15:04:52.371432 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:04:52.371557 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:04:52.371676 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:04:52.373952 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:04:52.374505 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m15:04:52.374672 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:04:52.374921 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m15:04:52.375071 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m15:04:52.375568 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:04:52.375889 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:04:52.376041 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:04:52.376513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38c4456-42e0-47ba-ae45-540514657bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ae750>]}
[0m15:04:52.376720 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:52.376844 [debug] [MainThread]: On master: BEGIN
[0m15:04:52.376957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:52.377443 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:52.377571 [debug] [MainThread]: On master: COMMIT
[0m15:04:52.377693 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:52.377814 [debug] [MainThread]: On master: COMMIT
[0m15:04:52.377976 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:52.378079 [debug] [MainThread]: On master: Close
[0m15:04:52.380443 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m15:04:52.380678 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main.stg_stackoverflow__posts ............... [RUN]
[0m15:04:52.380875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.stackoverflow_analysis_aw.stg_stackoverflow__posts)
[0m15:04:52.381023 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m15:04:52.387273 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m15:04:52.387968 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m15:04:52.411881 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"
[0m15:04:52.412163 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

    
  
    
    

    create temporary table
      "stg_stackoverflow__posts__dbt_tmp20250518150452402027"
  
    as (
      -- models/staging/stg_stackoverflow__posts.sql


WITH source_data AS (
    SELECT 
        Id,
        OwnerUserId,
        PostTypeId,
        ViewCount,
        CreationDate,
        AcceptedAnswerId,
        Score
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/posts.parquet'
    WHERE Id IS NOT NULL
    
        AND CreationDate > (SELECT MAX(created_at) FROM "dev"."main"."stg_stackoverflow__posts")
    
),

validated_data AS (
    SELECT 
        CAST(Id AS BIGINT) as post_id,
        CAST(OwnerUserId AS BIGINT) as user_id,
        CAST(PostTypeId AS INT) as post_type_id,
        CAST(ViewCount AS INT) as view_count,
        CreationDate as created_at,
        DATE_TRUNC('month', CreationDate) as created_at_month,
        CAST(AcceptedAnswerId AS BIGINT) as accepted_answer_id,
        CAST(Score AS INT) as score
    FROM source_data
    WHERE Id > 0 
    AND PostTypeId IN (1, 2)  -- 1 for questions, 2 for answers
)

SELECT 
    post_id,
    user_id,
    post_type_id,
    view_count,
    created_at,
    created_at_month,
    accepted_answer_id,
    score
FROM validated_data
    );
  
  
  
[0m15:04:52.412345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:47.374659 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m15:05:47.376658 [debug] [MainThread]: DuckDB adapter: cancelling query on connection model.stackoverflow_analysis_aw.stg_stackoverflow__posts. Details: Connection(type='duckdb', name='model.stackoverflow_analysis_aw.stg_stackoverflow__posts', state=<ConnectionState.OPEN: 'open'>, transaction_open=False, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x1073ba060>, _credentials=DuckDBCredentials(database='dev', schema='main', path='dev.duckdb', config_options=None, extensions=['httpfs', 'parquet'], settings={'memory_limit': '12GB', 'temp_directory': '/tmp/duckdb_temp', 'enable_progress_bar': True, 'default_null_order': 'nulls_first', 'preserve_insertion_order': False, 'external_threads': 4}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m15:05:47.377242 [debug] [MainThread]: DuckDB adapter: query cancelled on connection model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m15:05:47.377691 [error] [MainThread]: CANCEL query model.stackoverflow_analysis_aw.stg_stackoverflow__posts .......... [[31mCANCEL[0m]
[0m15:05:47.378155 [error] [MainThread]: CANCEL query list_dev_main_analysis ............................................ [[31mCANCEL[0m]
[0m15:05:48.888650 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.stg_stackoverflow__posts"} */

    
  
    
    

    create temporary table
      "stg_stackoverflow__posts__dbt_tmp20250518150452402027"
  
    as (
      -- models/staging/stg_stackoverflow__posts.sql


WITH source_data AS (
    SELECT 
        Id,
        OwnerUserId,
        PostTypeId,
        ViewCount,
        CreationDate,
        AcceptedAnswerId,
        Score
    FROM 's3://us-prd-motherduck-open-datasets/stackoverflow/parquet/2023-05/posts.parquet'
    WHERE Id IS NOT NULL
    
        AND CreationDate > (SELECT MAX(created_at) FROM "dev"."main"."stg_stackoverflow__posts")
    
),

validated_data AS (
    SELECT 
        CAST(Id AS BIGINT) as post_id,
        CAST(OwnerUserId AS BIGINT) as user_id,
        CAST(PostTypeId AS INT) as post_type_id,
        CAST(ViewCount AS INT) as view_count,
        CreationDate as created_at,
        DATE_TRUNC('month', CreationDate) as created_at_month,
        CAST(AcceptedAnswerId AS BIGINT) as accepted_answer_id,
        CAST(Score AS INT) as score
    FROM source_data
    WHERE Id > 0 
    AND PostTypeId IN (1, 2)  -- 1 for questions, 2 for answers
)

SELECT 
    post_id,
    user_id,
    post_type_id,
    view_count,
    created_at,
    created_at_month,
    accepted_answer_id,
    score
FROM validated_data
    );
  
  
  
[0m15:05:48.888958 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:05:48.889175 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.stg_stackoverflow__posts: Close
[0m15:05:48.896393 [debug] [Thread-1 (]: Runtime Error in model stg_stackoverflow__posts (models/staging/stg_stackoverflow__posts.sql)
  INTERRUPT Error: Interrupted!
[0m15:05:48.897440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a38c4456-42e0-47ba-ae45-540514657bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b9d90>]}
[0m15:05:48.897728 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model main.stg_stackoverflow__posts ...... [[31mERROR[0m in 56.52s]
[0m15:05:48.897971 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.stg_stackoverflow__posts
[0m15:05:48.898145 [info ] [MainThread]: 
[0m15:05:48.898357 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m15:05:48.898485 [info ] [MainThread]: 
[0m15:05:48.898615 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m15:05:48.898742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:48.898851 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.stg_stackoverflow__posts' was properly closed.
[0m15:05:48.898956 [debug] [MainThread]: Connection 'list_dev_main_analysis' was properly closed.
[0m15:05:48.899063 [info ] [MainThread]: 
[0m15:05:48.899174 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 56.65 seconds (56.65s).
[0m15:05:48.899345 [error] [MainThread]: Encountered an error:

[0m15:05:48.901738 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/venv/lib/python3.13/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/queue.py", line 108, in join
    self.all_tasks_done.wait()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

[0m15:05:48.903267 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 56.96974, "process_in_blocks": "0", "process_kernel_time": 1.50231, "process_mem_max_rss": "579354624", "process_out_blocks": "0", "process_user_time": 5.248625}
[0m15:05:48.903453 [debug] [MainThread]: Command `dbt run` failed at 15:05:48.903417 after 56.97 seconds
[0m15:05:48.903604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d8f50>]}
[0m15:05:48.903738 [debug] [MainThread]: Flushing usage events
[0m15:05:49.821169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:23.563747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e75d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1cfed0>]}


============================== 15:06:23.565693 | c9fa4ac5-6123-49a3-b4bb-e9d81c7db1fe ==============================
[0m15:06:23.565693 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:06:23.565960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select int_stackoverflow__answer_timing', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:06:23.648852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9fa4ac5-6123-49a3-b4bb-e9d81c7db1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4a1f30>]}
[0m15:06:23.669527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9fa4ac5-6123-49a3-b4bb-e9d81c7db1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0f8e20>]}
[0m15:06:23.671044 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:06:23.713458 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:06:23.780217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:23.780449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:23.801502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9fa4ac5-6123-49a3-b4bb-e9d81c7db1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b276c50>]}
[0m15:06:23.840884 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m15:06:23.841989 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m15:06:23.850715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9fa4ac5-6123-49a3-b4bb-e9d81c7db1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b61bf20>]}
[0m15:06:23.850952 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m15:06:23.851096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9fa4ac5-6123-49a3-b4bb-e9d81c7db1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca5a510>]}
[0m15:06:23.851874 [info ] [MainThread]: 
[0m15:06:23.852017 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:06:23.852125 [info ] [MainThread]: 
[0m15:06:23.852328 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:06:23.852716 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:06:23.905483 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:06:23.905727 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:06:23.905879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:23.937170 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m15:06:23.937893 [debug] [ThreadPool]: On list_dev: Close
[0m15:06:23.938235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_intermediate)
[0m15:06:23.938445 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_intermediate"
"
[0m15:06:23.941427 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m15:06:23.941575 [debug] [ThreadPool]: On create_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:06:23.941700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:23.942329 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:06:23.942881 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m15:06:23.943015 [debug] [ThreadPool]: On create_dev_main_intermediate: BEGIN
[0m15:06:23.943196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:06:23.943310 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m15:06:23.943424 [debug] [ThreadPool]: On create_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_intermediate"} */

    
    
        create schema if not exists "dev"."main_intermediate"
    
[0m15:06:23.943726 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:06:23.944178 [debug] [ThreadPool]: On create_dev_main_intermediate: COMMIT
[0m15:06:23.944332 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m15:06:23.944447 [debug] [ThreadPool]: On create_dev_main_intermediate: COMMIT
[0m15:06:23.944634 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:06:23.944756 [debug] [ThreadPool]: On create_dev_main_intermediate: Close
[0m15:06:23.947885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_intermediate, now list_dev_main)
[0m15:06:23.948157 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_intermediate'
[0m15:06:23.950882 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:06:23.951603 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m15:06:23.951752 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:06:23.951883 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m15:06:23.952011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:23.952150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:23.952888 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:06:23.953012 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:06:23.953171 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:06:23.953631 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:06:23.953776 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m15:06:23.953902 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m15:06:23.961977 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:06:23.962164 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m15:06:23.962816 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m15:06:23.963363 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:06:23.964119 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m15:06:23.964383 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:06:23.964510 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m15:06:23.964637 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:06:23.964893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now list_dev_main_marts)
[0m15:06:23.965093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_analysis)
[0m15:06:23.965809 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m15:06:23.967046 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m15:06:23.967182 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m15:06:23.967305 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m15:06:23.967413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:23.967528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:23.968084 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:06:23.968203 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m15:06:23.968357 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m15:06:23.968789 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:06:23.968913 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m15:06:23.969038 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m15:06:23.971242 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:06:23.971818 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m15:06:23.972090 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m15:06:23.972217 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m15:06:23.972365 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:06:23.972958 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m15:06:23.973188 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m15:06:23.973303 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m15:06:23.973591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9fa4ac5-6123-49a3-b4bb-e9d81c7db1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfd2750>]}
[0m15:06:23.973799 [debug] [MainThread]: Using duckdb connection "master"
[0m15:06:23.973921 [debug] [MainThread]: On master: BEGIN
[0m15:06:23.974035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:23.974556 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:06:23.974699 [debug] [MainThread]: On master: COMMIT
[0m15:06:23.974825 [debug] [MainThread]: Using duckdb connection "master"
[0m15:06:23.974934 [debug] [MainThread]: On master: COMMIT
[0m15:06:23.975104 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:06:23.975215 [debug] [MainThread]: On master: Close
[0m15:06:23.976433 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m15:06:23.976665 [info ] [Thread-1 (]: 1 of 1 START sql table model main_intermediate.int_stackoverflow__answer_timing  [RUN]
[0m15:06:23.976863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing)
[0m15:06:23.977026 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m15:06:23.980680 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:06:23.981838 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m15:06:23.996648 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:06:23.997430 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:06:23.997597 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: BEGIN
[0m15:06:23.997744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:23.998368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:06:23.998516 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:06:23.998685 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__answer_timing.sql


WITH answer_timing AS (
    SELECT 
        q.post_id as question_id,
        q.created_at as question_date,
        a.created_at as answer_date,
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL
        AND DATEDIFF('minute', q.created_at, a.created_at) >= 0  -- Filter out negative times
)

SELECT 
    at.question_id,          
    at.question_date,        
    at.answer_date,          
    at.minutes_to_answer,    
    CASE 
        WHEN at.minutes_to_answer < 15 THEN 'Very Fast (<15 mins)'
        WHEN at.minutes_to_answer < 60 THEN 'Fast (15-60 mins)'
        WHEN at.minutes_to_answer < 480 THEN 'Same Day (1-8 hours)'
        WHEN at.minutes_to_answer < 1440 THEN 'Next Day (<24 hours)'
        WHEN at.minutes_to_answer < 7200 THEN 'Within 5 Days'
        ELSE 'More than 5 Days'
    END as response_time_band
FROM answer_timing at
    );
  
  
[0m15:06:24.858316 [debug] [Thread-1 (]: SQL status: OK in 0.859 seconds
[0m15:06:24.860871 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:06:24.861031 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */
alter table "dev"."main_intermediate"."int_stackoverflow__answer_timing" rename to "int_stackoverflow__answer_timing__dbt_backup"
[0m15:06:24.861342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:06:24.862463 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:06:24.862596 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */
alter table "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_tmp" rename to "int_stackoverflow__answer_timing"
[0m15:06:24.862818 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:06:24.868094 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: COMMIT
[0m15:06:24.868229 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:06:24.868339 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: COMMIT
[0m15:06:24.968343 [debug] [Thread-1 (]: SQL status: OK in 0.100 seconds
[0m15:06:24.970447 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:06:24.970592 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */
drop table if exists "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_backup" cascade
[0m15:06:24.971831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:06:24.972760 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: Close
[0m15:06:24.973601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9fa4ac5-6123-49a3-b4bb-e9d81c7db1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfddc10>]}
[0m15:06:24.973849 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_intermediate.int_stackoverflow__answer_timing  [[32mOK[0m in 1.00s]
[0m15:06:24.974068 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m15:06:24.974613 [debug] [MainThread]: Using duckdb connection "master"
[0m15:06:24.974770 [debug] [MainThread]: On master: BEGIN
[0m15:06:24.974878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:24.975410 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:06:24.975522 [debug] [MainThread]: On master: COMMIT
[0m15:06:24.975626 [debug] [MainThread]: Using duckdb connection "master"
[0m15:06:24.975723 [debug] [MainThread]: On master: COMMIT
[0m15:06:24.975878 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:06:24.975975 [debug] [MainThread]: On master: Close
[0m15:06:24.976110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:24.976206 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing' was properly closed.
[0m15:06:24.976291 [debug] [MainThread]: Connection 'list_dev_main_marts' was properly closed.
[0m15:06:24.976385 [info ] [MainThread]: 
[0m15:06:24.976498 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m15:06:24.976737 [debug] [MainThread]: Command end result
[0m15:06:24.987012 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m15:06:24.988075 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m15:06:24.990437 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m15:06:24.990555 [info ] [MainThread]: 
[0m15:06:24.990707 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:24.990815 [info ] [MainThread]: 
[0m15:06:24.990929 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:06:24.992657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4584205, "process_in_blocks": "0", "process_kernel_time": 0.717741, "process_mem_max_rss": "3268476928", "process_out_blocks": "0", "process_user_time": 6.429807}
[0m15:06:24.992822 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:24.992787 after 1.46 seconds
[0m15:06:24.992959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0014f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0dc870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0dcb90>]}
[0m15:06:24.993084 [debug] [MainThread]: Flushing usage events
[0m15:06:26.211866 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:05.112179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8cfed0>]}


============================== 15:09:05.114635 | b7757a6e-d0af-4a86-8c39-adbd23de18c0 ==============================
[0m15:09:05.114635 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:09:05.114953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select int_stackoverflow__answer_timing', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:05.196694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7757a6e-d0af-4a86-8c39-adbd23de18c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa1f30>]}
[0m15:09:05.217517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7757a6e-d0af-4a86-8c39-adbd23de18c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef8e20>]}
[0m15:09:05.219238 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:09:05.262014 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:09:05.321920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:05.322179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:05.343543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7757a6e-d0af-4a86-8c39-adbd23de18c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a97ac50>]}
[0m15:09:05.380796 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m15:09:05.381873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m15:09:05.391112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7757a6e-d0af-4a86-8c39-adbd23de18c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac17f20>]}
[0m15:09:05.391393 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m15:09:05.391560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7757a6e-d0af-4a86-8c39-adbd23de18c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af76510>]}
[0m15:09:05.392372 [info ] [MainThread]: 
[0m15:09:05.392521 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:09:05.392626 [info ] [MainThread]: 
[0m15:09:05.392829 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:09:05.393206 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:09:05.442788 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:09:05.443031 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:09:05.443173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:05.476165 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m15:09:05.476931 [debug] [ThreadPool]: On list_dev: Close
[0m15:09:05.477319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_intermediate)
[0m15:09:05.477591 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_intermediate"
"
[0m15:09:05.480706 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m15:09:05.480904 [debug] [ThreadPool]: On create_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_intermediate"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:09:05.481037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:05.481861 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:09:05.482474 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m15:09:05.482609 [debug] [ThreadPool]: On create_dev_main_intermediate: BEGIN
[0m15:09:05.482782 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:09:05.482880 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m15:09:05.482997 [debug] [ThreadPool]: On create_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_intermediate"} */

    
    
        create schema if not exists "dev"."main_intermediate"
    
[0m15:09:05.483194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:09:05.483539 [debug] [ThreadPool]: On create_dev_main_intermediate: COMMIT
[0m15:09:05.483662 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_intermediate"
[0m15:09:05.483771 [debug] [ThreadPool]: On create_dev_main_intermediate: COMMIT
[0m15:09:05.483933 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:09:05.484048 [debug] [ThreadPool]: On create_dev_main_intermediate: Close
[0m15:09:05.486724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_intermediate, now list_dev_main_marts)
[0m15:09:05.489592 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m15:09:05.489824 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_analysis'
[0m15:09:05.489953 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m15:09:05.490653 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m15:09:05.490781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:05.490914 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m15:09:05.491116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:05.491648 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:09:05.491793 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m15:09:05.491928 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m15:09:05.492387 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:09:05.492502 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m15:09:05.492616 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m15:09:05.500706 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:09:05.500899 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m15:09:05.501435 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m15:09:05.502043 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m15:09:05.502648 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m15:09:05.502845 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m15:09:05.503075 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m15:09:05.503232 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m15:09:05.503439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main_intermediate)
[0m15:09:05.504167 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m15:09:05.504378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_marts, now list_dev_main)
[0m15:09:05.504536 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m15:09:05.505465 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:09:05.505606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:05.505726 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:09:05.505906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:05.506431 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:09:05.506572 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m15:09:05.506729 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m15:09:05.507199 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:09:05.507335 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:09:05.507464 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:09:05.509797 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:09:05.510374 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m15:09:05.510642 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m15:09:05.510778 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:09:05.510908 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m15:09:05.511471 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:09:05.511744 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:09:05.512103 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:09:05.512578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7757a6e-d0af-4a86-8c39-adbd23de18c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2d2820>]}
[0m15:09:05.512796 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:05.512911 [debug] [MainThread]: On master: BEGIN
[0m15:09:05.513017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:05.513560 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:09:05.513679 [debug] [MainThread]: On master: COMMIT
[0m15:09:05.513800 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:05.513909 [debug] [MainThread]: On master: COMMIT
[0m15:09:05.514081 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:09:05.514214 [debug] [MainThread]: On master: Close
[0m15:09:05.515396 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m15:09:05.515628 [info ] [Thread-1 (]: 1 of 1 START sql table model main_intermediate.int_stackoverflow__answer_timing  [RUN]
[0m15:09:05.515838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing)
[0m15:09:05.515986 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m15:09:05.519624 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:09:05.520081 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m15:09:05.534346 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:09:05.534994 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:09:05.535183 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: BEGIN
[0m15:09:05.535331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:05.536020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:09:05.536182 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:09:05.536353 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */

  
    
    

    create  table
      "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_tmp"
  
    as (
      -- models/intermediate/int_stackoverflow__answer_timing.sql


WITH answer_timing AS (
    SELECT 
        q.post_id as question_id,
        q.created_at as question_date,
        a.created_at as answer_date,
        DATEDIFF('minute', q.created_at, a.created_at) as minutes_to_answer
    FROM "dev"."main"."stg_stackoverflow__posts" q
    LEFT JOIN "dev"."main"."stg_stackoverflow__posts" a
        ON q.accepted_answer_id = a.post_id
    WHERE q.post_type_id = 1  -- Questions only
        AND a.created_at IS NOT NULL
        AND DATEDIFF('minute', q.created_at, a.created_at) >= 0  -- Filter out negative times
)

SELECT 
    at.question_id,          
    at.question_date,        
    at.answer_date,          
    at.minutes_to_answer,    
    -- add time band based on the time_band_stats 
    CASE 
        WHEN at.minutes_to_answer < 15 THEN 'Very Fast (less than 15 mins)'
        WHEN at.minutes_to_answer < 60 THEN 'Fast (15 to 60 mins)'
        WHEN at.minutes_to_answer < 480 THEN 'Same Day (1 to 8 hours)'
        WHEN at.minutes_to_answer < 1440 THEN 'Next Day (less than 24 hours)'
        WHEN at.minutes_to_answer < 7200 THEN 'Within 5 Days'
        ELSE 'More than 5 Days'
    END as response_time_band
FROM answer_timing at
    );
  
  
[0m15:09:06.429715 [debug] [Thread-1 (]: SQL status: OK in 0.893 seconds
[0m15:09:06.432287 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:09:06.432461 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */
alter table "dev"."main_intermediate"."int_stackoverflow__answer_timing" rename to "int_stackoverflow__answer_timing__dbt_backup"
[0m15:09:06.432793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:09:06.433936 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:09:06.434064 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */
alter table "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_tmp" rename to "int_stackoverflow__answer_timing"
[0m15:09:06.434299 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:09:06.439811 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: COMMIT
[0m15:09:06.439957 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:09:06.440071 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: COMMIT
[0m15:09:06.549542 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m15:09:06.551630 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"
[0m15:09:06.551773 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing"} */
drop table if exists "dev"."main_intermediate"."int_stackoverflow__answer_timing__dbt_backup" cascade
[0m15:09:06.552951 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:09:06.553902 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing: Close
[0m15:09:06.554718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7757a6e-d0af-4a86-8c39-adbd23de18c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ddc10>]}
[0m15:09:06.554954 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_intermediate.int_stackoverflow__answer_timing  [[32mOK[0m in 1.04s]
[0m15:09:06.555168 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing
[0m15:09:06.555718 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:06.555877 [debug] [MainThread]: On master: BEGIN
[0m15:09:06.555985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:06.556563 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:09:06.556723 [debug] [MainThread]: On master: COMMIT
[0m15:09:06.556844 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:06.556948 [debug] [MainThread]: On master: COMMIT
[0m15:09:06.557086 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:09:06.557191 [debug] [MainThread]: On master: Close
[0m15:09:06.557335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:06.557435 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.int_stackoverflow__answer_timing' was properly closed.
[0m15:09:06.557523 [debug] [MainThread]: Connection 'list_dev_main_intermediate' was properly closed.
[0m15:09:06.557622 [info ] [MainThread]: 
[0m15:09:06.557734 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m15:09:06.557976 [debug] [MainThread]: Command end result
[0m15:09:06.568017 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m15:09:06.569130 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m15:09:06.571655 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m15:09:06.571764 [info ] [MainThread]: 
[0m15:09:06.571908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:06.572012 [info ] [MainThread]: 
[0m15:09:06.572132 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:09:06.573546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4939216, "process_in_blocks": "0", "process_kernel_time": 0.710227, "process_mem_max_rss": "3278307328", "process_out_blocks": "0", "process_user_time": 6.764702}
[0m15:09:06.573710 [debug] [MainThread]: Command `dbt run` succeeded at 15:09:06.573677 after 1.49 seconds
[0m15:09:06.573846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3014f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4b0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4b0eb0>]}
[0m15:09:06.573966 [debug] [MainThread]: Flushing usage events
[0m15:09:07.509622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:44.985804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110151fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112acfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112acfc50>]}


============================== 15:52:44.988151 | 692f9147-5aed-4926-b76f-392a16046f49 ==============================
[0m15:52:44.988151 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:52:44.988409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:52:45.071865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '692f9147-5aed-4926-b76f-392a16046f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da1f30>]}
[0m15:52:45.093624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '692f9147-5aed-4926-b76f-392a16046f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f4e20>]}
[0m15:52:45.095756 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:52:45.142045 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m15:52:45.178803 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:52:45.179038 [debug] [MainThread]: previous checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m15:52:45.179188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '692f9147-5aed-4926-b76f-392a16046f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11305ae50>]}
[0m15:52:45.654736 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.stackoverflow_analysis_aw.int_stackoverflow__at_replies copy`
[0m15:52:45.655005 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m15:52:45.655204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '692f9147-5aed-4926-b76f-392a16046f49', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f3aa80>]}
[0m15:52:45.659742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '692f9147-5aed-4926-b76f-392a16046f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ad49f0>]}
[0m15:52:45.691520 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m15:52:45.693278 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m15:52:45.710828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '692f9147-5aed-4926-b76f-392a16046f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142c7110>]}
[0m15:52:45.711056 [info ] [MainThread]: Found 11 models, 15 data tests, 7 sources, 431 macros
[0m15:52:45.711192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '692f9147-5aed-4926-b76f-392a16046f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114272e10>]}
[0m15:52:45.711566 [warn ] [MainThread]: The selection criterion 'copy' does not match any enabled nodes
[0m15:52:45.712129 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:52:45.712386 [debug] [MainThread]: Command end result
[0m15:52:45.721599 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m15:52:45.722441 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m15:52:45.723806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m15:52:45.725334 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7710557, "process_in_blocks": "0", "process_kernel_time": 0.186947, "process_mem_max_rss": "129826816", "process_out_blocks": "0", "process_user_time": 1.232185}
[0m15:52:45.725499 [debug] [MainThread]: Command `cli test` succeeded at 15:52:45.725465 after 0.77 seconds
[0m15:52:45.725625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11427afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114308870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114308a50>]}
[0m15:52:45.725746 [debug] [MainThread]: Flushing usage events
[0m15:52:46.769857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:18.720561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d75d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129cfed0>]}


============================== 16:13:18.723084 | 8ca8fdf0-b3a2-4854-b7c6-e3355907aa49 ==============================
[0m16:13:18.723084 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:13:18.726379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yuejwang/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select marts', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:13:18.808231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ca8fdf0-b3a2-4854-b7c6-e3355907aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca1f30>]}
[0m16:13:18.829050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ca8fdf0-b3a2-4854-b7c6-e3355907aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127f8e20>]}
[0m16:13:18.830732 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m16:13:18.873058 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:13:18.934021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:18.934255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:18.955249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ca8fdf0-b3a2-4854-b7c6-e3355907aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a7ac50>]}
[0m16:13:18.992528 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m16:13:18.993686 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m16:13:19.003083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ca8fdf0-b3a2-4854-b7c6-e3355907aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d1bf20>]}
[0m16:13:19.003337 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m16:13:19.003502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ca8fdf0-b3a2-4854-b7c6-e3355907aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113176510>]}
[0m16:13:19.004429 [info ] [MainThread]: 
[0m16:13:19.004592 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:13:19.004724 [info ] [MainThread]: 
[0m16:13:19.004965 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:13:19.007074 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:13:19.060112 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:13:19.060359 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:13:19.060512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:19.092112 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m16:13:19.092880 [debug] [ThreadPool]: On list_dev: Close
[0m16:13:19.093250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_marts)
[0m16:13:19.093561 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_marts"
"
[0m16:13:19.097059 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_marts"
[0m16:13:19.097240 [debug] [ThreadPool]: On create_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:13:19.097367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:19.098112 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:13:19.098711 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_marts"
[0m16:13:19.098844 [debug] [ThreadPool]: On create_dev_main_marts: BEGIN
[0m16:13:19.099020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:13:19.099136 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_marts"
[0m16:13:19.099254 [debug] [ThreadPool]: On create_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_marts"} */

    
    
        create schema if not exists "dev"."main_marts"
    
[0m16:13:19.099453 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:13:19.099801 [debug] [ThreadPool]: On create_dev_main_marts: COMMIT
[0m16:13:19.099917 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_marts"
[0m16:13:19.100033 [debug] [ThreadPool]: On create_dev_main_marts: COMMIT
[0m16:13:19.100541 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:13:19.100697 [debug] [ThreadPool]: On create_dev_main_marts: Close
[0m16:13:19.101395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_marts, now list_dev_main_analysis)
[0m16:13:19.101613 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_intermediate'
[0m16:13:19.103839 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m16:13:19.104831 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m16:13:19.104969 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m16:13:19.105086 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m16:13:19.105200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:19.105348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:19.105995 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:13:19.106115 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m16:13:19.106265 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m16:13:19.106699 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:13:19.106826 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m16:13:19.106953 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m16:13:19.115119 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m16:13:19.115313 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:13:19.115946 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m16:13:19.116546 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m16:13:19.117273 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m16:13:19.117531 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m16:13:19.117672 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m16:13:19.117804 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m16:13:19.118068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now list_dev_main)
[0m16:13:19.118303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_intermediate, now list_dev_main_marts)
[0m16:13:19.119273 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:13:19.119920 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m16:13:19.120070 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:13:19.120403 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m16:13:19.120542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:19.120681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:19.121278 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:13:19.121403 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:13:19.121570 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:13:19.121978 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:13:19.122097 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m16:13:19.122217 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m16:13:19.124686 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:13:19.125254 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:13:19.125422 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:13:19.125664 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:13:19.126197 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m16:13:19.126319 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:13:19.126548 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m16:13:19.126697 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m16:13:19.127291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ca8fdf0-b3a2-4854-b7c6-e3355907aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133d6750>]}
[0m16:13:19.127513 [debug] [MainThread]: Using duckdb connection "master"
[0m16:13:19.127634 [debug] [MainThread]: On master: BEGIN
[0m16:13:19.127743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:19.128237 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:13:19.128367 [debug] [MainThread]: On master: COMMIT
[0m16:13:19.128485 [debug] [MainThread]: Using duckdb connection "master"
[0m16:13:19.128601 [debug] [MainThread]: On master: COMMIT
[0m16:13:19.128759 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:13:19.128868 [debug] [MainThread]: On master: Close
[0m16:13:19.130702 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.mart_answer_timing_distribution
[0m16:13:19.130877 [debug] [Thread-2 (]: Began running node model.stackoverflow_analysis_aw.mart_questions_with_author_replies
[0m16:13:19.131109 [info ] [Thread-1 (]: 1 of 3 START sql table model main_marts.mart_answer_timing_distribution ........ [RUN]
[0m16:13:19.131325 [info ] [Thread-2 (]: 2 of 3 START sql table model main_marts.mart_questions_with_author_replies ..... [RUN]
[0m16:13:19.131532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.stackoverflow_analysis_aw.mart_answer_timing_distribution)
[0m16:13:19.131708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_main_marts, now model.stackoverflow_analysis_aw.mart_questions_with_author_replies)
[0m16:13:19.131869 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.mart_answer_timing_distribution
[0m16:13:19.132014 [debug] [Thread-2 (]: Began compiling node model.stackoverflow_analysis_aw.mart_questions_with_author_replies
[0m16:13:19.135262 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:13:19.136541 [debug] [Thread-2 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.mart_questions_with_author_replies"
[0m16:13:19.137102 [debug] [Thread-2 (]: Began executing node model.stackoverflow_analysis_aw.mart_questions_with_author_replies
[0m16:13:19.137289 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.mart_answer_timing_distribution
[0m16:13:19.151446 [debug] [Thread-2 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.mart_questions_with_author_replies"
[0m16:13:19.152898 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:13:19.153568 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_questions_with_author_replies"
[0m16:13:19.153782 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:13:19.153963 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.mart_questions_with_author_replies: BEGIN
[0m16:13:19.154147 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: BEGIN
[0m16:13:19.154302 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:13:19.154441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:19.155227 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:13:19.155390 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_questions_with_author_replies"
[0m16:13:19.155582 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.mart_questions_with_author_replies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_questions_with_author_replies"} */

  
    
    

    create  table
      "dev"."main_marts"."mart_questions_with_author_replies__dbt_tmp"
  
    as (
      -- models/marts/mart_questions_with_author_replies.sql


WITH total_questions AS (
    SELECT COUNT(*) as total_count
    FROM "dev"."main"."stg_stackoverflow__posts"
    WHERE post_type_id = 1
),

reply_metrics AS (
    SELECT 
        COUNT(DISTINCT post_id) as questions_with_replies,
        COUNT(*) as total_replies
    FROM "dev"."main_intermediate"."int_stackoverflow__at_replies"
)

SELECT 
    questions_with_replies,
    total_replies,
    ROUND(questions_with_replies * 100.0 / total_count, 2) as percentage_questions_with_replies
FROM reply_metrics
CROSS JOIN total_questions
    );
  
  
[0m16:13:19.156049 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:13:19.156207 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:13:19.156372 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"} */

  
    
    

    create  table
      "dev"."main_marts"."mart_answer_timing_distribution__dbt_tmp"
  
    as (
      -- models/marts/mart_answer_timing_distribution.sql


SELECT 
    STRFTIME(DATE_TRUNC('month', question_date), '%Y-%m') as month,  -- Changed to STRFTIME
    response_time_band,
    COUNT(*) as question_count,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY DATE_TRUNC('month', question_date)), 2) as percentage_in_month
FROM "dev"."main_intermediate"."int_stackoverflow__answer_timing"
GROUP BY 
    DATE_TRUNC('month', question_date),
    response_time_band
ORDER BY 
    DATE_TRUNC('month', question_date) DESC,
    CASE response_time_band
        WHEN 'Very Fast (less than 15 mins)' THEN 1
        WHEN 'Fast (15 to 60 mins)' THEN 2
        WHEN 'Same Day (1 to 8 hours)' THEN 3
        WHEN 'Next Day (less than 24 hours)' THEN 4
        WHEN 'Within 5 Days' THEN 5
        ELSE 6
    END
    );
  
  
[0m16:13:19.238787 [debug] [Thread-1 (]: SQL status: OK in 0.082 seconds
[0m16:13:19.243344 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:13:19.243600 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"} */
alter table "dev"."main_marts"."mart_answer_timing_distribution__dbt_tmp" rename to "mart_answer_timing_distribution"
[0m16:13:19.243967 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:19.254966 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: COMMIT
[0m16:13:19.255270 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:13:19.255454 [debug] [Thread-2 (]: SQL status: OK in 0.100 seconds
[0m16:13:19.255642 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: COMMIT
[0m16:13:19.256897 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_questions_with_author_replies"
[0m16:13:19.257167 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.mart_questions_with_author_replies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_questions_with_author_replies"} */
alter table "dev"."main_marts"."mart_questions_with_author_replies__dbt_tmp" rename to "mart_questions_with_author_replies"
[0m16:13:19.257541 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:13:19.258343 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.mart_questions_with_author_replies: COMMIT
[0m16:13:19.258494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:13:19.258640 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_questions_with_author_replies"
[0m16:13:19.261037 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:13:19.261499 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.mart_questions_with_author_replies: COMMIT
[0m16:13:19.261819 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"} */
drop table if exists "dev"."main_marts"."mart_answer_timing_distribution__dbt_backup" cascade
[0m16:13:19.262741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:19.262934 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:13:19.264346 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: Close
[0m16:13:19.265637 [debug] [Thread-2 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_questions_with_author_replies"
[0m16:13:19.265936 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.mart_questions_with_author_replies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_questions_with_author_replies"} */
drop table if exists "dev"."main_marts"."mart_questions_with_author_replies__dbt_backup" cascade
[0m16:13:19.267669 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:13:19.268703 [debug] [Thread-2 (]: On model.stackoverflow_analysis_aw.mart_questions_with_author_replies: Close
[0m16:13:19.268862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ca8fdf0-b3a2-4854-b7c6-e3355907aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e1f10>]}
[0m16:13:19.269091 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ca8fdf0-b3a2-4854-b7c6-e3355907aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ed020>]}
[0m16:13:19.269375 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main_marts.mart_answer_timing_distribution ... [[32mOK[0m in 0.13s]
[0m16:13:19.269612 [info ] [Thread-2 (]: 2 of 3 OK created sql table model main_marts.mart_questions_with_author_replies  [[32mOK[0m in 0.14s]
[0m16:13:19.269833 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.mart_answer_timing_distribution
[0m16:13:19.270047 [debug] [Thread-2 (]: Finished running node model.stackoverflow_analysis_aw.mart_questions_with_author_replies
[0m16:13:19.270401 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.mart_top_10_users_by_views
[0m16:13:19.270942 [info ] [Thread-1 (]: 3 of 3 START sql table model main_marts.mart_top_10_users_by_views ............. [RUN]
[0m16:13:19.271487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stackoverflow_analysis_aw.mart_answer_timing_distribution, now model.stackoverflow_analysis_aw.mart_top_10_users_by_views)
[0m16:13:19.271851 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.mart_top_10_users_by_views
[0m16:13:19.273465 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.mart_top_10_users_by_views"
[0m16:13:19.273976 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.mart_top_10_users_by_views
[0m16:13:19.275127 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.mart_top_10_users_by_views"
[0m16:13:19.275510 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_top_10_users_by_views"
[0m16:13:19.275646 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_top_10_users_by_views: BEGIN
[0m16:13:19.275770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:19.276353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:13:19.276495 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_top_10_users_by_views"
[0m16:13:19.276635 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_top_10_users_by_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_top_10_users_by_views"} */

  
    
    

    create  table
      "dev"."main_marts"."mart_top_10_users_by_views__dbt_tmp"
  
    as (
      -- models/marts/mart_top_10_users_by_views.sql


WITH ranked_users AS (
    SELECT 
        user_id,
        display_name as user_name,
        total_questions,
        total_views,
        avg_views_per_question,
        ROW_NUMBER() OVER (ORDER BY total_views DESC) as rank
    FROM "dev"."main_intermediate"."int_stackoverflow__question_views"
)

SELECT 
    rank,
    user_id,
    user_name,
    total_questions,
    total_views,
    avg_views_per_question
FROM ranked_users
WHERE rank <= 10
ORDER BY total_views DESC
    );
  
  
[0m16:13:19.587416 [debug] [Thread-1 (]: SQL status: OK in 0.311 seconds
[0m16:13:19.588795 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_top_10_users_by_views"
[0m16:13:19.588967 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_top_10_users_by_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_top_10_users_by_views"} */
alter table "dev"."main_marts"."mart_top_10_users_by_views__dbt_tmp" rename to "mart_top_10_users_by_views"
[0m16:13:19.589298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:19.589847 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_top_10_users_by_views: COMMIT
[0m16:13:19.589997 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_top_10_users_by_views"
[0m16:13:19.590123 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_top_10_users_by_views: COMMIT
[0m16:13:19.590525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:19.591695 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_top_10_users_by_views"
[0m16:13:19.591845 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_top_10_users_by_views: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_top_10_users_by_views"} */
drop table if exists "dev"."main_marts"."mart_top_10_users_by_views__dbt_backup" cascade
[0m16:13:19.592096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:19.592619 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_top_10_users_by_views: Close
[0m16:13:19.592844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ca8fdf0-b3a2-4854-b7c6-e3355907aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135b27b0>]}
[0m16:13:19.593088 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main_marts.mart_top_10_users_by_views ........ [[32mOK[0m in 0.32s]
[0m16:13:19.593308 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.mart_top_10_users_by_views
[0m16:13:19.593816 [debug] [MainThread]: Using duckdb connection "master"
[0m16:13:19.593930 [debug] [MainThread]: On master: BEGIN
[0m16:13:19.594030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:19.594580 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:13:19.594776 [debug] [MainThread]: On master: COMMIT
[0m16:13:19.594906 [debug] [MainThread]: Using duckdb connection "master"
[0m16:13:19.595014 [debug] [MainThread]: On master: COMMIT
[0m16:13:19.595195 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:13:19.595362 [debug] [MainThread]: On master: Close
[0m16:13:19.595540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:19.595650 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.mart_top_10_users_by_views' was properly closed.
[0m16:13:19.595749 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.mart_questions_with_author_replies' was properly closed.
[0m16:13:19.595891 [info ] [MainThread]: 
[0m16:13:19.596021 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m16:13:19.596384 [debug] [MainThread]: Command end result
[0m16:13:19.606445 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m16:13:19.607417 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m16:13:19.610034 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m16:13:19.610213 [info ] [MainThread]: 
[0m16:13:19.610382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:19.610641 [info ] [MainThread]: 
[0m16:13:19.610777 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:13:19.612271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.92272127, "process_in_blocks": "0", "process_kernel_time": 0.839783, "process_mem_max_rss": "2225176576", "process_out_blocks": "0", "process_user_time": 2.937515}
[0m16:13:19.612488 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:19.612447 after 0.92 seconds
[0m16:13:19.612658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113035b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f6fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a41320>]}
[0m16:13:19.612811 [debug] [MainThread]: Flushing usage events
[0m16:13:20.570695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:35.270740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c6dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141cfed0>]}


============================== 16:15:35.272825 | 046c1c49-795b-49ea-8a06-c2df492a4125 ==============================
[0m16:15:35.272825 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:15:35.273101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/logs', 'version_check': 'True', 'profiles_dir': '/Users/yuejwang/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select mart_answer_timing_distribution', 'send_anonymous_usage_stats': 'True'}
[0m16:15:35.355123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '046c1c49-795b-49ea-8a06-c2df492a4125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143a1f30>]}
[0m16:15:35.376361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '046c1c49-795b-49ea-8a06-c2df492a4125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140f4e20>]}
[0m16:15:35.378052 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m16:15:35.421394 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:15:35.485402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:35.485658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:35.508562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '046c1c49-795b-49ea-8a06-c2df492a4125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11427ac50>]}
[0m16:15:35.545357 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m16:15:35.546353 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m16:15:35.555901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '046c1c49-795b-49ea-8a06-c2df492a4125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114417f20>]}
[0m16:15:35.556168 [info ] [MainThread]: Found 10 models, 15 data tests, 7 sources, 431 macros
[0m16:15:35.556337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '046c1c49-795b-49ea-8a06-c2df492a4125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114976510>]}
[0m16:15:35.557210 [info ] [MainThread]: 
[0m16:15:35.557378 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:15:35.557504 [info ] [MainThread]: 
[0m16:15:35.557722 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:15:35.558115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:15:35.612200 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:15:35.612455 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:15:35.612609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:35.643965 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m16:15:35.644926 [debug] [ThreadPool]: On list_dev: Close
[0m16:15:35.645312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_marts)
[0m16:15:35.645530 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_marts"
"
[0m16:15:35.648983 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_marts"
[0m16:15:35.649203 [debug] [ThreadPool]: On create_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:15:35.649338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:35.650133 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:15:35.650755 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_marts"
[0m16:15:35.650880 [debug] [ThreadPool]: On create_dev_main_marts: BEGIN
[0m16:15:35.651094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:35.651264 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_marts"
[0m16:15:35.651399 [debug] [ThreadPool]: On create_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "create_dev_main_marts"} */

    
    
        create schema if not exists "dev"."main_marts"
    
[0m16:15:35.651630 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:35.652019 [debug] [ThreadPool]: On create_dev_main_marts: COMMIT
[0m16:15:35.652154 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_marts"
[0m16:15:35.652272 [debug] [ThreadPool]: On create_dev_main_marts: COMMIT
[0m16:15:35.652459 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:35.652639 [debug] [ThreadPool]: On create_dev_main_marts: Close
[0m16:15:35.655263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_marts, now list_dev_main)
[0m16:15:35.655488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main_marts'
[0m16:15:35.658226 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:15:35.658975 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m16:15:35.659110 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:15:35.659234 [debug] [ThreadPool]: On list_dev_main_marts: BEGIN
[0m16:15:35.659342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:35.659463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:35.660067 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:15:35.660228 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:15:35.660366 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:15:35.660864 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:15:35.660984 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_marts"
[0m16:15:35.661117 [debug] [ThreadPool]: On list_dev_main_marts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_marts"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'dev'
  
[0m16:15:35.669183 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m16:15:35.669367 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:15:35.670036 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:15:35.670602 [debug] [ThreadPool]: On list_dev_main_marts: ROLLBACK
[0m16:15:35.671374 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:15:35.671617 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_marts'
[0m16:15:35.671748 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:15:35.671872 [debug] [ThreadPool]: On list_dev_main_marts: Close
[0m16:15:35.672134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main, now list_dev_main_analysis)
[0m16:15:35.672606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_marts, now list_dev_main_intermediate)
[0m16:15:35.673537 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m16:15:35.674417 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m16:15:35.674565 [debug] [ThreadPool]: On list_dev_main_analysis: BEGIN
[0m16:15:35.674711 [debug] [ThreadPool]: On list_dev_main_intermediate: BEGIN
[0m16:15:35.674833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:35.674946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:35.675585 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:15:35.675738 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_analysis"
[0m16:15:35.675905 [debug] [ThreadPool]: On list_dev_main_analysis: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_analysis"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analysis'
    and lower(table_catalog) = 'dev'
  
[0m16:15:35.676352 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:15:35.676478 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_intermediate"
[0m16:15:35.676605 [debug] [ThreadPool]: On list_dev_main_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "connection_name": "list_dev_main_intermediate"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'dev'
  
[0m16:15:35.678867 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:15:35.679492 [debug] [ThreadPool]: On list_dev_main_analysis: ROLLBACK
[0m16:15:35.679743 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_analysis'
[0m16:15:35.679865 [debug] [ThreadPool]: On list_dev_main_analysis: Close
[0m16:15:35.679985 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:15:35.680604 [debug] [ThreadPool]: On list_dev_main_intermediate: ROLLBACK
[0m16:15:35.680868 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_intermediate'
[0m16:15:35.680987 [debug] [ThreadPool]: On list_dev_main_intermediate: Close
[0m16:15:35.681466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '046c1c49-795b-49ea-8a06-c2df492a4125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bd2750>]}
[0m16:15:35.681669 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:35.681790 [debug] [MainThread]: On master: BEGIN
[0m16:15:35.681892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:35.682412 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:15:35.682546 [debug] [MainThread]: On master: COMMIT
[0m16:15:35.682662 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:35.682768 [debug] [MainThread]: On master: COMMIT
[0m16:15:35.682943 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:15:35.683077 [debug] [MainThread]: On master: Close
[0m16:15:35.684297 [debug] [Thread-1 (]: Began running node model.stackoverflow_analysis_aw.mart_answer_timing_distribution
[0m16:15:35.684537 [info ] [Thread-1 (]: 1 of 1 START sql table model main_marts.mart_answer_timing_distribution ........ [RUN]
[0m16:15:35.684725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_analysis, now model.stackoverflow_analysis_aw.mart_answer_timing_distribution)
[0m16:15:35.684877 [debug] [Thread-1 (]: Began compiling node model.stackoverflow_analysis_aw.mart_answer_timing_distribution
[0m16:15:35.688377 [debug] [Thread-1 (]: Writing injected SQL for node "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:15:35.688853 [debug] [Thread-1 (]: Began executing node model.stackoverflow_analysis_aw.mart_answer_timing_distribution
[0m16:15:35.703453 [debug] [Thread-1 (]: Writing runtime sql for node "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:15:35.704024 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:15:35.704179 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: BEGIN
[0m16:15:35.704311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:35.704917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:15:35.705075 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:15:35.705243 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"} */

  
    
    

    create  table
      "dev"."main_marts"."mart_answer_timing_distribution__dbt_tmp"
  
    as (
      -- models/marts/mart_answer_timing_distribution.sql


SELECT 
    STRFTIME(DATE_TRUNC('month', question_date), '%Y-%m') as month,  -- Changed to STRFTIME
    response_time_band as time_band,
    COUNT(*) as question_count,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (PARTITION BY DATE_TRUNC('month', question_date)), 2) as percentage_in_month
FROM "dev"."main_intermediate"."int_stackoverflow__answer_timing"
GROUP BY 
    DATE_TRUNC('month', question_date),
    response_time_band
ORDER BY 
    DATE_TRUNC('month', question_date) DESC,
    CASE response_time_band
        WHEN 'Very Fast (less than 15 mins)' THEN 1
        WHEN 'Fast (15 to 60 mins)' THEN 2
        WHEN 'Same Day (1 to 8 hours)' THEN 3
        WHEN 'Next Day (less than 24 hours)' THEN 4
        WHEN 'Within 5 Days' THEN 5
        ELSE 6
    END
    );
  
  
[0m16:15:35.765778 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m16:15:35.769051 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:15:35.769247 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"} */
alter table "dev"."main_marts"."mart_answer_timing_distribution" rename to "mart_answer_timing_distribution__dbt_backup"
[0m16:15:35.769881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:15:35.772421 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:15:35.772606 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"} */
alter table "dev"."main_marts"."mart_answer_timing_distribution__dbt_tmp" rename to "mart_answer_timing_distribution"
[0m16:15:35.772948 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:15:35.779494 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: COMMIT
[0m16:15:35.779696 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:15:35.779850 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: COMMIT
[0m16:15:35.780831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:15:35.783045 [debug] [Thread-1 (]: Using duckdb connection "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"
[0m16:15:35.783232 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "stackoverflow_analysis_aw", "target_name": "dev", "node_id": "model.stackoverflow_analysis_aw.mart_answer_timing_distribution"} */
drop table if exists "dev"."main_marts"."mart_answer_timing_distribution__dbt_backup" cascade
[0m16:15:35.783634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:15:35.784799 [debug] [Thread-1 (]: On model.stackoverflow_analysis_aw.mart_answer_timing_distribution: Close
[0m16:15:35.785674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046c1c49-795b-49ea-8a06-c2df492a4125', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bdde50>]}
[0m16:15:35.785977 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_marts.mart_answer_timing_distribution ... [[32mOK[0m in 0.10s]
[0m16:15:35.786211 [debug] [Thread-1 (]: Finished running node model.stackoverflow_analysis_aw.mart_answer_timing_distribution
[0m16:15:35.786737 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:35.786858 [debug] [MainThread]: On master: BEGIN
[0m16:15:35.786959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:35.787525 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:15:35.787659 [debug] [MainThread]: On master: COMMIT
[0m16:15:35.787769 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:35.787871 [debug] [MainThread]: On master: COMMIT
[0m16:15:35.788014 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:15:35.788116 [debug] [MainThread]: On master: Close
[0m16:15:35.788254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:35.788359 [debug] [MainThread]: Connection 'model.stackoverflow_analysis_aw.mart_answer_timing_distribution' was properly closed.
[0m16:15:35.788451 [debug] [MainThread]: Connection 'list_dev_main_intermediate' was properly closed.
[0m16:15:35.788563 [info ] [MainThread]: 
[0m16:15:35.788681 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m16:15:35.788934 [debug] [MainThread]: Command end result
[0m16:15:35.800107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/manifest.json
[0m16:15:35.801273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/semantic_manifest.json
[0m16:15:35.803844 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/yuejwang/Documents/aw_repo/stackoverflow-analysis-test/stackoverflow_analysis_aw/target/run_results.json
[0m16:15:35.803974 [info ] [MainThread]: 
[0m16:15:35.804130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:35.804240 [info ] [MainThread]: 
[0m16:15:35.804357 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:15:35.805713 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.56471884, "process_in_blocks": "0", "process_kernel_time": 0.241265, "process_mem_max_rss": "256868352", "process_out_blocks": "0", "process_user_time": 1.458583}
[0m16:15:35.805918 [debug] [MainThread]: Command `dbt run` succeeded at 16:15:35.805877 after 0.56 seconds
[0m16:15:35.806077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bfd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cd0690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cd0c30>]}
[0m16:15:35.806226 [debug] [MainThread]: Flushing usage events
[0m16:15:36.723893 [debug] [MainThread]: An error was encountered while trying to flush usage events
